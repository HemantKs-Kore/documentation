<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>koreai documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">koreai documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Classes</li>
  <li >template</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>apps/searchassist/src/app/components/search-interface/search-interface.component.ts</code>
        </p>






            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#preview" >preview</a>
                            </li>
                            <li>
                                <a href="#resultMapping" >resultMapping</a>
                            </li>
                            <li>
                                <a href="#searchResultlayout" >searchResultlayout</a>
                            </li>
                            <li>
                                <a href="#type" >type</a>
                            </li>
                            <li>
                                <a href="#typeId" >typeId</a>
                            </li>
                        </ul>
                    </td>
                </tr>






        </tbody>
    </table>
</section>


            <section>
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="preview"></a>
                    <span class="name">
                        <span ><b>preview</b></span>
                        <a href="#preview"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>&#x27;&#x27;</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1189" class="link-to-prism">apps/searchassist/src/app/components/search-interface/search-interface.component.ts:1189</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resultMapping"></a>
                    <span class="name">
                        <span ><b>resultMapping</b></span>
                        <a href="#resultMapping"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../classes/resultMapping.html" target="_self" >resultMapping</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new resultMapping()</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1188" class="link-to-prism">apps/searchassist/src/app/components/search-interface/search-interface.component.ts:1188</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="searchResultlayout"></a>
                    <span class="name">
                        <span ><b>searchResultlayout</b></span>
                        <a href="#searchResultlayout"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../classes/searchResultlayout.html" target="_self" >searchResultlayout</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new searchResultlayout()</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1187" class="link-to-prism">apps/searchassist/src/app/components/search-interface/search-interface.component.ts:1187</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="type"></a>
                    <span class="name">
                        <span ><b>type</b></span>
                        <a href="#type"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>&#x27;&#x27;</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1185" class="link-to-prism">apps/searchassist/src/app/components/search-interface/search-interface.component.ts:1185</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="typeId"></a>
                    <span class="name">
                        <span ><b>typeId</b></span>
                        <a href="#typeId"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>&#x27;&#x27;</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1186" class="link-to-prism">apps/searchassist/src/app/components/search-interface/search-interface.component.ts:1186</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>







    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { CdkDragDrop, moveItemInArray } from &#x27;@angular/cdk/drag-drop&#x27;;
import { Component, OnInit, ViewChild } from &#x27;@angular/core&#x27;;
import { MatDialog } from &#x27;@angular/material/dialog&#x27;;
import { AppSelectionService } from &#x27;@kore.services/app.selection.service&#x27;;
import { SideBarService } from &#x27;./../../services/header.service&#x27;;
import { NotificationService } from &#x27;@kore.services/notification.service&#x27;;
import { ServiceInvokerService } from &#x27;@kore.services/service-invoker.service&#x27;;
import { WorkflowService } from &#x27;@kore.services/workflow.service&#x27;;
import { Subscription } from &#x27;rxjs&#x27;;
import { ConfirmationDialogComponent } from &#x27;../../helpers/components/confirmation-dialog/confirmation-dialog.component&#x27;;
import { KRModalComponent } from &#x27;../../shared/kr-modal/kr-modal.component&#x27;;
import { InlineManualService } from &#x27;@kore.services/inline-manual.service&#x27;;
import { MixpanelServiceService } from &#x27;@kore.services/mixpanel-service.service&#x27;;

// import * as PureJSCarousel from &#x27;src/assets/web-kore-sdk/libs/purejscarousel.js&#x27;;
declare let PureJSCarousel: any;
declare let $: any;

@Component({
  selector: &#x27;app-search-interface&#x27;,
  templateUrl: &#x27;./search-interface.component.html&#x27;,
  styleUrls: [&#x27;./search-interface.component.scss&#x27;]
})
export class SearchInterfaceComponent implements OnInit {
  customModalRef: any;
  previewModalRef: any;
  selectedApp: any;
  serachIndexId: any;
  indexPipelineId: any;
  queryPipelineId : any;
  allFieldData: any;
  heading_fieldData: any;
  desc_fieldData: any;
  img_fieldData: any;
  showAlignment &#x3D; false;
  url_fieldData: any;
  fieldData: any;
  list: any &#x3D; [];
  customList: any &#x3D; [];
  //   [{
  //     id : &quot;&quot;,
  //     type : &#x27;Actions&#x27;,
  //   },
  //   {
  //     id : &quot;&quot;,
  //     type : &#x27;FAQs&#x27;,
  //   },
  //   {
  //     id : &quot;&quot;,
  //     type : &#x27;Pages&#x27;,
  //   },
  //   {
  //     id : &quot;&quot;,
  //     type : &#x27;Structured Data&#x27;,
  //   },
  // ]
  selectedSetting &#x3D; &#x27;search&#x27;;
  selectedSettingText &#x3D; &#x27;Conversational Search&#x27;
  selectedSourceType &#x3D; &quot;File&quot;
  preview_title &#x3D; &quot;Field Mapped for heading will appear here&quot;
  preview_desc &#x3D; &quot;Field mapped for Description will appear here&quot;;
  selectedTemplatedId: any;
  selectedSettingResultsObj: selectedSettingResults &#x3D; new selectedSettingResults();
  allSettings: any;
  subscription: Subscription;
  searchConfigurationSubscription: Subscription;
  queryConfigsSubscription : Subscription;
  searchExperienceConfig: any &#x3D; {};
  liveSearchResultObj: any &#x3D; {};
  conversationalSearchResultObj: any &#x3D; {};
  fullSearchResultObj: any &#x3D; {}
  searchTemplatesDisabled &#x3D; false;
  settingList: any &#x3D; [
    //   {
    //   id:&quot;searchUi&quot;,
    //   text : &quot;Search UI&quot;
    // },{
    //   id:&quot;searchExperience&quot;,
    //   text : &quot;Search Experience&quot;
    // },
    {
      id: &quot;liveSearch&quot;,
      text: &quot;Live Search&quot;
    }, {
      id: &quot;search&quot;,
      text: &quot;Conversational Search&quot;
    }, {
      id: &quot;fullSearch&quot;,
      text: &quot;Full Page Result&quot;
    }
  ]
  templateTypeList: any &#x3D; [{
    &#x27;id&#x27;: &#x27;listTemplate1&#x27;,
    &#x27;value&#x27;: &#x27;List Template 1&#x27;
  },
  {
    &#x27;id&#x27;: &#x27;listTemplate2&#x27;,
    &#x27;value&#x27;: &#x27;List Template 2&#x27;
  },
  {
    &#x27;id&#x27;: &#x27;listTemplate3&#x27;,
    &#x27;value&#x27;: &#x27;List Template 3&#x27;
  },
  {
    &#x27;id&#x27;: &#x27;grid&#x27;,
    &#x27;value&#x27;: &#x27;Grid&#x27;
  },
  {
    &#x27;id&#x27;: &#x27;carousel&#x27;,
    &#x27;value&#x27;: &#x27;Carousel&#x27;
  }];
  templateFieldValidateObj &#x3D; {
    heading : true,
    description : true,
    image : true,
    url : true
  }
  showDescription &#x3D; true;
  showImage &#x3D; false;
  clickableDisabled &#x3D; false;
  switchActive &#x3D; true;
  customizeTemplateObj: customizeTemplate &#x3D; new customizeTemplate();
  customizeTemplate: templateResponse &#x3D; new templateResponse();
  carousel: any &#x3D; [];
  componentType &#x3D; &#x27;designing&#x27;;
  submitted &#x3D; false;
  carouselTemplateCount &#x3D; 0;
  @ViewChild(&#x27;customModal&#x27;) customModal: KRModalComponent;
  @ViewChild(&#x27;previewModal&#x27;) previewModal: KRModalComponent;

  constructor(public workflowService: WorkflowService,
    private service: ServiceInvokerService,
    private notificationService: NotificationService,
    private appSelectionService: AppSelectionService,
    public dialog: MatDialog,
    public headerService: SideBarService,
    public inlineManual: InlineManualService,
    public mixpanel: MixpanelServiceService
  ) { }

  ngOnInit(): void {
    this.selectedApp &#x3D; this.workflowService.selectedApp();
    this.serachIndexId &#x3D; this.selectedApp.searchIndexes[0]._id;
    this.indexPipelineId &#x3D; this.workflowService.selectedIndexPipeline();
    // Template Response
    // this.customizeTemplate.type &#x3D; &quot;list&quot;
    // this.customizeTemplate.layout.layoutType &#x3D; &#x27;titleWithText&#x27;
    // this.customizeTemplate.layout.isClickable &#x3D; true;
    // this.customizeTemplate.layout.behaviour&#x3D;&quot;webpage&quot;;

    // this.defaultTemplate();
    // this.getSettings(&#x27;search&#x27;)
    // this.getAllSettings();
    //this.filedSelect(type,field)

    this.loadFiledsData();
    this.subscription &#x3D; this.appSelectionService.appSelectedConfigs.subscribe(res &#x3D;&gt; {
      this.loadFiledsData();
    })
    this.queryConfigsSubscription &#x3D; this.appSelectionService.queryConfigs.subscribe(res &#x3D;&gt; {
      if(!this.queryPipelineId){
        //this.queryPipelineId
        this.getAllSettings();
      }

    })
    this.searchExperienceConfig &#x3D; this.headerService.searchConfiguration;
    this.searchConfigurationSubscription &#x3D; this.headerService.savedSearchConfiguration.subscribe((res) &#x3D;&gt; {
      this.searchExperienceConfig &#x3D; res;
      this.updateResultTemplateTabsAccess();
    });
    this.updateResultTemplateTabsAccess();

    // console.log(this.customizeTemplateObj);
    // console.log(this.selectedSettingResultsObj);
    if (!this.inlineManual.checkVisibility(&#x27;RESULT_TEMPLATE&#x27;) &amp;&amp; false) {
      this.inlineManual.openHelp(&#x27;RESULT_TEMPLATE&#x27;)
      this.inlineManual.visited(&#x27;RESULT_TEMPLATE&#x27;)
    }
    //TEST
    // this.service.invoke(&#x27;get.SI_allResultSettings&#x27;, {searchIndexId : this.serachIndexId}).subscribe(res &#x3D;&gt; {
    //   this.notificationService.notify(&#x27;Result setting saved successfully&#x27;, &#x27;success&#x27;);
    //   this.selectedTemplatedId &#x3D; &quot;&quot;;
    //   this.closeCustomModal();
    // }, errRes &#x3D;&gt; {
    //   this.errorToaster(errRes, &#x27;Failed to save result settings&#x27;);
    // });
  }
  loadFiledsData() {
    this.indexPipelineId &#x3D; this.workflowService.selectedIndexPipeline();
    if (this.indexPipelineId) {
      this.queryPipelineId &#x3D; this.workflowService.selectedQueryPipeline() ? this.workflowService.selectedQueryPipeline()._id : this.selectedApp.searchIndexes[0].queryPipelineId;
      this.getFieldAutoComplete();
      this.defaultTemplate();
      //this.getSettings(&#x27;search&#x27;);
      this.getAllSettings();
    }
  }
  defaultTemplate(appearencType?) {
    this.customizeTemplateObj.template.type &#x3D; &quot;List Template 1&quot;;
    this.customizeTemplateObj.template.typeId &#x3D; &quot;listTemplate1&quot;
    this.customizeTemplateObj.template.searchResultlayout.layout &#x3D; &quot;tileWithText&quot;;
    this.customizeTemplateObj.template.searchResultlayout.clickable &#x3D; true;
    this.customizeTemplateObj.template.searchResultlayout.behaviour &#x3D; &quot;webpage&quot;;
    this.clickableDisabled &#x3D; false;
    this.customizeTemplateObj.template.searchResultlayout.textAlignment &#x3D; &quot;left&quot;;
    this.preview_title &#x3D; &quot;Field Mapped for heading will appear here&quot;
    this.preview_desc &#x3D; &quot;Field mapped for Description will appear here&quot;;
    this.selectedSourceType &#x3D; &quot;File&quot;;
    if (appearencType) {
      this.selectedSourceType &#x3D; appearencType;
    }
  }
  copyConfiguration(interfaceType) {
    if (interfaceType) {
      const dialogRef &#x3D; this.dialog.open(ConfirmationDialogComponent, {
        width: &#x27;530px&#x27;,
        height: &#x27;auto&#x27;,
        panelClass: &#x27;delete-popup&#x27;,
        data: {
          title: &#x27;Restore Customization&#x27;,
          text: &#x27;Are you sure you want to copy?&#x27;,
          newTitle: &#x27;Are you sure you want to copy?&#x27;,
          body: &#x27;Copying will overwrite the existing configuration.&#x27;,
          buttons: [{ key: &#x27;yes&#x27;, label: &#x27;Proceed&#x27;, type: &#x27;danger&#x27;, class: &#x27;deleteBtn&#x27; }, { key: &#x27;no&#x27;, label: &#x27;Cancel&#x27; }],
          confirmationPopUp: true,
        }
      });
      dialogRef.componentInstance.onSelect
        .subscribe(result &#x3D;&gt; {
          if (result &#x3D;&#x3D;&#x3D; &#x27;yes&#x27;) {
            this.selectedSettingResultsObj.referInterface &#x3D; interfaceType;
            this.copyResultSettings(interfaceType)
            if (this.selectedSetting) {
              if (this.selectedSetting &#x3D;&#x3D; &#x27;liveSearch&#x27;) {
                this.mixpanel.postEvent(&#x27;Result Templates - Updates to Live Search&#x27;, {})
              } else if (this.selectedSetting &#x3D;&#x3D; &#x27;search&#x27;) {
                this.mixpanel.postEvent(&#x27;Result Templates -  Updates to Conversational Search&#x27;, {})
              } else if (this.selectedSetting &#x3D;&#x3D; &#x27;fullSearch&#x27;) {
                this.mixpanel.postEvent(&#x27;Result Templates - Updates to Full Page Results&#x27;, {})
              }
            }
            //this.saveResultSettings(interfaceType);
            // this.saveResultSettings(); Inorder to reflect the configuretion, we need to save the current interface with reference
            dialogRef.close();
          } else if (result &#x3D;&#x3D;&#x3D; &#x27;no&#x27;) {
            dialogRef.close();
          }
        })
    }
  }
  getSettings(interfaceType) {
    const quaryparms: any &#x3D; {
      searchIndexId: this.serachIndexId,
      interface: interfaceType,
      indexPipelineId: this.indexPipelineId
    };
    this.service.invoke(&#x27;get.SI_settingInterface&#x27;, quaryparms).subscribe(res &#x3D;&gt; {
      if (res) {
        this.selectedSettingResultsObj &#x3D; res;
        this.sourceElementlist(res)
      }
    }, errRes &#x3D;&gt; {
      this.errorToaster(errRes, &#x27;Failed to fetch Setting Informations&#x27;);
      //this.selectedSettingResultsObj &#x3D; new selectedSettingResults()
    });
  }
  getAllSettings(setting?) {
    this.selectedSourceType &#x3D; &quot;File&quot;;
    if ((setting &amp;&amp; setting.id &#x3D;&#x3D; &#x27;search&#x27;) &amp;&amp; this.searchTemplatesDisabled) {
      return false;
    }
    this.selectedSetting &#x3D; setting ? setting.id : &#x27;search&#x27;;
    this.selectedSettingText &#x3D; setting ? setting.text : &#x27;Conversational Search&#x27;;
    const quaryparms: any &#x3D; {
      searchIndexId: this.serachIndexId,
      indexPipelineId: this.indexPipelineId,
      queryPipelineId : this.queryPipelineId,
    };
    this.service.invoke(&#x27;get.settingsByInterface&#x27;, quaryparms).subscribe(res &#x3D;&gt; {
      this.allSettings &#x3D; res;
      this.list &#x3D; [];
      this.customList &#x3D; [];
      res.settings.forEach(element &#x3D;&gt; {
        if (element.interface &#x3D;&#x3D; this.selectedSetting) {
          if (this.searchExperienceConfig.experienceConfig.searchBarPosition &#x3D;&#x3D;&#x3D; &#x27;top&#x27; &amp;&amp; this.selectedSetting &#x3D;&#x3D; &quot;fullSearch&quot;) {
            if (element.facets.aligned &#x3D;&#x3D; &quot;right&quot;)
              element.facets.aligned &#x3D; &quot;left&quot;
          }
          this.selectedSettingResultsObj &#x3D; element;
          this.sourcelist(element)
        }
        if (element.interface &#x3D;&#x3D; &#x27;liveSearch&#x27;) {
          this.liveSearchResultObj &#x3D; element;
        } else if (element.interface &#x3D;&#x3D; &#x27;search&#x27;) {
          this.conversationalSearchResultObj &#x3D; element;
        } else if (element.interface &#x3D;&#x3D; &#x27;fullSearch&#x27;) {
          this.fullSearchResultObj &#x3D; element;
        }
      });
    }, errRes &#x3D;&gt; {
      this.errorToaster(errRes, &#x27;Failed to fetch all Setting Informations&#x27;);
    });
  }
  selectByDefaultValBindToTemplatae(mapping) {
    if (mapping.heading) {
      this.heading_fieldData.forEach(element &#x3D;&gt; {
        const obj &#x3D; {
          fieldDataType: element.fieldDataType,
          fieldName: element.fieldName,
          _id: element._id
        }
        if (element._id &#x3D;&#x3D; mapping.heading) {
          this.preview_title &#x3D; element.fieldName
        }
        //this.filedSelect(type,obj)
      });
    }
    if (mapping.description) {
      this.desc_fieldData.forEach(element &#x3D;&gt; {
        const obj &#x3D; {
          fieldDataType: element.fieldDataType,
          fieldName: element.fieldName,
          _id: element._id
        }
        if (element._id &#x3D;&#x3D; mapping.description) {
          this.preview_desc &#x3D; element.fieldName
        }

        //this.filedSelect(type,obj)
      });
    }
  }
  getTemplate(templateId, modal?) {
    const quaryparms: any &#x3D; {
      searchIndexId: this.serachIndexId,
      templateId: templateId,
      indexPipelineId: this.indexPipelineId
    };
    this.service.invoke(&#x27;get.SI_searchResultTemplate&#x27;, quaryparms).subscribe(res &#x3D;&gt; {
      this.templateBind(res, modal)
      this.selectByDefaultValBindToTemplatae(res.mapping)
    }, errRes &#x3D;&gt; {
      this.errorToaster(errRes, &#x27;Failed to fetch Template&#x27;);
    });
  }
  templateBind(res: any, modal?) {
    if (res.type &#x3D;&#x3D; &#x27;grid&#x27; || res.type &#x3D;&#x3D; &#x27;carousel&#x27;) {
      this.clickableDisabled &#x3D; true;
    } else {
      this.clickableDisabled &#x3D; false;
    }
    this.customizeTemplateObj.template.searchResultlayout.textAlignment &#x3D; res.layout.textAlignment
    this.customizeTemplateObj.template.typeId &#x3D; res.type;
    this.templateTypeList.forEach(element &#x3D;&gt; {
      if (element.id &#x3D;&#x3D; res.type) {
        this.customizeTemplateObj.template.type &#x3D; element.value;
      }
    });
    this.customizeTemplateObj.template.searchResultlayout.behaviour &#x3D; res.layout.behaviour;
    this.customizeTemplateObj.template.searchResultlayout.clickable &#x3D; res.layout.isClickable
    this.customizeTemplateObj.template.searchResultlayout.layout &#x3D; res.layout.layoutType;

    this.customizeTemplateObj.template.resultMapping.headingId &#x3D; res.mapping.heading;
    this.heading_fieldData.forEach(element &#x3D;&gt; {
      if (element._id &#x3D;&#x3D; res.mapping.heading) {
        this.customizeTemplateObj.template.resultMapping.heading &#x3D; element.fieldName;
      }
    });
    this.customizeTemplateObj.template.resultMapping.descriptionId &#x3D; res.mapping.description
    this.desc_fieldData.forEach(element &#x3D;&gt; {
      if (element._id &#x3D;&#x3D; res.mapping.description) {
        this.customizeTemplateObj.template.resultMapping.description &#x3D; element.fieldName;
      }
    });
    this.customizeTemplateObj.template.resultMapping.imageId &#x3D; res.mapping.img
    this.img_fieldData.forEach(element &#x3D;&gt; {
      if (element._id &#x3D;&#x3D; res.mapping.img) {
        this.customizeTemplateObj.template.resultMapping.image &#x3D; element.fieldName;
      }
    });
    this.customizeTemplateObj.template.resultMapping.urlId &#x3D; res.mapping.url
    this.url_fieldData.forEach(element &#x3D;&gt; {
      if (element._id &#x3D;&#x3D; res.mapping.url) {
        this.customizeTemplateObj.template.resultMapping.url &#x3D; element.fieldName;
      }
    });
    this.resultLayoutChange(res.layout.layoutType)
    if (modal &#x3D;&#x3D; &#x27;openModal&#x27;) {
      this.submitted &#x3D; false;
      this.customModalRef &#x3D; this.customModal.open();
    }
  }
  sourceElementlist(settingObj) {
    settingObj.appearance.forEach(element &#x3D;&gt; {
      if (element.type &#x3D;&#x3D; &#x27;action&#x27; || element.type &#x3D;&#x3D; &#x27;Action&#x27;) {
        element.type &#x3D; &quot;Action&quot;
      } else if (element.type &#x3D;&#x3D; &#x27;faq&#x27; || element.type &#x3D;&#x3D; &#x27;FAQs&#x27;) {
        element.type &#x3D; &quot;FAQs&quot;
      } else if (element.type &#x3D;&#x3D; &#x27;page&#x27; || element.type &#x3D;&#x3D; &#x27;Web&#x27;) {
        element.type &#x3D; &quot;Web&quot;
      } else if (element.type &#x3D;&#x3D; &#x27;structuredData&#x27; || element.type &#x3D;&#x3D; &#x27;Structured Data&#x27;) {
        element.type &#x3D; &quot;Structured Data&quot;
      } else if (element.type &#x3D;&#x3D; &#x27;document&#x27; || element.type &#x3D;&#x3D; &#x27;File&#x27;) {
        element.type &#x3D; &quot;File&quot;
      }
      this.list.forEach(listElement &#x3D;&gt; {
        if (element.type &#x3D;&#x3D; listElement.type &amp;&amp; element.templateId !&#x3D; listElement.id) {
          listElement.id &#x3D; element.templateId;

          // let obj &#x3D; {
          //   type: &quot;Action&quot;,
          //   id: element.templateId ? element.templateId : &quot;&quot;
          // }
          // this.list.push(obj)
          // this.customList.push(obj)
        }
      });
    });
    this.list.forEach(element &#x3D;&gt; {
      if (element.type &#x3D;&#x3D;&#x3D; this.selectedSourceType) {
        if (element.id) {
          this.selectedTemplatedId &#x3D; element.id;
          if (this.selectedTemplatedId) {
            this.getTemplate(this.selectedTemplatedId);
          }
        }
      }
    });
  }
  sourcelist(settingObj) {
    settingObj.appearance.forEach(element &#x3D;&gt; {
      if (element.type &#x3D;&#x3D; &#x27;action&#x27; || element.type &#x3D;&#x3D; &#x27;Action&#x27;) {
        const obj &#x3D; {
          type: &quot;Action&quot;,
          id: element.templateId ? element.templateId : &quot;&quot;
        }
        this.list.push(obj)
        this.customList.push(obj)
      } else if (element.type &#x3D;&#x3D; &#x27;faq&#x27; || element.type &#x3D;&#x3D; &#x27;FAQs&#x27;) {
        const obj &#x3D; {
          type: &quot;FAQs&quot;,
          id: element.templateId ? element.templateId : &quot;&quot;
        }
        this.list.push(obj)
        this.customList.push(obj)
      } else if (element.type &#x3D;&#x3D; &#x27;page&#x27; || element.type &#x3D;&#x3D; &#x27;Web&#x27;) {
        const obj &#x3D; {
          type: &quot;Web&quot;,
          id: element.templateId ? element.templateId : &quot;&quot;
        }
        this.list.push(obj)
        this.customList.push(obj)
      } else if (element.type &#x3D;&#x3D; &#x27;structuredData&#x27; || element.type &#x3D;&#x3D; &#x27;Structured Data&#x27;) {
        const obj &#x3D; {
          type: &quot;Structured Data&quot;,
          id: element.templateId ? element.templateId : &quot;&quot;
        }
        this.list.push(obj)
        this.customList.push(obj)
      } else if (element.type &#x3D;&#x3D; &#x27;document&#x27; || element.type &#x3D;&#x3D; &#x27;File&#x27;) {
        const obj &#x3D; {
          type: &quot;File&quot;,
          id: element.templateId ? element.templateId : &quot;&quot;
        }
        this.list.push(obj)
        this.customList.push(obj)
      }
    });
    this.list.forEach(element &#x3D;&gt; {
      if (element.type &#x3D;&#x3D;&#x3D; this.selectedSourceType) {
        if (element.id) {
          this.selectedTemplatedId &#x3D; element.id;
          if (this.selectedTemplatedId) {
            this.getTemplate(this.selectedTemplatedId);
          }
        }
      }
    });
  }
  template(id, type) {
    this.customizeTemplateObj.template.type &#x3D; type;
    this.customizeTemplateObj.template.typeId &#x3D; id;

    if (id &#x3D;&#x3D; &#x27;grid&#x27; || id &#x3D;&#x3D; &#x27;carousel&#x27;) {
      this.clickableDisabled &#x3D; true;
      this.customizeTemplateObj.template.searchResultlayout.clickable &#x3D; true;
      this.customizeTemplateObj.template.searchResultlayout.behaviour &#x3D; &#x27;webpage&#x27;;  // ADDING xan be reoved later
    } else {
      this.clickableDisabled &#x3D; false;
      this.customizeTemplateObj.template.searchResultlayout.behaviour &#x3D; &#x27;webpage&#x27;;
      this.customizeTemplateObj.template.searchResultlayout.textAlignment &#x3D; &quot;left&quot;
    }

    if (this.customizeTemplateObj.template.type &#x3D;&#x3D;&#x3D; &#x27;Carousel&#x27;) {
      this.buildCarousel();
    }

    //this.
  }

  buildCarousel() {
    setTimeout(() &#x3D;&gt; {
      $(&#x27;.carousel:last&#x27;).addClass(&quot;carousel&quot; + this.carouselTemplateCount);
      const count &#x3D; $(&quot;.carousel&quot; + this.carouselTemplateCount).children().length;
      if (count &gt; 1) {
        const carousel &#x3D; new PureJSCarousel({
          carousel: &#x27;.carousel&#x27; + this.carouselTemplateCount,
          slide: &#x27;.slide&#x27;,
          oneByOne: true,
          jq: $,
        });
        this.carousel.push(carousel);
      }
      this.carouselTemplateCount +&#x3D; 1;
    }, 400);
  }

  resultLayoutChange(layout) {
    //this.customizeTemplate.
    this.submitted &#x3D; false;

    //this.customizeTemplateObj.template.searchResultlayout &#x3D; new searchResultlayout();
    //this.customizeTemplateObj.template.resultMapping &#x3D; new resultMapping();
    this.customizeTemplateObj.template.searchResultlayout.layout &#x3D; layout;
    if (layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27;) {
      this.showDescription &#x3D; false;
    } else {
      this.showDescription &#x3D; true;
    }
    if (layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27; || layout &#x3D;&#x3D; &#x27;tileWithText&#x27;) {
      this.showImage &#x3D; false;
    } else {
      this.showImage &#x3D; true;
    }
    if (layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27; || layout &#x3D;&#x3D; &#x27;tileWithText&#x27; || layout &#x3D;&#x3D; &#x27;tileWithImage&#x27; || layout &#x3D;&#x3D; &#x27;tileWithCenteredContent&#x27;) {
      if (this.customizeTemplateObj.template.type &#x3D;&#x3D;&#x3D; &#x27;Carousel&#x27;) {
        this.buildCarousel();
      }
    }

  }
  resultLayoutclickBehavior(type) {
    this.customizeTemplateObj.template.searchResultlayout.behaviour &#x3D; type;
  }
  clickableChange(event) {
    if (event) {
      this.customizeTemplateObj.template.searchResultlayout.clickable &#x3D; event.target.checked;
      this.switchActive &#x3D; event.target.checked;
      if (event.target.checked) {
        this.customizeTemplateObj.template.searchResultlayout.behaviour &#x3D; &quot;webpage&quot;; // ADDING xan be reoved later
        this.customizeTemplateObj.template.searchResultlayout.url &#x3D; &quot;&quot;;
      }
    }
  }
  facetEnableChange(event) {
    if (event) {
      this.selectedSettingResultsObj.facets.isEnabled &#x3D; event.target.checked;
      if (!event.target.checked) {
        this.selectedSettingResultsObj.facets.aligned &#x3D; &quot;left&quot;;
        this.saveResultSettings();
      } else {
        this.selectedSettingResultsObj.facets.aligned ? this.selectedSettingResultsObj.facets.aligned : &quot;left&quot;;
        this.saveResultSettings();
      }
    }
  }
  facetTypeChange(event, value) {
    if (event &amp;&amp; value) {
      this.selectedSettingResultsObj.facets.aligned &#x3D; value;
      this.saveResultSettings();
    }
  }
  selectResultAppearnceList(list, type) {
    this.selectedSourceType &#x3D; list.type;
    let templateId;
    if (type &#x3D;&#x3D; &#x27;list&#x27;) {
      this.list.forEach(element &#x3D;&gt; {
        if (element.type &#x3D;&#x3D; this.selectedSourceType) {
          templateId &#x3D; element.id
        }
      });
    } else {
      this.customList.forEach(element &#x3D;&gt; {
        if (element.type &#x3D;&#x3D; this.selectedSourceType) {
          templateId &#x3D; element.id
        }
      });
    }
    this.selectedTemplatedId &#x3D; templateId;
    if (templateId) {
      this.getTemplate(templateId);
    } else {
      this.defaultTemplate(&#x27;Structured Data&#x27;)
    }
  }
  openCustomModal() {
    this.customModel(&#x27;openModal&#x27;);
  }
  customModel(modalSwitch?) {
    let templateId;
    this.list.forEach(element &#x3D;&gt; {
      if (element.type &#x3D;&#x3D; this.selectedSourceType) {
        templateId &#x3D; element.id
      }
    });
    this.selectedTemplatedId &#x3D; templateId;
    this.customizeTemplateObj &#x3D; new customizeTemplate();
    if (templateId) {
      this.getTemplate(templateId, modalSwitch);
    } else {
      //this.customizeTemplateObj &#x3D; new customizeTemplate();
      this.defaultTemplate(this.selectedSourceType);
      this.submitted &#x3D; false;
      if (modalSwitch !&#x3D; &#x27;closeModal&#x27;) {
        this.customModalRef &#x3D; this.customModal.open();
        this.resultLayoutChange(&#x27;tileWithText&#x27;)
      }

    }
  }
  closeCustomModal() {
    if (this.customModalRef &amp;&amp; this.customModalRef.close) {
      this.customModel(&#x27;closeModal&#x27;)
      this.customModalRef.close();
      this.submitted &#x3D; false;
    }
  }
  openPreviewModal() {
    this.previewModalRef &#x3D; this.previewModal.open();
  }
  closePreviewModal() {
    if (this.previewModalRef &amp;&amp; this.previewModalRef.close) {
      this.previewModalRef.close();
    }
  }
  drop(event: CdkDragDrop&lt;string[]&gt;, list) {
    moveItemInArray(list, event.previousIndex, event.currentIndex);
  }
  searchlist(type, valToSearch,event, parentElement ,filedData) {
    //Add Listerner to close
    // console.log(event)
    // if(parentElement &amp;&amp; event &amp;&amp; event.srcElement &amp;&amp; event.srcElement.ariaExpanded){
    //   event.srcElement.ariaExpanded &#x3D; &quot;true&quot;;
    //   if(parentElement.children)
    //   for(let i &#x3D;0; i&lt; parentElement.children.length; i++){
    //     if(parentElement.children[i].className.includes(&quot;dropdown-menu content-menu&quot;)){
    //       parentElement.children[i].classList.add(&quot;show&quot;);
    //     }
    //   }
    // }
    const data &#x3D; []
    filedData.filter(element &#x3D;&gt; {
      const filedNamelower &#x3D; element.fieldName.toLocaleLowerCase();
      const valToSearchlower &#x3D; valToSearch.toLocaleLowerCase();
      if (filedNamelower.includes(valToSearchlower)) {
        data.push(element)
      }
    });
    if (valToSearch) {
      if (type &#x3D;&#x3D; &#x27;heading&#x27;) {
        this.heading_fieldData &#x3D; [...data]
      } else if (type &#x3D;&#x3D; &#x27;description&#x27;) {
        this.desc_fieldData &#x3D; [...data]
      } else if (type &#x3D;&#x3D; &#x27;image&#x27;) {
        this.img_fieldData &#x3D; [...data]
      } else if (type &#x3D;&#x3D; &#x27;url&#x27;) {
        this.url_fieldData &#x3D; [...data]
      }
    } else {
      if (type &#x3D;&#x3D; &#x27;heading&#x27;) {
        this.heading_fieldData &#x3D; [...filedData]
      } else if (type &#x3D;&#x3D; &#x27;description&#x27;) {
        this.desc_fieldData &#x3D; [...filedData]
      } else if (type &#x3D;&#x3D; &#x27;image&#x27;) {
        this.img_fieldData &#x3D; [...filedData]
      } else if (type &#x3D;&#x3D; &#x27;url&#x27;) {
        this.url_fieldData &#x3D; [...filedData]
      }
    }

  }
  filedSelect(type, field) {
    if (type &#x3D;&#x3D; &#x27;heading&#x27;) {
      this.customizeTemplateObj.template.resultMapping.heading &#x3D; field.fieldName;
      this.customizeTemplateObj.template.resultMapping.headingId &#x3D; field._id;
      this.preview_title &#x3D; field.fieldName;
      this.heading_fieldData &#x3D; [...this.allFieldData];
    } else if (type &#x3D;&#x3D; &#x27;description&#x27;) {
      this.customizeTemplateObj.template.resultMapping.description &#x3D; field.fieldName;
      this.customizeTemplateObj.template.resultMapping.descriptionId &#x3D; field._id;
      this.preview_desc &#x3D; field.fieldName;
      this.desc_fieldData &#x3D; [...this.allFieldData];
    } else if (type &#x3D;&#x3D; &#x27;image&#x27;) {
      this.customizeTemplateObj.template.resultMapping.image &#x3D; field.fieldName;
      this.customizeTemplateObj.template.resultMapping.imageId &#x3D; field._id;
      this.img_fieldData &#x3D; [...this.allFieldData];
    } else if (type &#x3D;&#x3D; &#x27;url&#x27;) {
      this.customizeTemplateObj.template.resultMapping.url &#x3D; field.fieldName;
      this.customizeTemplateObj.template.resultMapping.urlId &#x3D; field._id;
      this.url_fieldData &#x3D; [...this.allFieldData];
    }
  }
  copyResultSettings(interfaceType) {
    const queryparams &#x3D; {
      searchIndexId: this.serachIndexId,
      indexPipelineId: this.indexPipelineId
    };
    const payload &#x3D; {
      &quot;interface&quot;: this.selectedSetting,
      &quot;referInterface&quot;: interfaceType
    }
    //payload[&#x27;referInterface&#x27;] &#x3D; this.selectedSettingResultsObj.referInterface;
    this.service.invoke(&#x27;put.SI_copyResultSettings&#x27;, queryparams).subscribe(res &#x3D;&gt; {
      this.notificationService.notify(&#x27;Result copied successfully&#x27;, &#x27;success&#x27;);
      this.selectedTemplatedId &#x3D; &quot;&quot;;
      this.selectedSettingResultsObj.referInterface &#x3D; &quot;&quot;;
      this.getAllSettings({ id: this.selectedSetting, text: this.selectedSettingText });
      this.getSettings(this.selectedSetting);
      this.closeCustomModal();
    }, errRes &#x3D;&gt; {
      this.errorToaster(errRes, &#x27;Failed to copy settings&#x27;);
    });

  }
  saveResultSettings(interfaceType?) {
    let payload &#x3D; {};
    const _self &#x3D; this;
    const setPayload &#x3D; function (copedInterfaceResultsObj) {
      copedInterfaceResultsObj.appearance.forEach(element &#x3D;&gt; {
        if (element.type &#x3D;&#x3D; &#x27;Action&#x27;) {
          element.type &#x3D; &#x27;action&#x27;;
        } else if (element.type &#x3D;&#x3D; &#x27;FAQs&#x27;) {
          element.type &#x3D; &#x27;faq&#x27;;
        } else if (element.type &#x3D;&#x3D; &#x27;Pages&#x27; || element.type &#x3D;&#x3D; &#x27;Web&#x27;) {
          element.type &#x3D; &#x27;page&#x27;;
        } else if (element.type &#x3D;&#x3D; &#x27;Structured Data&#x27;) {
          element.type &#x3D; &#x27;structuredData&#x27;;
        } else if (element.type &#x3D;&#x3D; &#x27;Document&#x27; || element.type &#x3D;&#x3D; &#x27;File&#x27;) {
          element.type &#x3D; &#x27;document&#x27;;
        }
      });
      const payloadBody &#x3D; {
        &quot;_id&quot;: _self.selectedSettingResultsObj._id, // Binding the Selected Setting Id
        &quot;resultClassification&quot;: {
          &quot;isEnabled&quot;: copedInterfaceResultsObj.resultClassification.isEnabled,
          &quot;sourceType&quot;: copedInterfaceResultsObj.resultClassification.sourceType
        },
        &quot;view&quot;: copedInterfaceResultsObj.view,
        &quot;maxResultsAllowed&quot;: copedInterfaceResultsObj.maxResultsAllowed,
        &quot;facets&quot;: {
          &quot;aligned&quot;: copedInterfaceResultsObj.facets.aligned,
          &quot;isEnabled&quot;: copedInterfaceResultsObj.facets.isEnabled
        },
        &quot;interface&quot;: _self.selectedSetting, // Binding the Selected Setting interface
        &quot;appearance&quot;: copedInterfaceResultsObj.appearance //this.list ,  Binding the Selected appearance
      }
      payloadBody[&#x27;referInterface&#x27;] &#x3D; _self.selectedSettingResultsObj.referInterface; // Binding the Selected Setting referInterface

      return payloadBody;
    }
    const queryparams &#x3D; {
      searchIndexId: this.serachIndexId,
      indexPipelineId: this.indexPipelineId
    };

    this.selectedSettingResultsObj.appearance.forEach(element &#x3D;&gt; {
      if (element.type &#x3D;&#x3D; &#x27;Action&#x27;) {
        element.type &#x3D; &#x27;action&#x27;;
      } else if (element.type &#x3D;&#x3D; &#x27;FAQs&#x27;) {
        element.type &#x3D; &#x27;faq&#x27;;
      } else if (element.type &#x3D;&#x3D; &#x27;Pages&#x27; || element.type &#x3D;&#x3D; &#x27;Web&#x27;) {
        element.type &#x3D; &#x27;page&#x27;;
      } else if (element.type &#x3D;&#x3D; &#x27;Structured Data&#x27;) {
        element.type &#x3D; &#x27;structuredData&#x27;;
      } else if (element.type &#x3D;&#x3D; &#x27;Document&#x27; || element.type &#x3D;&#x3D; &#x27;File&#x27;) {
        element.type &#x3D; &#x27;document&#x27;;
      }
    });
    if (interfaceType) {
      if (interfaceType &#x3D;&#x3D; &#x27;livesearch&#x27;) {
        payload &#x3D; setPayload(this.liveSearchResultObj)
      } else if (interfaceType &#x3D;&#x3D; &#x27;search&#x27;) {
        payload &#x3D; setPayload(this.conversationalSearchResultObj)
      } else if (interfaceType &#x3D;&#x3D; &#x27;fullsearch&#x27;) {
        payload &#x3D; setPayload(this.fullSearchResultObj)
      }

    } else {
      payload &#x3D; {
        &quot;_id&quot;: this.selectedSettingResultsObj._id,
        &quot;resultClassification&quot;: {
          &quot;isEnabled&quot;: this.selectedSettingResultsObj.resultClassification.isEnabled,
          &quot;sourceType&quot;: this.selectedSettingResultsObj.resultClassification.sourceType
        },
        &quot;view&quot;: this.selectedSettingResultsObj.view,
        &quot;maxResultsAllowed&quot;: this.selectedSettingResultsObj.maxResultsAllowed,
        &quot;facets&quot;: {
          &quot;aligned&quot;: this.selectedSettingResultsObj.facets.aligned,
          &quot;isEnabled&quot;: this.selectedSettingResultsObj.facets.isEnabled
        },
        &quot;interface&quot;: this.selectedSetting,
        &quot;appearance&quot;: this.selectedSettingResultsObj.appearance //this.list
      }
      payload[&#x27;referInterface&#x27;] &#x3D; this.selectedSettingResultsObj.referInterface;
      //  if(this.selectedSettingResultsObj.referInterface &#x3D;&#x3D; &#x27;search&#x27;){
      //   payload[&#x27;referInterface&#x27;] &#x3D; &#x27;search&#x27;;
      //  }else{
      //    delete payload[&#x27;referInterface&#x27;];
      //  }
    }
    this.service.invoke(&#x27;put.SI_saveResultSettings&#x27;, queryparams, payload).subscribe(res &#x3D;&gt; {
      this.notificationService.notify(&#x27;Result setting saved successfully&#x27;, &#x27;success&#x27;);
      this.selectedTemplatedId &#x3D; &quot;&quot;;
      this.selectedSettingResultsObj.referInterface &#x3D; &quot;&quot;;
      this.getAllSettings({ id: this.selectedSetting, text: this.selectedSettingText });
      this.getSettings(this.selectedSetting);
      this.closeCustomModal();
      if (this.selectedSetting) {
        if (this.selectedSetting &#x3D;&#x3D; &#x27;liveSearch&#x27;) {
          this.mixpanel.postEvent(&#x27;Result Templates - Updates to Live Search&#x27;, {})
        } else if (this.selectedSetting &#x3D;&#x3D; &#x27;search&#x27;) {
          this.mixpanel.postEvent(&#x27;Result Templates -  Updates to Conversational Search&#x27;, {})
        } else if (this.selectedSetting &#x3D;&#x3D; &#x27;fullSearch&#x27;) {
          this.mixpanel.postEvent(&#x27;Result Templates - Updates to Full Page Results&#x27;, {})
        }
      }
    }, errRes &#x3D;&gt; {
      this.errorToaster(errRes, &#x27;Failed to save result settings&#x27;);
    });
  }
  validateTemplate() {
    if (this.selectedSourceType &#x3D;&#x3D; &#x27;Structured Data&#x27;) {
      if (this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27;) {
        if (this.customizeTemplateObj.template.resultMapping.heading.length) {
          if (this.customizeTemplateObj.template.searchResultlayout.clickable &amp;&amp; this.customizeTemplateObj.template.resultMapping.url.length) {
            return true;
          }
          else if (!this.customizeTemplateObj.template.searchResultlayout.clickable) {
            return true;
          }
          else {
            return false;
          }
        }
        else {
          return false;
        }
      }
      else if (this.customizeTemplateObj.template.resultMapping.heading.length &amp;&amp; this.customizeTemplateObj.template.resultMapping.description.length) {
        if (this.customizeTemplateObj.template.searchResultlayout.clickable &amp;&amp; this.customizeTemplateObj.template.resultMapping.url.length) {
          if ((this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithImage&#x27; || this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithCenteredContent&#x27;) &amp;&amp; (this.customizeTemplateObj.template.resultMapping.image.length)) {
            return true;
          }
          else if ((this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D; &#x27;tileWithText&#x27;) || (this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27;)) {
            return true;
          }
          else {
            return false;
          }
        }
        else if (this.customizeTemplateObj.template.searchResultlayout.clickable &amp;&amp; !this.customizeTemplateObj.template.resultMapping.url.length) {
          return false;
        }
        else {
          if ((this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithImage&#x27; || this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithCenteredContent&#x27;) &amp;&amp; (this.customizeTemplateObj.template.resultMapping.image.length)) {
            return true;
          }
          else if ((this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D; &#x27;tileWithText&#x27;) || (this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27;)) {
            return true;
          }
          else {
            return false;
          }
        }
      }
      else {
        return false;
      }
    }
    else if (this.customizeTemplateObj.template.searchResultlayout.clickable &amp;&amp; this.customizeTemplateObj.template.resultMapping.url.length) {
      if (this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27; &amp;&amp; this.customizeTemplateObj.template.resultMapping.heading.length) {
        return true;
      }
      else if (this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27; &amp;&amp; !this.customizeTemplateObj.template.resultMapping.heading.length) {
        return false;
      }
      else {
        if (this.customizeTemplateObj.template.resultMapping.heading.length &amp;&amp; this.customizeTemplateObj.template.resultMapping.description.length) {
          if ((this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithImage&#x27; || this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithCenteredContent&#x27;) &amp;&amp; (this.customizeTemplateObj.template.resultMapping.image.length)) {
            return true;
          }
          else if ((this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithImage&#x27; || this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithCenteredContent&#x27;) &amp;&amp; (!this.customizeTemplateObj.template.resultMapping.image.length)) {
            return false;
          }
          else {
            return true;
          }
        }
        else {
          return false;
        }
      }
    }
    else if (!this.customizeTemplateObj.template.searchResultlayout.clickable) {
      if (this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27; &amp;&amp; this.customizeTemplateObj.template.resultMapping.heading.length) {
        return true;
      }
      else if (this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D; &#x27;tileWithHeader&#x27; &amp;&amp; !this.customizeTemplateObj.template.resultMapping.heading.length) {
        return false;
      }
      else {
        if (this.customizeTemplateObj.template.resultMapping.heading.length &amp;&amp; this.customizeTemplateObj.template.resultMapping.description.length) {
          if ((this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithImage&#x27; || this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithCenteredContent&#x27;) &amp;&amp; (this.customizeTemplateObj.template.resultMapping.image.length)) {
            return true;
          }
          else if ((this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithImage&#x27; || this.customizeTemplateObj.template.searchResultlayout.layout &#x3D;&#x3D;&#x3D; &#x27;tileWithCenteredContent&#x27;) &amp;&amp; (!this.customizeTemplateObj.template.resultMapping.image.length)) {
            return false;
          }
          else {
            return true;
          }
        }
        else {
          return false;
        }
      }
    }
    else if (this.customizeTemplateObj.template.searchResultlayout.clickable &amp;&amp; !this.customizeTemplateObj.template.resultMapping.url.length) {
      return false;
    }
  }
  validateFeildTextCompare(){
    let hasFalseKeys &#x3D; true;
    this.templateFieldValidateObj &#x3D;  {
      heading : true,
      description : true,
      image : true,
      url : true
    }
    if(this.allFieldData){
    this.allFieldData.forEach(element &#x3D;&gt; {
      if(element._id &#x3D;&#x3D; this.customizeTemplateObj.template.resultMapping.headingId){
        if(element.fieldName !&#x3D; this.customizeTemplateObj.template.resultMapping.heading){
          this.notificationService.notify(&#x27;Heading field is not matching,Please select the option to proceed&#x27;, &#x27;error&#x27;);
          this.templateFieldValidateObj.heading &#x3D; false;
        }
      }else if(element._id &#x3D;&#x3D; this.customizeTemplateObj.template.resultMapping.descriptionId){
        if(element.fieldName !&#x3D; this.customizeTemplateObj.template.resultMapping.description){
          this.notificationService.notify(&#x27;Description field is not matching,Please select the option to proceed&#x27;, &#x27;error&#x27;);
          this.templateFieldValidateObj.description &#x3D; false;
        }
      }
      else if(element._id &#x3D;&#x3D; this.customizeTemplateObj.template.resultMapping.imageId){
        if(element.fieldName !&#x3D; this.customizeTemplateObj.template.resultMapping.image){
          this.notificationService.notify(&#x27;Image field is not matching,Please select the option to proceed&#x27;, &#x27;error&#x27;);
          this.templateFieldValidateObj.image &#x3D; false;
        }
      }
      else if(element._id &#x3D;&#x3D; this.customizeTemplateObj.template.resultMapping.urlId){
        if(element.fieldName !&#x3D; this.customizeTemplateObj.template.resultMapping.url){
          this.notificationService.notify(&#x27;Url field is not matching,Please select the option to proceed&#x27;, &#x27;error&#x27;);
          this.templateFieldValidateObj.url &#x3D; false;
        }
      }
    });
    hasFalseKeys &#x3D; Object.keys(this.templateFieldValidateObj).some(k &#x3D;&gt; !this.templateFieldValidateObj[k]);
    if(hasFalseKeys){
      return true
    }else{
      return false
    }
  }else{
    return false
  }
  }
  saveTemplate() {
    this.submitted &#x3D; true;
    const validateText &#x3D; this.validateFeildTextCompare();

    if (this.validateTemplate() &amp;&amp; !validateText) {
      let url: any;
      let payload: any;
      let queryparams: any;
      let appearnce: any;
      let message: any;
      if (this.selectedSourceType &#x3D;&#x3D; &#x27;Action&#x27;) {
        appearnce &#x3D; &#x27;action&#x27;;
      } else if (this.selectedSourceType &#x3D;&#x3D; &#x27;FAQs&#x27;) {
        appearnce &#x3D; &#x27;faq&#x27;;
      } else if (this.selectedSourceType &#x3D;&#x3D; &#x27;Pages&#x27; || this.selectedSourceType &#x3D;&#x3D; &#x27;Web&#x27;) {
        appearnce &#x3D; &#x27;page&#x27;;
      } else if (this.selectedSourceType &#x3D;&#x3D; &#x27;Structured Data&#x27;) {
        appearnce &#x3D; &#x27;structuredData&#x27;;
      } else if (this.selectedSourceType &#x3D;&#x3D; &#x27;Document&#x27; || this.selectedSourceType &#x3D;&#x3D; &#x27;File&#x27;) {
        appearnce &#x3D; &#x27;document&#x27;;
      }
      payload &#x3D; {
        &quot;type&quot;: this.customizeTemplateObj.template.typeId,
        &quot;layout&quot;: {
          &quot;layoutType&quot;: this.customizeTemplateObj.template.searchResultlayout.layout,
          &quot;isClickable&quot;: this.customizeTemplateObj.template.searchResultlayout.clickable,
          &quot;behaviour&quot;: this.customizeTemplateObj.template.searchResultlayout.behaviour,
          &#x27;textAlignment&#x27;: this.customizeTemplateObj.template.searchResultlayout.textAlignment
        },
        &quot;mapping&quot;: {
          &quot;heading&quot;: this.customizeTemplateObj.template.resultMapping.headingId,
          &quot;description&quot;: this.customizeTemplateObj.template.resultMapping.descriptionId,
          &quot;img&quot;: this.customizeTemplateObj.template.resultMapping.imageId,
          &quot;url&quot;: this.customizeTemplateObj.template.resultMapping.urlId
        },
        &quot;appearanceType&quot;: appearnce
      }
      if (this.selectedTemplatedId) {
        url &#x3D; &quot;put.SI_saveTemplate_Id&quot;;
        queryparams &#x3D; {
          searchIndexId: this.serachIndexId,
          templateId: this.selectedTemplatedId,
          indexPipelineId: this.indexPipelineId
        }
        // delete payload[&#x27;appearanceType&#x27;];
        message &#x3D; &quot;Template Updated Successfully&quot;
      }
      else {
        url &#x3D; &quot;post.SI_saveTemplate&quot;;
        queryparams &#x3D; {
          searchIndexId: this.serachIndexId,
          interface: this.selectedSetting,
          indexPipelineId: this.indexPipelineId
        }
        message &#x3D; &quot;Template Added Successfully&quot;
      }
      this.service.invoke(url, queryparams, payload).subscribe(res &#x3D;&gt; {
        if (this.selectedSourceType &#x3D;&#x3D; &#x27;Structured Data&#x27;) {
          this.headerService.updateResultTemplateMapping(true);
        }
        this.notificationService.notify(message, &#x27;success&#x27;);
        this.selectedTemplatedId &#x3D; &quot;&quot;;
        this.getSettings(this.selectedSetting);
        this.closeCustomModal();
        if (this.selectedSetting) {
          if (this.selectedSetting &#x3D;&#x3D; &#x27;liveSearch&#x27;) {
            this.mixpanel.postEvent(&#x27;Result Templates - Updates to Live Search&#x27;, {})
          } else if (this.selectedSetting &#x3D;&#x3D; &#x27;search&#x27;) {
            this.mixpanel.postEvent(&#x27;Result Templates -  Updates to Conversational Search&#x27;, {})
          } else if (this.selectedSetting &#x3D;&#x3D; &#x27;fullSearch&#x27;) {
            this.mixpanel.postEvent(&#x27;Result Templates - Updates to Full Page Results&#x27;, {})
          }
        }
      }, errRes &#x3D;&gt; {
        this.errorToaster(errRes, &#x27;Failed to get fields&#x27;);
      });
    }
    else if(!this.validateTemplate()){
      this.notificationService.notify(&#x27;Enter the required fields to proceed&#x27;, &#x27;error&#x27;);
    }
  }
  getFieldAutoComplete() {
    const query: any &#x3D; &#x27;&#x27;;
    // const quaryparms: any &#x3D; {
    //   searchIndexID: this.serachIndexId,
    //   indexPipelineId: this.indexPipelineId,
    //   query
    // };
    // const url &#x3D; &#x27;get.getFieldAutocomplete&#x27;
    const url &#x3D; &#x27;get.presentableFields&#x27;
    const quaryparms: any &#x3D; {
      isSelected:true,
      sortField: &quot;fieldName&quot;,
      orderType: &#x27;asc&#x27;, //desc,
      indexPipelineId:this.indexPipelineId,
      streamId:this.selectedApp._id,
      queryPipelineId:this.queryPipelineId,
      searchKey:&#x27;&#x27;
    };
    this.service.invoke(url, quaryparms).subscribe(res &#x3D;&gt; {
      this.heading_fieldData &#x3D; [...res.data];
      this.desc_fieldData &#x3D; [...res.data];
      this.img_fieldData &#x3D; [...res.data];
      this.url_fieldData &#x3D; [...res.data];
      this.fieldData &#x3D; [...res.data];
      this.allFieldData &#x3D; [...res.data];
    }, errRes &#x3D;&gt; {
      this.errorToaster(errRes, &#x27;Failed to get fields&#x27;);
    });
  }
  errorToaster(errRes, message) {
    if (errRes &amp;&amp; errRes.error &amp;&amp; errRes.error.errors &amp;&amp; errRes.error.errors.length &amp;&amp; errRes.error.errors[0].msg) {
      this.notificationService.notify(errRes.error.errors[0].msg, &#x27;error&#x27;);
    } else if (message) {
      this.notificationService.notify(message, &#x27;error&#x27;);
    } else {
      this.notificationService.notify(&#x27;Somthing went worng&#x27;, &#x27;error&#x27;);
    }
  }

  updateResultTemplateTabsAccess() {
    if (this.searchExperienceConfig &amp;&amp; Object.values(this.searchExperienceConfig).length) {
      // console.log(this.searchExperienceConfig);
      if (this.searchExperienceConfig &amp;&amp; this.searchExperienceConfig.experienceConfig &amp;&amp; this.searchExperienceConfig.experienceConfig.searchBarPosition) {
        if (this.searchExperienceConfig.experienceConfig.searchBarPosition &#x3D;&#x3D;&#x3D; &#x27;top&#x27;) {
          this.searchTemplatesDisabled &#x3D; true;
          this.getAllSettings({ id: &quot;fullSearch&quot;, text: &quot;Full Page Result&quot; });
        }
        else {
          this.searchTemplatesDisabled &#x3D; false;
        }
      }
    }
    else {
      this.searchTemplatesDisabled &#x3D; false;
    }
  }

  getConfigurationName(referInterface) {
    if (referInterface &#x3D;&#x3D;&#x3D; &#x27;livesearch&#x27;) {
      return &#x27;Live Search&#x27;;
    }
    else if (referInterface &#x3D;&#x3D;&#x3D; &#x27;search&#x27;) {
      return &#x27;Conversational Search&#x27;;
    }
    else if (referInterface &#x3D;&#x3D;&#x3D; &#x27;fullsearch&#x27;) {
      return &#x27;Full Page Result&#x27;;
    }
    else {
      return referInterface;
    }
  }

  ngOnDestroy() {
    if (this.subscription) {
      this.subscription.unsubscribe();
    }
    this.searchConfigurationSubscription ? this.searchConfigurationSubscription.unsubscribe() : false;
  }

}

/** Setting Class **/

class selectedSettingResults {
  _id &#x3D; &quot;&quot;
  resultClassification &#x3D; {
    &#x27;isEnabled&#x27;: true,
    &#x27;sourceType&#x27;: &quot;sys_content_type&quot; //dataContentType
  }
  view &#x3D; &quot;fit&quot;
  maxResultsAllowed &#x3D; 10
  facets: {
    aligned: &quot;left&quot;,
    isEnabled: false
  }
  interface &#x3D; &quot;search&quot;
  referInterface &#x3D; &quot;&quot;
  appearance &#x3D; [
    {
      &quot;type&quot;: &quot;action&quot;,
      &quot;templateId&quot;: &quot;&quot;
    },
    {
      &quot;type&quot;: &quot;faq&quot;,
      &quot;templateId&quot;: &quot;&quot;
    },
    {
      &quot;type&quot;: &quot;page&quot;,
      &quot;templateId&quot;: &quot;&quot;
    },
    {
      &quot;type&quot;: &quot;structuredData&quot;,
      &quot;templateId&quot;: &quot;&quot;
    }
  ]
  streamId &#x3D; &quot;&quot;
  searchIndexId &#x3D; &quot;&quot;
  createdOn &#x3D; &quot;&quot;
  orderBasedOnRelevance &#x3D; true
}


/** Template Class **/
class customizeTemplate {
  template: template &#x3D; new template();
}
class template {
  type &#x3D; &#x27;&#x27;;
  typeId &#x3D; &#x27;&#x27;;                    // list1  list 2 or card or carousel
  searchResultlayout: searchResultlayout &#x3D; new searchResultlayout();
  resultMapping: resultMapping &#x3D; new resultMapping();
  preview &#x3D; &#x27;&#x27;;                 // collapsable / clickable
}
class searchResultlayout {
  layout &#x3D; &#x27;&#x27;;                // title with text / image / Centered Content
  clickable &#x3D; true;
  behaviour &#x3D; &#x27;webpage&#x27;;          // &#x27;webpage&#x27; or &#x27;postback&#x27;
  url &#x3D; &#x27;&#x27;;
  textAlignment &#x3D; &#x27;left&#x27;;
}
class resultMapping {
  heading &#x3D; &#x27;&#x27;;
  headingId &#x3D; &#x27;&#x27;;
  description &#x3D; &#x27;&#x27;;
  descriptionId &#x3D; &#x27;&#x27;;
  image &#x3D; &#x27;&#x27;;
  imageId &#x3D; &#x27;&#x27;;
  url &#x3D; &#x27;&#x27;;
  urlId &#x3D; &#x27;&#x27;;
}

/** Template API Response Class */
class templateResponse {
  &quot;_id&quot; &#x3D; &quot;&quot;
  &quot;layout&quot; &#x3D; {
    &quot;layoutType&quot;: &quot;tileWithText&quot;,
    &quot;isClickable&quot;: false,
    &quot;behaviour&quot;: &quot;webpage&quot;,
    &quot;textAlignment&quot;: &quot;left&quot;
  }
  &quot;type&quot; &#x3D; &quot;&quot; // grid , list
  &quot;mapping&quot; &#x3D; {
    &quot;heading&quot;: &quot;&quot;,  // ids
    &quot;description&quot;: &quot;&quot;,  // ids
    &quot;img&quot;: &quot;&quot;,  // ids
    &quot;url&quot;: &quot;&quot;  // ids or free text
  }
  &quot;createdBy&quot; &#x3D; &quot;&quot;
  &quot;createdOn&quot; &#x3D; &quot;&quot;
  &quot;searchIndexId&quot; &#x3D; &quot;&quot;
  &quot;streamId&quot; &#x3D; &quot;&quot;
  &quot;lModifiedOn&quot; &#x3D; &quot;&quot;
  &quot;__v&quot;: 0
}

</code></pre>
    </div>
</div>









                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'template.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
