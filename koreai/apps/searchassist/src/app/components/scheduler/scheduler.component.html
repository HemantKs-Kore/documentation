<!-- Common Schedular popup  -->
<kr-modal modalType="center" modalClass="modal_popups_ schedualarDataModelPop" #schedualarDataModelPop>
  <div class="modal-header">
    <div class="title">Schedule</div>
  </div>
  <perfect-scrollbar class="perfect-scroll-modal-body" #perfectScroll>
    <div class="row m-0 schedular_row_data">
      <ng-container *ngIf="!isCustom">
      <div class="col-12 row_column m-0">
        <div class="calender">  
          <mat-card class="demo-inline-calendar-card"> 
            <mat-calendar [(selected)]="startDate"  (selectedChange)="verticalDatepicker($event)"></mat-calendar>
          </mat-card>
        </div>
      </div>
      <div class="col-12 row_column middle_content">      
        <div class="scheduletitle">Time</div>
        <div class="middle_content">
          <div class="kr-sg-input-text">          
            <input id="scheduleHr" type="number" min="0" max="12" placeholder="HH" name = "timeHH" [(ngModel)] = "timeHH" (ngModelChange)="modelChangeFn($event,'HH')" class="input-text">
          </div>
          <div class="kr-sg-input-text">          
            <input id="scheduleMn" type="number" min="0" max="59" class="input-text timeMM" placeholder="MM" name = "timeMM" [(ngModel)] = "timeMM"  (ngModelChange)="modelChangeFn($event,'MM')"> 
          </div>
          <div id="schedule-AM" class="schedule-AM" [ngClass] = "{'active' : meridiem === 'AM'}" (click)="changeMeridiem('AM')" >AM</div>
          <div id="schedule-PM"  class="schedule-PM" [ngClass] = "{'active' : meridiem === 'PM'}" (click)="changeMeridiem('PM')" >PM</div>
          <div class="kr-sg-dropdowns schedule-timZon">
            <div class="dropdown dropdown-open">
              <button class="dropdown-toggle dropdown-input" data-toggle="dropdown"><span [ngClass] = "{'schedule-drop-text' : stz === 'Time Zone'}" >{{stz}}</span></button>                                            
              <ul class="dropdown-menu content-menu min-width-0">                                               
                <li *ngFor="let zone of timeZoneArray" (click) = "timeZone(zone)" [ngClass]="{'font-weight-bold':(stz===zone)}"><a>{{zone}}</a></li>
              </ul>
            </div>
        </div>
        </div>
      </div>
      <div class="col-12 row_column mt-15 recurringFrequencyBlock">  
        <div class="kr-sg-checkbox">
          <input id="recurringFrequency" class="checkbox-custom" type="checkbox" [(ngModel)]="recurringFrequency">
          <label for="recurringFrequency" class="checkbox-custom-label">Recurring Frequency</label>
      </div>
        <div class="kr-sg-dropdowns schedule-Interval">
          <div class="dropdown dropdown-open">
              <button class="dropdown-toggle dropdown-input" [ngClass]="{'dropdown-disable':recurringFrequency===false}" data-toggle="dropdown" [disabled]="!recurringFrequency"> <span>{{rstz}}</span></button>                                            
              <ul class="dropdown-menu content-menu">                                               
                <li *ngFor="let frequency of recurringFrequencyArray" [ngClass]="{'font-weight-bold':(frequency.value===rstz)}" (click) = "(frequency.value==='Custom')?openCustomRecModal(frequency.value):repeatTimeZone(frequency.value)"><a>{{frequency.key}}</a></li>
              </ul>
            </div>
        </div>
      </div>
    </ng-container>
      <!-- custom shedular html start from here -->
      <div class="custom-ref new-custom-ref" *ngIf="isCustom">
        <div class="modal_content">
          <div class="shedualr-seacondary-header">
           <span class="cr-chev-left-icon" (click)="gotoPreviousPage()"><i class="si-chev-down"></i></span> <span class="shedualr-seacondary-heading">Custom Recurrence</span>
          </div>
          <div class="modal-body">
            <div class="cust-ref inner-modal">
              <div class="label-text">Repeat Every</div>
  
              <div class="repeat-input">
                <input id="repeatveryId" type="number" min="1" max="30" class="input-text cust-repeat" placeholder="0" [(ngModel)] = "repeatEvery" (ngModelChange)="modelChangeFn($event,'repeatEvery')"> 
              </div>
              
              <div class="kr-sg-dropdowns schedule-Interval">
                <div class="dropdown dropdown-open">
                    <button class="dropdown-toggle dropdown-input cust-repeat-type" data-toggle="dropdown"> {{custFreq}}</button>                                            
                    <ul class="dropdown-menu content-menu content-width min-width-0">                                               
                      <li *ngFor="let repeat of repeatEveryArray" [ngClass]="{'font-weight-bold':((repeat===custFreq&&repeatEvery=='1')||(repeat+'s'===custFreq&&repeatEvery!='1'))}" (click)="custFrequency(repeat+'s')"><a>{{repeat}}<span *ngIf="repeatEvery!='1'">s</span></a></li>
                    </ul>
                  </div>
              </div>
            </div>
            <div class="repeat-on">
              <div class="label-text">Repeat On</div>
              <div class="days-name" *ngIf="['Weeks','Week','weeks'].includes(custFreq)"> 
                <div class="circle" [ngClass] = "{'active' : weeKDay === 'SUN'}" (click)="custweeKday('SUN')">S</div>
                <div class="circle" [ngClass] = "{'active' : weeKDay === 'MON'}" (click)="custweeKday('MON')">M</div>
                <div class="circle" [ngClass] = "{'active' : weeKDay === 'TUE'}" (click)="custweeKday('TUE')">T</div>
                <div class="circle" [ngClass] = "{'active' : weeKDay === 'WED'}" (click)="custweeKday('WED')">W</div>
                <div class="circle" [ngClass] = "{'active' : weeKDay === 'THU'}" (click)="custweeKday('THU')">T</div>
                <div class="circle" [ngClass] = "{'active' : weeKDay === 'FRI'}" (click)="custweeKday('FRI')">F</div>
                <div class="circle" [ngClass] = "{'active' : weeKDay === 'SAT'}" (click)="custweeKday('SAT')">S</div>
              </div>
              <div class="custom-repeat-on" *ngIf="!['Weeks','Week','weeks'].includes(custFreq)" [ngStyle]="{'margin-top':(['Weeks','Week','weeks'].includes(custFreq))?'85px':'0px'}"> 
                 <ng-container *ngIf="['Days','Day','days'].includes(custFreq)">Repeat Every {{repeatEvery}} {{custFreq}} from {{month}} {{date}} {{year}} </ng-container> 
                 <ng-container *ngIf="['Months','Month','months'].includes(custFreq)">Repeat Every {{repeatEvery}} {{custFreq}} On {{dateOrdinal}}</ng-container>
                 <ng-container *ngIf="['Years','Year','years'].includes(custFreq)">Repeat Every {{repeatEvery}} {{custFreq}} from {{month}} {{dateOrdinal}}  </ng-container>
              </div>
            </div>
            <div class="ends shedular-ends-form">
                <div class="label-text">Ends</div>
              <div class="ends-never row">
                <input type="radio" name="radio" value ="endsNever" class="ends-radio" [checked] = "endsOnSelected === 'never'" (click)="endsFreq('never')"> <span class="sp sp-n">Never</span>
              </div>
              <div class="ends-never sp-on row">
                <input type="radio" name="radio" value ="endsOn" class="ends-radio" [checked] = "endsOnSelected === 'on'" (click)="endsFreq('on')"> <span class="sp">On</span>
                <div class="">       
                  <input matInput [matDatepicker]="dpCust" [min]="minDate"  class="input-text date-pick" placeholder="Select Date" [(ngModel)] = "endDate" (dateInput)="addEventCustom('input', $event,'custom')" (dateChange)="addEventCustom('change', $event , 'custom')" autocomplete="off" [disabled] = "!endsOn" >
                  <mat-datepicker-toggle matSuffix [for]="dpCust"></mat-datepicker-toggle>
                  <mat-datepicker #dpCust [disabled]="!endsOn"></mat-datepicker>
                </div>
              </div>
              <div class="ends-never sp-at row ">
                <input type="radio" name="radio"  value ="endsAt" class="ends-radio" [checked] = "endsOnSelected === 'after'" (click)="endsFreq('after')"> <span class="sp">At</span>
                <input id="occurenceId" type="number" min="0" max="4" class="input-text date-pick" placeholder="0" [(ngModel)]="occurence" [disabled] = "!endsAt" onKeyPress="if(this.value.length===4) return false;"> <span class="occur-span">Occurrences</span>
              </div>
            </div>
          </div> 
      </div> 
    </div>
    </div>
  </perfect-scrollbar>
  <div class="shedular-footer">
    <button class="kr-sg-button-secondary btn_lg" (click)="openCloseSchedular('close')">Cancel</button>
    <button class="kr-sg-button-primary btn_lg" (click)="isCustom?(isCustom=false):sendScheduleData()">Ok</button>
  </div>
</kr-modal>