<div class="rules-table-container">
    <div class="tab-sec-top" *ngIf="attributes && attributes.groups && attributes.groups.length && !loading">
        <div class="header-sec">
            <div class="kr-sg-input-search">                               
                <input type="text" placeholder="Search" class="input-search" id="searchFaqs" name='faqsSearch' [(ngModel)]="searchBlock">
                <img src="assets/icons/search-gray.svg" class="search-icon">
            </div>
            <button class="kr-sg-button-secondary btn_lg" (click)="addEditAttibutes()">Add</button>
        </div>
    </div>
    <div class="table-list-content attributes-rules-tab-content" *ngIf="attributes && attributes.groups && attributes.groups.length && !loading">
        <div class="kr-sg-data-table with-checkbox">
            <section class="table-content">
            <header class="table-header">
                <div class="col_ col-3">
                <div class="kr-sg-checkbox hide">
                    <input id="checkbox-10" class="checkbox-custom" type="checkbox">
                    <label for="checkbox-10" class="checkbox-custom-label"></label>
                </div> 
                <span>FIELD NAME<img src="assets/icons/caretDown.svg" class="ml-1 sortImg"></span>
                </div>
                <div class="col_ col-4">DEFINITION</div>
                <div class="col_ col-2">TYPE</div>
                <div class="col_ col-2">IS FACET</div>
            </header>
            <perfect-scrollbar class="table-scroll-perfect">
                <ng-container>
                <div class="content-body" *ngFor="let attribute of attributes.groups  |  filter:[ searchBlock ,'name']">
                    <div class="col_ col-3">
                    <div class="kr-sg-checkbox hide">
                        <input id="checkbox-10" class="checkbox-custom" type="checkbox">
                        <label for="checkbox-10" class="checkbox-custom-label"></label>
                    </div> 
                    <span>{{attribute.name}}</span>
                    </div>
                    <div class="col_ col-4"><span class='eachAttr' *ngFor="let value of attribute.attributes; let i = index ">{{value.value + ((index === (attribute.attributes.length-1))?'':',')}} </span></div>  
                    <div class="col_ col-2" >{{attribute.type || 'System/Auto'}}</div>  
                    <div class="col_ col-2">{{attribute.isFacet || 'Yes' }}</div>         
                    <div class="col_ col-1 pl-0 text-right pr-4 actions">
                    <img src="assets/images/edit-pencil.svg" class="mr-4 hide">
                    <img src="assets/icons/delete-table.svg">
                    </div>   
                </div>
                </ng-container>
                <div class="divBlockEmptylastChild">No Results found</div>
            </perfect-scrollbar>
            <div class="footer-btns" *ngIf="selectedRulesOnj && selectedRulesOnj.selectedCount">
                <button class="kr-sg-button-primary btn_lg">Send for Review</button>
                <button class="kr-sg-button-danger btn_lg">Delete</button>
            </div>
            </section>
        </div>
    </div>
    <div *ngIf="loading" class="p-5 text-center">
        Loading....
    </div>    
    <div *ngIf="!(attributes?.groups && attributes?.groups.length) && !loading" class="text-center">    
        <div class="empty-questions-selected" *ngIf="!(rules && rules.length) && !loadingRules">
            <img src="assets/images/icons/empty_ill.svg">
            <div class="heading">No Attributes added yet</div>
            <!-- <div class="desc">Please add rules</div> -->
            <button class="kr-sg-button-secondary btn_lg" (click)="addEditAttibutes()">Add</button>
        </div>
    </div>
</div>

<kr-modal modalType="center" modalClass="modal_popups_" #addAttributesModalPop>
    <div class="modal-header">
        <div class="title">Add Fields</div>
        <div class="close_icon"><img class="ng-tns-c11-2" src="assets/icons/modal-close.svg" (click)='closeAddAttributesModal()'></div>
      </div>
      <perfect-scrollbar class="perfect-scroll-modal-body">
        <div class="modal-body">
            <div class="kr-sg-input-text mb-20">
                <div class="label-text">Field Name</div>
                <input type="text" placeholder="Enter name" class="input-text" [(ngModel)]="addEditattribute.name" required autocomplete="off">             
            </div>
            <div for="tagInput" class="label_text">Values</div>
            <mat-form-field class="example-chip-list mb-20" [floatLabel]="'never'">
            <mat-chip-list #chipList aria-label="tag selection">
                <mat-chip *ngFor="let tag of addEditattribute.attributes; let index = index" (removed)="removeAltTag(tag)">
                    <div class="mat-value" *ngIf="tag">{{tag.value}}</div> 
                <mat-icon matChipRemove><img src="assets/images/close.svg"></mat-icon>
                </mat-chip>
                <input placeholder="Type & enter" [(ngModel)]="addEditattribute.newTag" [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes" name = "tagInput"  (matChipInputTokenEnd)="addAltTag($event)" id="tagInput" (click)="$event.stopPropagation()">
            </mat-chip-list>
            </mat-form-field> 
            <div class="kr-sg-dropdowns w-100 d-none">
            <div class="label-text">Label</div>
            <div class="dropdown dropdown-open">
                <button class="dropdown-toggle dropdown-input" data-toggle="dropdown">{{addEditattribute.type?addEditattribute.type:'Choose'}}</button>                                            
                <ul class="dropdown-menu content-menu">
                    <li (click)="addEditattribute.type='systemAuto'">System/Auto</li>
                    <li (click)="addEditattribute.type='custom'">Custom</li>
                </ul>
            </div>
            </div>
            <div class="kr-sg-dropdowns w-100">
            <div class="label-text">is Facet?</div>
            <div class="dropdown dropdown-open">
                <button class="dropdown-toggle dropdown-input" data-toggle="dropdown">{{addEditattribute.isFacet?addEditattribute.isFacet:'Choose'}}</button>                                            
                <ul class="dropdown-menu content-menu">
                    <li (click)="addEditattribute.isFacet='Yes'"><a>Yes</a></li>
                    <li (click)="addEditattribute.isFacet='No'"><a>No</a></li>
                </ul>
                </div>
            </div>
        </div>
      </perfect-scrollbar> 
   <div class="modal-footer">                               
        <button class="kr-sg-button-primary btn_md" (click)="saveAttributes()">Add</button>
        <button class="kr-sg-button-secondary btn_md" data-dismiss="modal" (click)="closeAddAttributesModal()">Cancel</button>
   </div>
</kr-modal>