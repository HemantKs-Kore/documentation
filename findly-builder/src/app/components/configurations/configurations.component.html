<div class="config-container" [ngClass]="{'headerCreation': toShowAppHeader}" *ngIf="!loading && !showErrorScreen" [@fadeInOutAnimation]>
    <div class="configuration-page">
        <div class="left-side-sec pr-0">
            <perfect-scrollbar class="left-sec-scrollbar" [disabled]="workflowService.disablePerfectScroll">
            <div class="setup-data">
                <div class="user-avatar">
                    <img src="assets/images/icons/user-icon.svg">
                </div>
                <div class="card-content">
                    <div class="title">SmartAssist.ai Set-up</div>
                    <div class="selected-tabs">
                        <div class="position-relative">
                            <div class="tab-sec" [class.active]="config.deflectConfiguration.type === 'IVR'" (click)="scrollTo('deflectConfiguration')">
                                <span class="img-block first"><img src="assets/images/deflect-icon.svg"></span>
                                <span class="content-title">Transfer to SmartAssist.ai</span>
                            </div>
                            <ng-container *ngIf="config.deflectConfiguration.type === 'IVR'">
                                <div class="info-title" *ngIf="config.deflectConfiguration.IVR.completed"><img src="assets/images/icons/Check.svg"> Completed</div>
                                <div class="info-title warning" *ngIf="!config.deflectConfiguration.IVR.completed"><img src="assets/images/icons/Warning.svg"> Not Completed </div>
                            </ng-container>
                            
                        </div>    
                        <div class="position-relative">                   
                            <div class="tab-sec" [class.active]="config.deflectConfiguration.type === 'phoneNumber'" (click)="scrollTo('deflectConfiguration')">
                                <span class="img-block first"><img src="assets/images/deflect-icon.svg"></span>
                                <span class="content-title">SmartAssist.ai Phone  Number </span>
                            </div>
                            <ng-container *ngIf="config.deflectConfiguration.type === 'phoneNumber'">
                                <div class="info-title" *ngIf="config.deflectConfiguration.phoneNumber.completed"><img src="assets/images/icons/Check.svg"> Completed</div>
                                <div class="info-title warning" *ngIf="!config.deflectConfiguration.phoneNumber.completed"><img src="assets/images/icons/Warning.svg"> Not Completed</div>
                            </ng-container>
                        </div> 
                    </div>
                </div>
                <div class="card-content">
                    <div class="title">Automated Conversations</div>
                    <div class="selected-tabs">
                        <div class="position-relative">
                            <div class="tab-sec" [class.active]="config.virtualAssistant.type === 'voice' && config.virtualAssistant.enabled" (click)="scrollTo('virtualAssistant')">
                                <span class="img-block"><img src="assets/images/icons/Chat_bot_white.svg"></span>
                                <span class="content-title">Virtual Voice Assistant</span>
                            </div>
                            <ng-container *ngIf="config.virtualAssistant.type === 'voice' && config.virtualAssistant.enabled">
                                <div class="info-title"><img src="assets/images/icons/Check.svg"> Completed</div>
                            </ng-container>
                            <!-- <div class="info-title warning"><img src="assets/images/icons/Warning.svg"> Not Completed </div> -->
                        </div>
                        <div class="position-relative">
                            <div class="tab-sec" [class.active]="config.virtualAssistant.type === 'chat' && config.virtualAssistant.enabled" (click)="scrollTo('virtualAssistant')">
                                <span class="img-block"><img src="assets/images/icons/Chat_bot_white.svg"></span>
                                <span class="content-title">Virtual Chat Assistant</span>
                            </div>
                            <ng-container *ngIf="config.virtualAssistant.type === 'chat' && config.virtualAssistant.enabled">
                                <div class="info-title"><img src="assets/images/icons/Check.svg"> Completed</div>
                            </ng-container>
                        </div>
                    </div>
                </div>
                <div class="card-content mb-0">
                    <div class="title">Handoff Experience</div>
                    <div class="selected-tabs">
                        <div class="position-relative">
                            <div class="tab-sec" [class.active]="config.handOff.formSubmission" (click)="scrollTo('handOff')">
                                <span class="img-block"><img src="assets/images/icons/list.svg" ></span>
                                <span class="content-title">Submit Request to Agent</span>
                            </div>
                            <ng-container *ngIf="config.handOff.formSubmission">
                                <div class="info-title" *ngIf="config.handOff.isFormCompleted"><img src="assets/images/icons/Check.svg"> Completed</div>
                                <div class="info-title warning" *ngIf="!config.handOff.isFormCompleted"><img src="assets/images/icons/Warning.svg"> Not Completed</div>
                            </ng-container>
                        </div>
                        <div class="position-relative">
                            <div class="tab-sec" [class.active]="config.handOff.liveAgent" (click)="scrollTo('transferToLiveChat')">
                                <span class="img-block"><img src="assets/images/icons/Transfer_to_live_agent_white.svg"></span>
                                <span class="content-title">Live Chat Agent</span>
                            </div>
                            <ng-container *ngIf="config.handOff.liveAgent">
                                <div class="info-title" *ngIf="config.handOff.isAgentDetailsCompleted"><img src="assets/images/icons/Check.svg"> Completed</div>
                                <div class="info-title warning" *ngIf="!config.handOff.isAgentDetailsCompleted"><img src="assets/images/icons/Warning.svg"> Not Completed</div>
                            </ng-container>
                        </div>
                    </div>
                </div>
            </div>
            <div class="completed-percent">
                <div class="percentage">{{completedPercentage}}%</div>
                <div class="info-title">Completed</div>
                <mat-progress-bar mode="determinate" [value]="completedPercentage" class="mat-custom-progress"></mat-progress-bar>
            </div>
            <p class="flowMessageText" *ngIf="configForm && configForm.dirty" [@fadeInOutAnimation]>Don’t forget to visit <a class="messageLink" [routerLink]="['/call-flow-messages']">Call Flow Messages</a> to customize your  message experience</p>
            </perfect-scrollbar>
        </div>
        <div class="right-side-sec">
            <perfect-scrollbar (psScrollDown)="onScrollDown($event)" #mainScroll="ngxPerfectScrollbar" [disabled]="workflowService.disablePerfectScroll">
                <form #configForm="ngForm" style="border: none !important;" autocomplete="off">    
                <div class="scroll-list">
                    <div class="deflect-setup-data deflect-setup" id="deflectConfiguration">
                        <div class="main-title">SmartAssist.ai Set-up</div>
                        <div class="desc-info-text">Choose how your customers will reach SmartAssist.ai</div>
                        <div class="row ml-0 mr-0 radio-buttons-sec">
                            <div class="col-6 pl-0">
                                <div class="kr-sg-radiobutton pr-0">
                                    <input id="IVR" name="deflectConfiguration" value="IVR" [(ngModel)]="config.deflectConfiguration.type" class="radio-custom" type="radio" checked (change)="checkIVRStatus()">
                                    <label for="IVR" class="radio-custom-label">Transfer Calls from IVR System
                                        <div class="desc-info-text">I have an IVR System and I will redirect some of my IVR Calls to SmartAssist.ai</div>
                                    </label>                        
                                </div>                                 
                            </div>
                            <div class="col-6 pl-0">
                                <div class="kr-sg-radiobutton pr-0">
                                    <input id="phoneNumber" name="deflectConfiguration" value="phoneNumber" [(ngModel)]="config.deflectConfiguration.type" class="radio-custom" type="radio" (change)="setCompletedStatus()">
                                    <label for="phoneNumber" class="radio-custom-label">Call SmartAssist.ai Phone Number
                                        <div class="desc-info-text">I want a new SmartAssist.ai Phone Number and allow my customers to directly call this number</div>
                                    </label>
                                </div>                                 
                            </div>
                        </div>
                        <div class="w-100 ivr-transfor-setup box-content">
                            <ng-container *ngIf="config.deflectConfiguration.type === 'IVR'">
                                <div class="label_text">SIP Call Transfer Setup
                                    <button class="kr-sg-button-primary btn_md" (click)="enableIntegration('sip')" *ngIf="emptyDeflectionType">Enable</button>
                                </div>
                                <div class="desc-info-text">Transfer your IVR calls to SmartAssist.ai app by initiating SIP sessions.</div>
                            </ng-container>
                            <ng-container *ngIf="config.deflectConfiguration.type === 'phoneNumber'">
                                <div class="label_text">Phone number Setup</div>
                                <div class="desc-info-text">Choose a country of your preference. A phone number from this country will be allocated.</div>
                            </ng-container>
                            <div class="actions-box-content">
                                <div class="input-actions" *ngIf="config.deflectConfiguration.type === 'IVR'" [class.disabled]="emptyDeflectionType">
                                    <div class="kr-sg-input-text mb-3">
                                        <div class="label-text font-weight-bold">SIP Domain Name <span (click)="copyTextFromInput($event, sipDomainName)">Copy</span></div>
                                        <input type="text" name="sipDomainName" class="input-text cursor-notallowed" readonly [(ngModel)]="config.deflectConfiguration.sipDomainConfigDetails.sipDomainName" #sipDomainName>                                        
                                    </div>                                 
                                    <div class="kr-sg-input-text-area domain-name mb-3">
                                        <div class="label-text font-weight-bold">Incoming IP Address</div>
                                        <textarea placeholder="" name="incomingIpAddresses" class="input-text" [(ngModel)]="config.deflectConfiguration.sipDomainConfigDetails.incomingIpAddresses" [ngModelOptions]="{updateOn: 'blur'}" #ipAddress="ngModel" required pattern="^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|\*)(?:,\s*(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|\*))*$" (blur)="onBlurIpAddress(ipAddress.valid)"></textarea>                                
                                        <div class="error-msg" *ngIf="ipAddress.touched && ipAddress.errors && ipAddress.errors.required">IP Address is required</div>
                                        <div class="error-msg" *ngIf="ipAddress.touched && ipAddress.errors && ipAddress.errors.pattern">Please enter a valid IP Address</div>
                                    </div>
                                    <div class="kr-sg-dropdowns">
                                        <div class="label-text font-weight-bold">Language Preferance</div>
                                        <div class="dropdown dropdown-open">
                                            <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" disabled>English</button>                                            
                                            <ul class="dropdown-menu content-menu">                                                                                          
                                            <li><a>English</a></li>
                                            </ul>
                                        </div>
                                    </div>                                 
                                </div>
                                <div class="input-actions" *ngIf="config.deflectConfiguration.type === 'phoneNumber'">
                                    <div class="kr-sg-dropdowns mb-2 pb-1" [class.country-code-drp-down-sec]="!config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber">
                                        <div class="label-text font-weight-bold">Country Name</div>
                                        <div class="dropdown dropdown-open">
                                            <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" [disabled]="config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber">{{selectedCountry && selectedCountry['Country'] || 'Select a Country'}}</button>                                            
                                            <ul class="dropdown-menu content-menu">
                                                <li class="search-box">
                                                    <input type="text" placeholder="Search" class="seach-input" name="countryCodeSearchTerm" #countryCodeSearchTerm (input)="countryCodeSearchTerm.value === $event.target.value">
                                                </li>      
                                                <perfect-scrollbar class="country-code-perfect-scroll" [disabled]="workflowService.disablePerfectScroll">
                                                    <li (click)="onClickCountryCode(item); countryCodeSearchTerm.value=''" *ngFor="let item of countryCodeDetailsFromSeedData | filter: [ countryCodeSearchTerm.value, 'Country']"><a>{{item.Country}}</a></li>
                                                </perfect-scrollbar>
                                            </ul>
                                        </div>
                                        <!-- <button class="kr-sg-button-primary btn_md" (click)="enableIntegration('phoneNumberTransfer')" *ngIf="!config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber" [disabled]="!selectedCountry">Enable</button> -->
                                    </div>
                                    <button class="kr-sg-button-secondary-two mr-4 btn_md" *ngIf="!selectedCountry" [disabled]="!selectedCountry">Request a number</button>
                                    <ng-container *ngIf="selectedCountry && selectedCountry['ISO'] !== 'US'">
                                        <button class="kr-sg-button-secondary-two mr-4 btn_md" (click)="enableIntegration('phoneNumberTransfer')" *ngIf="!config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber">Request a number</button>
                                        <div class="kr-sg-input-text" *ngIf="config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber">
                                            <div class="label-text font-weight-bold">Phone Number <span (click)="copyTextFromInput($event, phoneNumber)">Copy</span></div>
                                            <input type="text" name="phoneNumber" placeholder="" class="input-text font-weight-bold cursor-notallowed" readonly [(ngModel)]="config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber" #phoneNumber>
                                        </div>
                                    </ng-container>
                                    <div class="phone-number-selection" *ngIf="selectedCountry && selectedCountry['ISO'] === 'US'">
                                        <div class="kr-sg-radiobutton">
                                            <input id="localNumber" name="phoneNumberType" class="radio-custom" type="radio" [(ngModel)]="phoneNumberType" value="local" [disabled]="!!(config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber) && phoneNumberType !== 'local'">
                                            <label for="localNumber" class="radio-custom-label">Local Number</label>
                                        </div> 
                                        <div class="kr-sg-radiobutton">
                                            <input id="tollFreeNumber" name="phoneNumberType " class="radio-custom" type="radio" [(ngModel)]="phoneNumberType" value="tollfree" [disabled]="!!(config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber) && phoneNumberType !== 'tollfree'">
                                            <label for="tollFreeNumber" class="radio-custom-label">Toll-free Number</label>
                                        </div> 
                                        <div class="kr-sg-input-text mt-3 mb-2">
                                            <div class="label-text font-weight-bold">Phone Number <span (click)="copyTextFromInput($event, phoneNumber)" *ngIf="config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber">Copy Number</span></div>
                                            <input type="text" name="phoneNumber" placeholder="" class="input-text font-weight-bold cursor-notallowed" readonly [(ngModel)]="config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber" #phoneNumber>
                                            <!-- <div class="error-msg">Error message here</div> -->
                                        </div>
                                        <div class="d-flex align-items-center mt-3 pt_2" *ngIf="!config.deflectConfiguration.phoneNumberConfigDetails.phoneNumber">
                                            <button class="kr-sg-button-secondary-two mr-4 btn_md" (click)="enableIntegration('phoneNumberTransfer')">Request a number</button>
                                            <button class="kr-sg-button-ghost btn_md" (click)="openPhNumSlider()">Choose a phone number</button>
                                        </div>
                                    </div>
                                </div>                               
                            </div>                    
                        </div>                
                    </div>
                    <div class="deflect-setup-data automate-conversions" id="virtualAssistant">
                        <div class="main-title">Automate Conversations 
                            <label class="kr-sg-toggle with-label">                                       
                            <input type="checkbox" name="virtualAssistant" [(ngModel)]="config.virtualAssistant.enabled" (change)="setCompletedPercentage()">
                            <div class="slider"> <span class="no">Disabled</span><span class="yes">Enabled</span></div>
                            </label>
                        </div>
                        <div class="desc-info-text col-9 pl-0">Fulfill customer requests by automatically answering their queries using Virtual Assistants powered by Kore.ai</div>
                        <div class="sub-container" [class.disabled]="!config.virtualAssistant.enabled">
                            <div class="row ml-0 mr-0 radio-buttons-sec">
                                <div class="col-6 pl-0">
                                    <div class="kr-sg-radiobutton pr-0">
                                        <input id="voice" name="virtualAssistantType" value="voice" [(ngModel)]="config.virtualAssistant.type" class="radio-custom" type="radio" checked>
                                        <label for="voice" class="radio-custom-label">Use Virtual Voice Assistant
                                            <div class="desc-info-text">Customer calls will be directly answered by a Virtual Voice Assistant</div>
                                        </label>                        
                                    </div>                                     
                                </div>
                                <div class="col-6 pl-0">
                                    <div class="kr-sg-radiobutton pr-0">
                                        <input id="chat" name="virtualAssistantType" value="chat" [(ngModel)]="config.virtualAssistant.type" class="radio-custom" type="radio">
                                        <label for="chat" class="radio-custom-label">Use Virtual Chat Assistant
                                            <div class="desc-info-text">Customers will be deflected to a chat interface where they can interact with a Virtual Chat Assistant</div>
                                        </label>
                                    </div>                                     
                                </div>
                            </div>
                            <div class="w-100 ivr-transfor-setup box-content">
                                <div class="info-text mb-3" *ngIf="config.virtualAssistant.enabled">Customers often prefer self-service over waiting in line. With voice and text-based virtual agents, you can fully automate most routine customer issues.</div>             
                                <div class="info-text" [ngClass]="{'mb-3': !config.virtualAssistant.enabled}">Build your custom voice or text-based virtual agents using Kore.ai <b>Virtual Assistant Platform</b>. You  can define intents, build tasks, train, test, deploy and manage your virtual agents.</div>
                                <div class="info-text" *ngIf="!config.virtualAssistant.enabled">Enable it to build your Virtual Assistant Platform</div>
                                <div class="actions-box-content voice-assistance" *ngIf="config.virtualAssistant.enabled">
                                    <img src="assets/images/onboarding/Direct_Call_BW.png">
                                </div>
                                <div class="launch-btn">
                                    <button class="kr-sg-button-primary btn_lg" (click)="launchPlatform()">Launch Virtual Assistant Platform</button>
                                </div>                    
                            </div>  
                        </div>
                        
                    </div>     
                    <div class="deflect-setup-data hands-off-experience" id="handOff">
                        <div class="main-title">Handoff Experience</div>
                        <div class="desc-info-text">Choose how to handoff customer conversations to agents when the Virtual Assistants are not enabled or when they cannot answer user requests. Customers will be asked to choose an option when more than one option is enabled.
                            Customize your messages for handoff Experience by <span class="clickable-text" [routerLink]="['/call-flow-messages']">Call Flow Messages</span>
                        </div>              
                        <div class="w-100 ivr-transfor-setup box-content">
                            <div class="label_text f-20">Submit request to agent  
                                <label class="kr-sg-toggle with-label">                                       
                                <input type="checkbox" name="formSubmission" [(ngModel)]="config.handOff.formSubmission" (change)="setFormCompletedStatus()">
                                <div class="slider"> <span class="no">Disabled</span><span class="yes">Enabled</span></div>
                                </label>
                            </div>                   
                            <div class="actions-box-content">
                                <div class="row m-0 radio-buttons-sec p-50" *ngIf="!config.handOff.formSubmission">
                                    <div class="info-text">Enable this section to configure a service request form that your customers can fill out and submit to your agents.</div>
                                </div>
                                <div class="row m-0 radio-buttons-sec" *ngIf="config.handOff.formSubmission">
                                    <div class="col-12 p-0">
                                        <!-- <div class="kr-sg-radiobutton pr-0">
                                            <input id="reqViaEmail" name="radio" class="radio-custom" type="radio" checked>
                                            <label for="reqViaEmail" class="radio-custom-label">Submit a request via email
                                                <div class="desc-info-text">Customers can submit their request using a form and the form will be sent as an email to your agent.</div>
                                            </label>                        
                                        </div>        -->
                                        <div class="label_text">Submit a request via email</div>     
                                        <div class="desc-info-text">Customers can submit their request using a form and the form will be sent as an email to your agent.</div>                             
                                        <div class="input-actions pl-50">
                                            <div class="kr-sg-input-text">
                                                <div class="label-text font-weight-bold">Agent Email Address</div>
                                                <input type="text" readonly name="agentEmail" placeholder="Enter agent email address" class="input-text" [(ngModel)]="config.handOff.formDetails.agentEmail" [ngModelOptions]="{updateOn: 'blur'}" #agentEmail="ngModel" required email (blur)="setFormCompletedStatus(agentEmail.valid)"> 
                                                <div class="error-msg" *ngIf="agentEmail.touched && agentEmail.errors && agentEmail.errors.required">Agent Email is required</div>
                                                <div class="error-msg" *ngIf="agentEmail.touched && agentEmail.errors && agentEmail.errors.email">Please enter a valid email id</div>                                  
                                            </div>                                                                                                     
                                        </div>
                                    </div>
                                    <!-- <div class="col-12 p-0">
                                        <div class="kr-sg-radiobutton pr-0">
                                            <input id="reqToHelpDesk" name="radio" class="radio-custom" type="radio">
                                            <label for="reqToHelpDesk" class="radio-custom-label">Submit a request to helpdesk
                                                <div class="desc-info-text">Customer service requests will be created as tickets in your ticketing system.</div>
                                            </label>
                                        </div>                                         
                                        <div class="input-actions pl-30">  
                                            <div class="d-flex pl-20">
                                                <div class="helpdesk-logo selected">
                                                    <img src="assets/images/logoIcon.png">                                        
                                                </div>  
                                                <div class="helpdesk-logo">
                                                    <img src="assets/images/logoIcon.png">                                        
                                                </div>  
                                            </div>                                                                   
                                            <div class="submit-request-form">
                                                    <div class="kr-sg-input-text mb-2 pb-1">
                                                        <div class="label-text font-weight-bold">Webhook URL</div>
                                                        <input type="text" placeholder="Webhook URL" class="input-text">                                        
                                                    </div>
                                                    <div class="kr-sg-input-text mb-2 pb-1">
                                                        <div class="label-text font-weight-bold">Access Token</div>
                                                        <input type="text" placeholder="Access Token" class="input-text">                                        
                                                    </div>
                                                    <div class="kr-sg-input-text">
                                                        <div class="label-text font-weight-bold">CallBack URL</div>
                                                        <input type="text" placeholder="CallBack URL" class="input-text">                                        
                                                    </div>
                                            </div>
                                        </div>
                                    </div> -->
                                </div>
                               <div id="previewForm">
                                <mat-drawer-container class="submit-form custom-mat-drawer-container" hasBackdrop="true" *ngIf="config.handOff.formSubmission">
                                    <mat-drawer #addFielddrawer position="end" (closedStart)="OnDrawerClose()" class="mat-drawer-slider">
                                        <div class="add-field-drawer">
                                            <form [formGroup]="addFieldForm" class="h-100" style="border: none !important;">
                                                <div class="form-edit-header">
                                                    <div class="kg-sr-input-inline-search">                               
                                                        <input type="text" placeholder="display name" class="input-search text-center" formControlName="displayName">                                                        
                                                        <!-- <img src="assets/images/amend-edit.svg" class="search-icon"> -->
                                                        <img src="assets/images/onboarding/close.svg" class="search-icon" (click)="addFielddrawer.close()">
                                                    </div>                                      
                                                </div>
                                                <div class="form-body pt-20">
                                                    <div class="scroll-form-body">
                                                        <perfect-scrollbar [disabled]="workflowService.disablePerfectScroll">
                                                            <div class="pr-20 pl-20">
                                                                <div class="kr-sg-input-text mb-15">
                                                                    <div class="label-text font-weight-bold">Field Name</div>
                                                                    <input type="text" placeholder="Please enter field name" class="input-text" formControlName="name" #fieldName>
                                                                    <div class="error-msg" *ngIf="addFieldForm.get('name').touched && addFieldForm.get('name').invalid">Field Name is required</div>
                                                                </div>
                                                                <div class="kr-sg-input-text mb-15">
                                                                    <div class="label-text font-weight-bold">HelpText  (optional)</div>
                                                                    <input type="text" placeholder="You can place your help text here" class="input-text" formControlName="helpText">
                                                                </div>
                                                                
                                                                <div>
                                                                    <div class="label_text">Data Type</div>
                                                                    <mat-form-field class="custom-mat-select">
                                                                        <mat-label>Choose Option</mat-label>
                                                                        <mat-select disableOptionCentering="true" formControlName="dataType">
                                                                            <mat-option [value]="item" *ngFor="let item of dataTypeList"> {{item | titlecase}}</mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>

                                                                <div>
                                                                    <div class="label_text">Field Type</div>
                                                                    <mat-form-field class="custom-mat-select">
                                                                        <mat-label>Choose Option</mat-label>
                                                                        <mat-select disableOptionCentering="true" formControlName="type">
                                                                            <mat-option [value]="item.id" *ngFor="let item of fieldTypeList"> {{item.name}}</mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>

                                                                <ng-container [ngSwitch]="addFieldForm.controls.type.value">
                                                                    <div *ngSwitchCase="'date'">
                                                                        <div class="label_text">Format</div>
                                                                        <mat-form-field class="custom-mat-select">
                                                                            <mat-label>Choose Option</mat-label>
                                                                            <mat-select disableOptionCentering="true" formControlName="dFormat">
                                                                                <mat-option [value]="item" *ngFor="let item of dateFormatList"> {{item}}</mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div *ngSwitchCase="'datetime'">
                                                                        <div class="label_text">Format</div>
                                                                        <mat-form-field class="custom-mat-select">
                                                                            <mat-label>Choose Option</mat-label>
                                                                            <mat-select disableOptionCentering="true" formControlName="dTFormat">
                                                                                <mat-option [value]="item" *ngFor="let item of dateTimeFormat"> {{item}}</mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    
                                                                    <div class="mb-20 static-dropdown-selection"  *ngSwitchCase="'staticDropDown'">
                                                                        <div class="header-titles d-flex justify-content-between">
                                                                             <div class="label_text">Options</div>
                                                                             <div class="add-option-btn" (click)="addDropdownOption()">+<span>Add Option</span></div>
                                                                        </div>
                                                                        <div class="row ml-0 mr-0 add-option-header-titles">
                                                                             <div class="col-3 label_text p-0">Default</div>
                                                                             <div class="col-5 label_text p-0">Option Name</div>
                                                                             <div class="col-4 label_text p-0">Option Value</div>
                                                                        </div>
                                                                        <ng-container formArrayName="dOptions">
                                                                            <div class="add-options-sec" *ngFor="let item of addFieldForm.get('dOptions')['controls']; let i = index;" [formGroupName]="i">
                                                                                <div class="radio-sec" (click)="chooseDefaultOption(i)">
                                                                                    <div class="kr-sg-radiobutton">
                                                                                        <input class="radio-custom" name="staticDropDownOptions" type="radio" [value]="i" [checked]="addFieldForm.get('defaultOption').value === i">
                                                                                        <label for="radio-1" class="radio-custom-label"></label>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="input-sec">
                                                                                    <div class="kr-sg-input-text">
                                                                                        <input type="text" placeholder="Placeholder text" class="input-text" formControlName="name">
                                                                                    </div>
                                                                                </div>
                                                                                <div class="input-sec">
                                                                                    <div class="kr-sg-input-text">
                                                                                        <input type="text" placeholder="Placeholder text" class="input-text" formControlName="value">
                                                                                    </div>
                                                                                </div>
                                                                                <div class="delete-field" (click)="removeDropdownOption(i)"><i class="fa fa-trash-o" aria-hidden="true"></i></div>
                                                                            </div>
                                                                        </ng-container>
                                                                     </div>
     
                                                                     <div *ngSwitchCase="'file'">
                                                                         <div class="mb-20 static-dropdown-selection">
                                                                             <div class="header-titles d-flex justify-content-between">
                                                                                  <div class="label_text">Add File Upload Payload Field</div>
                                                                                  <div class="add-option-btn" (click)="addFileOption()">+<span>Add Option</span></div>
                                                                             </div>
                                                                             <div class="row ml-0 mr-0 add-option-header-titles text-center p-0">
                                                                                  <div class="col-6 label_text p-0 d-block">File Upload Payload Field Key</div>
                                                                                  <div class="col-6 label_text p-0 d-block">File Upload Payload Field Value</div>                                                                     
                                                                             </div>
                                                                             <ng-container formArrayName="fileOptions">
                                                                                <div class="add-options-sec" *ngFor="let item of addFieldForm.get('fileOptions')['controls']; let i = index;" [formGroupName]="i">                                                                    
                                                                                    <div class="input-sec">
                                                                                         <div class="kr-sg-input-text">                                                                    
                                                                                             <input type="text" placeholder="Placeholder text" class="input-text" formControlName="name">                                                                       
                                                                                         </div>
                                                                                    </div>
                                                                                    <div class="input-sec">
                                                                                        <div>
                                                                                            <!-- <div class="label_text">Data Type</div> -->
                                                                                            <mat-form-field class="custom-mat-select m-0 drp-down-mat">
                                                                                                <mat-label>Choose Option</mat-label>
                                                                                                <mat-select disableOptionCentering="true" formControlName="value">
                                                                                                    <mat-option [value]="item.id" *ngFor="let item of filePayloadOptions"> {{item.value}}</mat-option>
                                                                                                </mat-select>
                                                                                            </mat-form-field>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="delete-field" (click)="removeFileOption(i)"><i class="fa fa-trash-o" aria-hidden="true"></i></div>
                                                                                </div>
                                                                             </ng-container>
                                                                          </div>
                                                                          <div class="m-0 row">
                                                                             <div class="desc-info-text col-4 p-0">Allow Multiple File </div>
                                                                             <label class="kr-sg-toggle">                                       
                                                                                 <input type="checkbox" formControlName="allowMultipleFiles">
                                                                                 <div class="slider"><span class="enabled">Yes</span><span class="disabled">No</span></div>
                                                                             </label> 
                                                                         </div>
                                                                     </div>

                                                                     <div *ngSwitchCase="'typeahead'">
                                                                        <div class="kr-sg-input-text mb-15">
                                                                            <div class="label-text font-weight-bold">Endpoint URL</div>
                                                                            <input type="text" placeholder="https://integration.api.io/requestid" class="input-text" formControlName="endPointUrl">
                                                                            <div class="error-msg" *ngIf="addFieldForm.get('endPointUrl').touched && addFieldForm.get('endPointUrl').invalid">
                                                                                <span *ngIf="addFieldForm.get('endPointUrl').errors.required">Endpoint URL is required</span>
                                                                                <span *ngIf="addFieldForm.get('endPointUrl').errors.pattern">Endpoint URL is Invalid</span>
                                                                            </div>
                                                                        </div>

                                                                        <div>
                                                                            <div class="label_text">Endpoint Content Type</div>
                                                                            <mat-form-field class="custom-mat-select">
                                                                                <mat-label>Choose Option</mat-label>
                                                                                <mat-select disableOptionCentering="true" formControlName="endPointContType">
                                                                                    <mat-option [value]="item" *ngFor="let item of endPointContentType"> {{item}}</mat-option>
                                                                                </mat-select>
                                                                            </mat-form-field>
                                                                        </div>

                                                                        <div>
                                                                            <div class="label_text">Endpoint Method</div>
                                                                            <mat-form-field class="custom-mat-select">
                                                                                <mat-label>Choose Option</mat-label>
                                                                                <mat-select disableOptionCentering="true" formControlName="endPointMethod">
                                                                                    <mat-option [value]="item" *ngFor="let item of endPointMethod"> {{item}}</mat-option>
                                                                                </mat-select>
                                                                            </mat-form-field>
                                                                        </div>

                                                                        <div class="kr-sg-input-text mb-15">
                                                                            <div class="label-text font-weight-bold">Response Path</div>
                                                                            <input type="text" placeholder="path to lookup in url response" class="input-text" formControlName="responsePath">
                                                                            <div class="error-msg" *ngIf="addFieldForm.get('responsePath').touched && addFieldForm.get('responsePath').invalid">Response Path is required</div>
                                                                        </div>
                                                                        <div class="kr-sg-input-text mb-15">
                                                                            <div class="label-text font-weight-bold">Label Key</div>
                                                                            <input type="text" placeholder="label key" class="input-text" formControlName="labelKey">
                                                                            <div class="error-msg" *ngIf="addFieldForm.get('labelKey').touched && addFieldForm.get('labelKey').invalid">Label Key is required</div>
                                                                        </div>
                                                                        <div class="kr-sg-input-text mb-15">
                                                                            <div class="label-text font-weight-bold">Option Value Key</div>
                                                                            <input type="text" placeholder="value key" class="input-text" formControlName="optValKey">
                                                                            <div class="error-msg" *ngIf="addFieldForm.get('optValKey').touched && addFieldForm.get('optValKey').invalid">Option Value Key is required</div>
                                                                        </div>
                                                                     </div>
                                                                </ng-container>

                                                                <div class="kr-sg-input-text mb-15" *ngIf="showPlaceholder">
                                                                    <div class="label-text font-weight-bold">Placeholder</div>
                                                                    <input type="text" placeholder="placeholder for the field" class="input-text" formControlName="placeholder">
                                                                </div>
                                                                <div class="row m-0">
                                                                    <div class="desc-info-text col-4 p-0">Is Optional</div>
                                                                    <label class="kr-sg-toggle">                                       
                                                                        <input type="checkbox" formControlName="isOptional">
                                                                        <div class="slider"><span class="enabled">Yes</span><span class="disabled">No</span></div>
                                                                    </label> 
                                                                </div>
                                                                <div class="m-0 row">
                                                                    <div class="desc-info-text col-4 p-0">Is Multi Select</div>
                                                                    <label class="kr-sg-toggle">                                       
                                                                        <input type="checkbox" formControlName="isMultiSelect">
                                                                        <div class="slider"><span class="enabled">Yes</span><span class="disabled">No</span></div>
                                                                    </label> 
                                                                </div>
                                                            </div>
                                                        </perfect-scrollbar>
                                                    </div>
                                                    <div class="add-field-btn">                                                    
                                                        <button class="kr-sg-button-primary" [disabled]="addFieldForm.invalid" (click)="addField(); addFielddrawer.close()">{{isOpenedForEdit ? 'Update' : 'Add'}}</button>                                                    
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                      </mat-drawer>
                                      <mat-drawer-content>
                                        <div class="title-text">Please configure the form to define the information you would like to capture from your customers. You can modify the default fields and add new fields.</div>
                                        <div class="form-inner">
                                            <div class="form-content">
                                                <div class="form-edit-header">
                                                    <input type="text" readonly name="formName" class="form-header" [(ngModel)]="config.handOff.formDetails.formName" [ngModelOptions]="{updateOn: 'blur'}" #formName="ngModel" required (blur)="setFormCompletedStatus(formName.valid)">
                                                    <!-- <span><img src="assets/images/amend-edit.svg"></span> -->
                                                </div>
                                                <div class="form-body">
                                                    <div class="scroll-form-body">
                                                        <perfect-scrollbar [disabled]="workflowService.disablePerfectScroll">

                                                             <!-- NON-EMPTY SCREEN STYLES -->

                                                            <div class="pr-20 pl-20" *ngIf="config.handOff.formDetails.payloadFields.length !== 0" style="pointer-events: none;">
                                                                <div *ngFor="let field of config.handOff.formDetails.payloadFields; let i = index" [ngSwitch]="field.type">
                                                                    <div class="kr-sg-input-text-area mb-2 pb-1 position-relative" *ngSwitchCase="'textarea'">
                                                                        <div class="label-text font-weight-bold m-0">{{field.displayName}}</div>
                                                                        <textarea [placeholder]="field.placeholder" class="input-text"></textarea>
                                                                        <!-- <span class="close-input" (click)="removeField(i)"><img src="assets/images/closeCross.png"></span> -->
                                                                    </div>
                                                                    <div class="kr-sg-input-text-area mb-2 pb-1 position-relative" *ngSwitchCase="'staticDropDown'">
                                                                        <div class="label-text font-weight-bold m-0">{{field.displayName}}</div>
                                                                        <select class="form-control" (mousedown)="$event.preventDefault()">
                                                                            <option *ngFor="let item of field.dOptions; let i = index" [value]="item.value" [selected]="field.defaultOption === i">{{item.name}}</option>
                                                                        </select>
                                                                        <!-- <span class="close-input" (click)="removeField(i)"><img src="assets/images/closeCross.png"></span> -->
                                                                    </div>
                                                                    <div class="kr-sg-input-text mb-2 pb-1 position-relative" *ngSwitchCase="'date'">
                                                                        <div class="label-text font-weight-bold">{{field.displayName}}</div>
                                                                        <input type="text" [placeholder]="field.dFormat" class="input-text">
                                                                        <!-- <span class="close-input" (click)="removeField(i)"><img src="assets/images/closeCross.png"></span> -->
                                                                    </div>
                                                                    <div class="kr-sg-input-text mb-2 pb-1 position-relative" *ngSwitchCase="'datetime'">
                                                                        <div class="label-text font-weight-bold">{{field.displayName}}</div>
                                                                        <input type="text" [placeholder]="field.dTFormat" class="input-text">
                                                                        <!-- <span class="close-input" (click)="removeField(i)"><img src="assets/images/closeCross.png"></span> -->
                                                                    </div>
                                                                    <div class="kr-sg-input-text-area mb-2 pb-1 position-relative" *ngSwitchCase="'file'">
                                                                        <div class="label-text font-weight-bold">{{field.displayName}}</div>
                                                                        <input type="file" class="form-control-file" (click)="$event.preventDefault()">
                                                                        <!-- <span class="close-input" (click)="removeField(i)"><img src="assets/images/closeCross.png"></span> -->
                                                                    </div>
                                                                    <div class="kr-sg-input-text mb-2 pb-1 position-relative" *ngSwitchDefault>
                                                                        <div class="label-text font-weight-bold">{{field.displayName}}</div>
                                                                        <input type="text" [placeholder]="field.placeholder" class="input-text">
                                                                        <!-- <span class="close-input" (click)="removeField(i)"><img src="assets/images/closeCross.png"></span> -->
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- NON-EMPTY SCREEN STYLES ENDS HERE -->


                                                            <!-- EMPTY SCREEN STYLES -->
                                                            <div class="no-data-form" *ngIf="config.handOff.formDetails.payloadFields.length === 0">
                                                                <div class="img-block"><img src="assets/images/icons/empty-illustration.svg"></div>
                                                                <div class="empty-title">Empty Form</div>
                                                                <div class="empty-info">Your form is empty.</div>
                                                                <div class="empty-info">Please click “Edit form” to add and modify fileds in your form.</div>
                                                            </div>
                                                            <!--EMPTY SCREEN STYLES END -->

                                                        </perfect-scrollbar>
                                                    </div>                                                   
                                                    <!-- <div class="add-field-btn">
                                                        <div class="success-message" *ngIf="showFieldAddedSuccessMsg"><img src="assets/images/onboarding/check.svg">Form field added successfully</div>
                                                        <div class="success-message" *ngIf="showFieldUpdatedSuccessMsg"><img src="assets/images/onboarding/check.svg">Form field updated successfully</div>
                                                        <button class="kr-sg-button-primary" (click)="openAddFieldForm()">+ <span>Add Field</span></button>
                                                        <button class="kr-sg-button-primary" (click)="addFielddrawer.toggle()">+ <span>Add Field</span></button>
                                                    </div> -->
                                                </div>                                             
                                            </div>
                                            <div class="edit-form-info">
                                                <div class="title-info">
                                                    This is a smaple form .Please configure the form to define the information you would like to capture from your customers. 
                                                </div>
                                                <div class="title-info">You can modify the default fields and add new fields.</div>
                                                <button class="kr-sg-button-primary mb-4"  (click)="openEditForm()"><img src="assets/images/icons/edit-white.svg" class="pr-2">Edit Form</button>
                                                <div class="success-message" *ngIf="showFieldUpdatedSuccessMsg"><img src="assets/images/onboarding/check-green.svg">Form details updated successfully</div>
                                            </div>
                                        </div>
                                      </mat-drawer-content>
                                </mat-drawer-container>     
                               </div>                                         
                            </div>                    
                        </div>                
                    </div>
                    <div class="deflect-setup-data transfer-live-chat" id="transferToLiveChat">
                        <div class="w-100 ivr-transfor-setup box-content">                           
                            <div class="label_text f-20">Transfer to Live Chat Agent
                                <label class="kr-sg-toggle with-label">                                       
                                <input type="checkbox" name="liveAgent" [(ngModel)]="config.handOff.liveAgent" (change)="setCompletedPercentage()">
                                <div class="slider"> <span class="no">Disabled</span><span class="yes">Enabled</span></div>
                                </label>
                            </div>                              
                            <div class="actions-box-content" *ngIf="config.handOff.liveAgent">
                                <div class="desc-info-text mb-15 pl-0">Customers will be handed-off to live agents. Choose a Live Agent system and provide the required configurations.</div>
                                <app-live-chat-agent [agentDetails]="config.handOff.agentDetails" (onUpdate)="onLiveChatAgentChanges($event)"></app-live-chat-agent>
                           </div>          
                            <div class="actions-box-content p-50" *ngIf="!config.handOff.liveAgent">
                                <div class="info-text">Enable this section to seamlessly hand-off your customers to agents. Easily connect your live agent systems from Unblu, ServiceNow, Salesforce, or any other system using the custom integration.</div>
                            </div>       
                        </div> 
                    </div>
                </div>
                </form>
            </perfect-scrollbar>
            <div class="save-action-btn d-flex align-items-center">
                <button class="kr-sg-button-primary btn_lg d-flex align-items-center" (click)="onSave()" [disabled]="!allowConfigSave">Save<div class="loader-in-button ml-2" *ngIf="!allowConfigSave"><img src="assets/images/icons/fa-spinner.svg"></div></button>
                <div class="success-message-notification" *ngIf="successMsg"><img src="assets/images/check-green.svg">{{successMsg}}</div>
                <div class="error-message-notification" *ngIf="errorMsg"><img src="assets/icons/Warn.svg">{{errorMsg}}</div>
            </div>
            <div class="gif-arrow-down" *ngIf="showArrow" [@fadeInOutAnimation]>
                <img src="assets/images/onboarding/arrow-gif.gif">
            </div>
        </div>
    </div>


</div>

<app-slider-component id="edit-form" >
    <app-edit-form (closed)="closeEditForm($event)" *ngIf="showEditForm"></app-edit-form>
</app-slider-component>

<app-slider-component id="phNumSlider" #choosePhNumSlider='app-slider'>
    <app-choose-phone-number [phoneNumberType]="phoneNumberType" (closed)="closePhNumSlider($event)" *ngIf="showPhNumSlider"></app-choose-phone-number>
</app-slider-component>

<div class="manage-form-please-wait-all" *ngIf="loading" [@fadeInOutAnimation]>
    <mat-spinner diameter="18" strokeWidth="2"></mat-spinner>
    <span class="please-wait-message">Please Wait!</span>
</div>

<div class="error-container" *ngIf="!loading && showErrorScreen" [@fadeInOutAnimation]>
    <div class="err-img">
        <img src="assets/images/empty-illustration.png">
    </div>
    <div class="err-msg">
        Something went wrong, Please try later.
    </div>
</div>