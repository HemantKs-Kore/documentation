
<div class="mainLoadingSpinner" *ngIf="loadingFaqs" [@fadeInOutAnimation]>
    <mat-spinner diameter="18" strokeWidth="2"></mat-spinner>
    <span class="please-wait-message">{{'sa_please_wait' | translate}}</span>
</div>
<div class="faqmain-container" *ngIf="loadingFaqs1">
    <app-useronboarding-journey [componentType]='componentType'></app-useronboarding-journey>
    <div class="faqsListContainer">
        <div class="faq-header-sec row m-0">
            <div class="col-6 left-sec p-0 faq-title" >{{'faqSource_faqs' | translate}}
                <span class="module-topic" tooltipClass="tooltip-global-" [container]="'body'" ngbTooltip='{{"sa_topic_guide" | translate}}'
 placement="right-center"(click)="openUserMetaTagsSlider()">
                    <i class="si-topic-guide-1"></i>
                </span>
            </div>
            <div class="col-6 p-0 right-sec d-flex align-items-center justify-content-end">
                <div class="kr-sg-dropdowns add w-auto"  #selectSourceDrop='ngbDropdown'ngbDropdown [container]="'body'" [placement]="'bottom-right'" *ngIf="(faqs && faqs.length) || (extractedResources && extractedResources.length) || (faqSelectionObj.stats.draft || faqSelectionObj.stats.in_review || faqSelectionObj.stats.approved) || viewDetails || extractedFaqs">
                    <div class="dropdown dropdown-open mr-4 cursor-pointer">
                        <div _ngcontent-rjr-c36="" class="dropdown-toggle" data-identifyelement="1" ngbDropdownToggle><img _ngcontent-rjr-c36="" class="mr-2 mb-1" src="assets/icons/add_plus.svg">Add FAQ</div>
                        <!-- <button class="dropdown-toggle kr-sg-button-primary btn_lg text-left" ngbDropdownToggle>Add FAQ</button>                                             -->
                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>
                          <li (click)="selectSourceDrop.close();addFaqSource('faqWeb')">{{'faqSource_extract_faqs' | translate}}</li>
                          <li (click)="selectSourceDrop.close();addFaqSource('faqDoc')">{{'faqSource_import_faqs' | translate}}</li>
                          <li (click)="selectSourceDrop.close();addFaqSource('manual')">{{'faqSource_add_manually' | translate}}</li>
                        </ul>
                    </div>
                </div>

                <!-- <div (click)="openStatusModal()" class="title" *ngIf="(faqs && faqs.length) ||  (faqSelectionObj.stats.draft || faqSelectionObj.stats.in_review || faqSelectionObj.stats.approved)"><img src="assets/icons/manage-extraction.svg">Manage Extracts</div> -->
                <div class="clock d-none"><img src="assets/icons/clock.svg"></div>
                <div class="kr-sg-dropdowns w-auto exportdropdown" ngbDropdown [container]="'body'" [placement]="'bottom-right'" *ngIf="(faqs && faqs.length) || (extractedResources && extractedResources.length) || (faqSelectionObj.stats.draft || faqSelectionObj.stats.in_review || faqSelectionObj.stats.approved) || viewDetails || extractedFaqs">
                    <div class="dropdown dropdown-open">
                        <button class="dropdown-toggle p-0 border-0 three-dots" ngbDropdownToggle> <img _ngcontent-aif-c18="" class="ng-tns-c18-5" src="assets/icons/elipse.svg"></button>
                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>
                          <li (click)='exportFaq("json")' *ngIf="(faqs && faqs.length) || (extractedResources && extractedResources.length) || viewDetails">{{'faqSource_export_to_json' | translate}}</li>
                          <li (click)='exportFaq("csv")' *ngIf="(faqs && faqs.length) || (extractedResources && extractedResources.length) || viewDetails">{{'faqSource_export_to_csv' | translate}}</li>
                          <li (click)="openStatusModal()" *ngIf="(faqs && faqs.length) || (extractedResources && extractedResources.length)||  (faqSelectionObj.stats.draft || faqSelectionObj.stats.in_review || faqSelectionObj.stats.approved) || viewDetails">{{'faqSource_manage_extracts' | translate}}</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="export-success-notification d-none">
                <div class="check"><img src="assets/icons/docker/check.svg"></div>
                <div class="desc-info">{{'faqSource_export_to_json_inprogress_check_sd' | translate}}</div>
                <div class="close-notification"><img src="assets/icons/close.svg"></div>
            </div>
        </div>
        <ng-container *ngIf="!(faqSelectionObj.stats.draft || faqSelectionObj.stats.in_review || faqSelectionObj.stats.approved) && !faqSelectionObj.loadingStats && !(extractedResources && extractedResources.length)  && !extractedFaqs && !viewDetails && !searchFaq && !showSearch && !loading">
        <!-- <ng-container *ngIf="!(faqSelectionObj.stats.draft || faqSelectionObj.stats.in_review || faqSelectionObj.stats.approved) && faqSelectionObj.loadingStats && !(extractedResources && extractedResources.length)  && !extractedFaqs && !viewDetails && !searchFaq && !showSearch && !loading"> -->
        <perfect-scrollbar class="empty-scroll">
            <app-empty-screen
            class="empty-lg"
            [width]="170" [height]="170"
            [title]="emptyScreen.TITLE"
            [desc]="emptyScreen.DESC"
            [imgName]="emptyScreen.IMG_NAME"
            (isImgLoading)="isEmptyScreenLoading($event)">
          >
            <div class="action-buttons">
              <button
                class="kr-sg-button-secondary btn_lg mr-2"
                (click)="addFaqSource('faqWeb')"
              >
                <i class="si-web"></i>
                {{ "faqSource_extract_faqs" | translate }}
              </button>
              <button
                class="kr-sg-button-secondary btn_lg mr-2"
                (click)="addFaqSource('faqDoc')"
              >
                <i class="si-union"></i>
                {{ "faqSource_import_faqs" | translate }}
              </button>
              <button
                class="kr-sg-button-secondary btn_lg"
                (click)="addFaqSource('manual')"
              >
                <i class="si-add-plus"></i>
                {{ "faqSource_add_manually" | translate }}
              </button>
            </div>
          </app-empty-screen>
    </perfect-scrollbar>
</ng-container>
        <div class="faq-content-boxes"  *ngIf="((extractedResources && extractedResources.length) || faqSelectionObj.stats.draft || faqSelectionObj.stats.in_review || faqSelectionObj.stats.approved) ||  extractedFaqs || searchFaq || showSearch ||loading">
            <div class="content left-content">
                <div class="content-boxes faq_tasks_list">
                    <div class="tab-sec d-flex" *ngIf="faqSelectionObj.selectedCount == 0">
                        <div class="tab_title" (click)="selectTab('draft')" [ngClass]="{'active': (selectedtab === 'draft')}"> {{'faqSource_drafts' | translate}} <span class="">({{faqSelectionObj.stats.draft || 0}})</span></div>
                        <div class="tab_title" (click)="selectTab('in_review')" [ngClass]="{'active': (selectedtab === 'in_review')}">{{'faqSource_inreview' | translate}}<span class="">({{faqSelectionObj.stats.in_review || 0}})</span></div>
                        <div class="tab_title" (click)="selectTab('approved')"  [ngClass]="{'active': (selectedtab === 'approved')}">{{'faqSource_approved' | translate}} <span class="">({{faqSelectionObj.stats.approved || 0}})</span></div>
                    </div>
                    <div class="header-sec" *ngIf="faqSelectionObj.selectedCount == 0">
                        <div class="kr-sg-checkbox" [ngStyle]="{'visibility':loadingTab ? 'hidden':'visible'}">
                            <input class="checkbox-custom" type="checkbox" id="selectAllFaqs" (change)="headerSelectAll()" [(ngModel)]="faqSelectionObj.selectAll" autocomplete="off">
                            <label for="selectAllFaqs" class="checkbox-custom-label"></label>
                        </div>
                        <div class="kr-sg-dropdowns" #selectResourceDrop='ngbDropdown' ngbDropdown [container]="'body'" [placement]="'bottom'">
                            <div class="dropdown dropdown-open">
                                <!-- <span class="filter-count"  placement="top" ngbTooltip="{{(selectedResource && selectedResource._id)?selectedResource.name:'All'}}">{{(selectedResource && selectedResource._id)?selectedResource.name:'All'}}</span> -->
                                <button class="dropdown-toggle dropdown-input pl-0 mr-2"  ngbDropdownToggle><img src="assets/icons/filter.svg">{{'faqSource_filter' | translate}}</button>
                                <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>
                                    <li  (click)="selectResourceDrop.close();selectResourceFilter()"><span class="list-name">{{'faqSource_all' | translate}} </span><img *ngIf="!(selectedResource && selectedResource._id) && !manualFilterSelected" src="assets/icons/check-blue.svg"></li>
                                    <li  (click)="selectResourceDrop.close();manualFaqsFilter()" *ngIf="noManulaRecords"><span class="list-name"> {{'faqSource_manual' | translate}}</span><img *ngIf="manualFilterSelected" src="assets/icons/check-blue.svg"></li>
                                    <ng-container *ngFor="let source of resources">

                                        <li *ngIf="source.recentStatus.toLowerCase() ==='success'" (click)="selectResourceDrop.close();selectResourceFilter(source)"><span class="list-name">{{source.name}}</span><img *ngIf="selectedResource && (source._id ===  selectedResource._id)" src="assets/icons/check-blue.svg"></li>
                                    </ng-container>
                                </ul>
                            </div>
                        </div>
                        <!-- <div class="seach_add_feild"> -->
                            <!-- Landing page Search -->
                            <div class="kr-sg-input-search"  *ngIf="showSearch">
                                <input type="text" placeholder="{{'sa_search' | translate}}" id="inputSearch" class="input-search" (keyup)="getfaqsBy(null,null,null,searchFaq)" [ngClass]="{'pl-33':!searchFaq,'pl-2':searchFaq}" autocomplete="off" [(ngModel)]="searchFaq"   (mouseover)="searchImgSrc = (searchFocusIn ? 'assets/icons/search_gray.svg' :'assets/icons/search_gray_dark.svg')"
                                (mouseout)="searchFocusIn=false;searchImgSrc = 'assets/icons/search_gray.svg'" (focus)="searchFocusIn=true;searchImgSrc = 'assets/icons/search_gray.svg'">
                            <img [src]="searchImgSrc" class="search-icon" *ngIf="!searchFaq">
                            <img class="close-icon" src="assets/icons/close_icon.svg"  (mouseover)="activeClose=true" (mouseout)="activeClose=false" [ngClass]="{'pr-22':searchFaq}" (click)="focusoutSearch()"  placement="top-center" container='body' ngbTooltip="{{'sa_cancel' | translate}}" tooltipClass="ngb_tooltip_custom_class sampleJson">
                            </div>
                            <div class="seach-block" (click)="showSearch=!showSearch;cdRef.detectChanges();focusinSearch('inputSearch')">
                                <span *ngIf="!showSearch" class="mr-3" id="btn_toggle_search_structured_data" ><img src="assets/icons/search.svg" [ngClass]="{'d-none': showSearch}">{{'sa_search' | translate}}</span>
                            </div>
                        <!-- </div> -->

                        <!-- <div class="kr-sg-input-search">
                            <input type="text" placeholder="Search" class="input-search" [(ngModel)]="searchFaq" id="searchFaqs" name='faqsSearch' (keyup)="searchFaqs()" autocomplete="off">
                            <img src="assets/icons/search-gray.svg" class="search-icon">
                        </div>                       -->
                    </div>
                    <div class="footer-sec-btns row m-0 col-12" *ngIf="faqSelectionObj.selectedCount">
                        <div class="col-4 p-0 d-flex align-items-center">
                            <div class="kr-sg-checkbox" [hidden]="!((selectedtab === 'draft' && faqSelectionObj.selectedCount == faqSelectionObj.stats.draft) || (selectedtab === 'in_review' && faqSelectionObj.selectedCount == faqSelectionObj.stats.in_review) || (selectedtab === 'approved' && faqSelectionObj.selectedCount == faqSelectionObj.stats.approved ) || faqSelectionObj.selectAll) ">
                                <input class="checkbox-custom" type="checkbox" id="selectAllFaqs" (change)="selectAll()" [(ngModel)]="faqSelectionObj.selectAll" autocomplete="off">
                                <label for="selectAllFaqs" class="checkbox-custom-label"></label>
                            </div>
                            <div class="mr-3" *ngIf="(faqSelectionObj.selectedCount>0 && ((selectedtab === 'draft' && faqSelectionObj.selectedCount !== faqSelectionObj.stats.draft) || (selectedtab === 'in_review' && faqSelectionObj.selectedCount !== faqSelectionObj.stats.in_review) || (selectedtab === 'approved' && faqSelectionObj.selectedCount !== faqSelectionObj.stats.approved ))) && !faqSelectionObj.selectAll">
                                <img (click) = "selectAllPartially();" src="assets/icons/resultranking/selected-checkbox.svg" class="search-icon">
                            </div>
                            <div class="title">{{(faqSelectionObj.selectAll)?'All':faqSelectionObj.selectedCount}} Selected</div>
                        </div>
                        <div class="col-8 p-0 d-flex align-items-center justify-content-end">
                            <button class="kr-sg-button-secondary btn_lg ml-0" [ngClass]="{'px-12px':selectedtab === 'approved'}" *ngIf="(selectedtab === 'in_review')" (click)="bulkUpdate('update','draft')"> {{'faqSource_needs_rework' | translate}}</button>
                            <button class="kr-sg-button-primary btn_lg" *ngIf="selectedtab === 'in_review'" (click)="bulkUpdate('update','approved')">{{'faqSource_approve' | translate}}</button>
                            <button class="kr-sg-button-danger btn_lg" *ngIf="(selectedtab === 'draft') || (selectedtab === 'approved')" (click)="deleteQuestion('qstnFAQ',singleSelectedFaq,{})"> {{'faqSource_delete' | translate}}</button>
                            <button class="kr-sg-button-primary btn_lg " [ngClass]="{'px-12px':selectedtab === 'approved'}" *ngIf="(selectedtab === 'approved')" (click)="bulkUpdate('update','draft')"> {{'faqSource_move_to_drafts' | translate}} </button>
                            <button class="kr-sg-button-primary btn_lg" [ngClass]="{'px-12px':selectedtab === 'approved'}" *ngIf="(selectedtab === 'draft') " (click)="bulkUpdate('update','in_review')">{{'faqSource_send_for_review' | translate}}</button>


                        </div>
                    </div>
                    <div class="body-content">
                        <div class="empty-questions-selected"  *ngIf="loadingTab || apiLoading">
                            <div>
                                <div class="heading">{{'please_wait' | translate}}</div>
                            </div>
                        </div>
                        <perfect-scrollbar class="accor-scroll" #fqasScrollContainer [ngClass]="{'show_footer': faqSelectionObj.selectedCount}" (psYReachEnd)="onScrolledEnd($event)" *ngIf="faqSelectionObj.stats[selectedtab]">
                            <ng-container  *ngIf="(faqs && faqs.length) && !loadingTab" >
                            <div class="selected-all-questions" *ngIf="faqSelectionObj.selectedCount && !faqSelectionObj.selectAll " id="selectAllFaqs" (click)="selectAllRecords()" >Select all {{(selectedtab === 'draft' ? faqSelectionObj.stats.draft: (selectedtab === 'in_review' ? faqSelectionObj.stats.in_review:(selectedtab === 'approved' ? faqSelectionObj.stats.approved:'' )))}}  questions</div>
                            <div id="accordion" class="accordion-content">
                                <div *ngFor="let faq of faqs">
                                    <div class="card-content" *ngIf="faq.action!=='delete'">
                                        <div [attr.id]="'faqquestionAcc' + faq._id" (click)="selectedFaqToTrain(faq, $event)" title="{{(faq && faq._source)?faq._source.question:''}}"  class="card_link collapsed" [ngClass]="{'is-selected':(selectedFaq && selectedFaq._id===faq._id) ,'is-checked': ((faqSelectionObj && faqSelectionObj.selectedItems[faq._id]) || faqSelectionObj.selectAll)}" data-toggle="collapse" [attr.data-target]="'#'+faq._id" [attr.aria-controls]="collapseOne">
                                            <span class="published-que" *ngIf="(faq.state==='published')" [ngClass]="{'reverted': (faq.state==='reverted')}">{{faq.state | titlecase}}</span>
                                            <div class="d-flex align-items-center">
                                                <div class="kr-sg-checkbox" (click)="$event.stopImmediatePropagation();">
                                                    <input  [attr.id]="'selectFaqCheckBox_' + faq._id" name="{{faq._id}}" (change)="checkUncheckfaqs(faq)" class="checkbox-custom selectEachfaqInput" type="checkbox" autocomplete="off">
                                                    <label [attr.for]="'selectFaqCheckBox_' + faq._id" class="checkbox-custom-label"></label>
                                                </div>
                                                <div class="title-desc-sec">
                                                    <div class="title">{{faq._source.faq_question}}</div>
                                                    <div class="desc" *ngIf="faq && faq?._source?.faq_answer && faq._source.faq_answer.length && faq._source.faq_answer[0]" [innerHtml]='convertMDtoHTML.helpers.convertMDtoHTML(faq._source.faq_answer[0].text)'></div>
                                                    <!-- <div class="desc" *ngIf="faq && faq._source.defaultAnswers && faq._source.defaultAnswers.length && faq._source.defaultAnswers[0] && faq._source.defaultAnswers[0].type==='javascript'">Javascript message</div> -->
                                                </div>
                                            </div>
                                            <div class="follow_up d-none" ><span (click)="addFollowUp(faq, $event)"><img src="assets/icons/add_plus.svg">{{'faqSource_faqs' | translate}} Follow-up</span></div>
                                        </div>
                                        <div id="{{faq._id}}" class="collapse"  [attr.aria-labelledby]="'faqquestionAcc' + faq._id" data-parent="#accordion">
                                            <div class="cardbody">
                                                <ng-container  *ngIf="faq._meta.followupQuestions && faq._meta.followupQuestions.length">
                                                    <div class="acc-inner-que" (click)="selectedFaqToTrain(followUpQuestion, $event);$event.stopImmediatePropagation();"  [ngClass]="{'is-checked':(selectedFaq && selectedFaq._id===followUpQuestion._id) ||  ((faqSelectionObj && faqSelectionObj.selectedItems[faq._id]) || faqSelectionObj.selectAll)}" *ngFor="let followUpQuestion of faq._meta.followupQuestions">
                                                        <div class="title">{{followUpQuestion._source.faq_question}}</div>
                                                        <ng-container *ngIf="followUpQuestion._source && followUpQuestion._source.defaultAnswers && followUpQuestion._source.defaultAnswers.length">
                                                            <div class="desc" *ngIf="followUpQuestion._source.defaultAnswers[0].type==='string'" [innerHtml]='convertMDtoHTML.helpers.convertMDtoHTML(followUpQuestion._source.defaultAnswers[0].text)'></div>
                                                           <!-- <div class="desc" *ngIf="followUpQuestion._source.defaultAnswers[0].type==='javascript'">Javascript message</div> -->
                                                        </ng-container>
                                                    </div>
                                                </ng-container>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="empty-questions-selected divBlockEmptylastChild">
                                    <div class="heading">{{'faqSource_no_search_results' | translate}} </div>
                                </div>
                            </div>
                            <div class="text-center p-4" [ngClass]="{'hide': !moreLoading.loading}">{{moreLoading.loading?moreLoading.loadingText:'Loading.........'}}</div>
                           </ng-container>
                        </perfect-scrollbar>

                        <app-record-pagination *ngIf="!isNotSearching && !loadingTab && faqSelectionObj.stats[selectedtab] && faqSelectionObj.stats[selectedtab]>10" [totalRecord]='faqSelectionObj.stats[selectedtab]' [limitpage]='faqLimit' (pageChanged)="paginate($event)"></app-record-pagination>
                       <!-- <app-pagination *ngIf="!loadingTab && !searchFaq" [totalRecord]='faqSelectionObj.stats[selectedtab]' [limitpage]='faqLimit' [allInOne]='false' (pageChanged)="paginate($event)"></app-pagination> -->
                        <div class="empty-questions-selected"  *ngIf="!(faqs && faqs.length)">
                            <app-empty-screen
                            [width]="100" [height]="100"
                            *ngIf="!loadingTab"
                            [title]="emptyScreen.TITLE_SEARCH_SOURCES"
                            [desc]="emptyScreen.DESC_SEARCH_SOURCES"
                            [imgName]="emptyScreen.IMG_NAME"
                          >
                          </app-empty-screen>
                            <!-- <ng-container *ngIf="!loadingTab">
                                <img src="assets/images/icons/empty_ill.svg">
                                <div class="heading">{{'faqSource_no_questions' | translate}}</div>
                                <div class="desc">{{'faqSource_please_add_questions' | translate}}</div>
                            </ng-container> -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="content right-content" [ngClass]="{'blur-content': faqSelectionObj.selectedCount >=2}">
                <div class="content-boxes train_your_questions">
                    <ng-container *ngIf="!selectedFaq">
                        <div class="empty-questions-selected">
                        <img src="assets/images/icons/empty_ill.svg">
                        <div class="heading">{{'faqSource_no_questions' | translate}}</div>
                        <div class="desc">{{'faqSource_please_select_questions' | translate}}</div>
                       </div>
                    </ng-container>
                    <ng-container *ngIf="selectedFaq">
                        <div class="header-info-que" *ngIf="selectedFaq && selectedFaq._meta.state === 'in_review'">
                            <div class="row m-0 col-12 p-0">
                                <div class="col-5 p-0 lef-info">
                                    <div class="approved_title">{{'faqSource_sent_for_review_on_caps' | translate}} </div>
                                    <div class="approved_date" ngbTooltip="{{selectedFaq.lMod  | date:'d MMMM yyyy | hh:mm a'}}" placement="top-left">{{selectedFaq.lMod  | date:'d MMMM yyyy | hh:mm a'}}</div>
                                </div>
                                <div class="col-7 p-0 actions-sec">
                                    <div class="kr-sg-dropdowns info_header_dropdown" ngbDropdown [placement]="'bottom-center'" >
                                        <div class="dropdown dropdown-open">
                                            <button class="dropdown-toggle dropdown-input" ngbDropdownToggle><img src="assets/icons/info_header.svg" ngbTooltip="{{'addFaq_info' | translate}}"  [container]="'body'"></button>
                                            <ul class="dropdown-menu content-menu info_header_dropdown_content w-274px" ngbDropdownMenu>
                                                <div class="row m-0 col-12 p-0">
                                                    <div class="col-6 inner-data-column">
                                                        <div class="heading">{{'faqSource_source_caps' | translate}} </div>
                                                        <div class="title" ngbTooltip='{{(selectedFaq.sourceName || contentTypes[selectedFaq.contentSource]) || "Manual"| titlecase}}' placement="top-left">{{(selectedFaq.sourceName || contentTypes[selectedFaq.contentSource]) || 'Manual' | titlecase}}</div>
                                                    </div>
                                                    <div class="col-6 inner-data-column">
                                                        <div class="heading">{{'faqSource_edited_by_caps' | translate}} </div>
                                                        <div class="title" ngbTooltip="{{selectedFaq.userDetails?selectedFaq.userDetails.fullName:'---'}}" placement="top-left">{{selectedFaq.userDetails?selectedFaq.userDetails.fullName:'---'}}</div>
                                                    </div>

                                                    <!-- <div class="col-2 inner-data-column d-none">
                                                        <div class="heading">Type</div>
                                                        <div class="title" ngbTooltip='{{(contentTypes[selectedFaq._meta.contentSource] || "Manual") | titlecase}}' placement="top-left">{{(contentTypes[selectedFaq._meta.contentSource] || "Manual") | titlecase}}</div>
                                                    </div>
                                                    <div class="col-4 inner-data-column d-none">
                                                        <div class="heading">Last Modified</div>
                                                        <div class="title" ngbTooltip="{{selectedFaq.lMod | dateFormatPipe:'MM-DD-YYYY hh:mm:ss A'}}" placement="top-left">{{selectedFaq.lMod | dateFormatPipe:'MM-DD-YYYY hh:mm:ss A'}}</div>
                                                    </div> -->
                                                </div>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="kr-sg-dropdowns comments_header_dropdown"  #commentBox='ngbDropdown' ngbDropdown  [container]="'body'" [placement]="'bottom-right'" *ngIf="(selectedtab === 'draft')  || (selectedtab === 'approved') || (selectedtab === 'in_review')">
                                        <div class="dropdown dropdown-open">
                                            <button class="dropdown-toggle dropdown-input" ngbDropdownToggle><img class="cursor" src="assets/icons/comment.svg" ngbTooltip="{{'addFaq_comment' | translate}}"  [container]="'body'"></button>
                                            <ul class="dropdown-menu content-menu comments_header_dropdown_content" ngbDropdownMenu>
                                                <div class="c-section-data">
                                                    <perfect-scrollbar>
                                                        <div class="body_data">
                                                            <!-- <div class="intial-state d-none">This looks good! <a>Simone</a></div> -->
                                                            <div class="c-data"  *ngFor="let comment of faqComments">
                                                                <div class="user-data">
                                                                    <div class="pro-pic">{{comment.initial}}</div>
                                                                    <div class="user-name-data">
                                                                        <div class="u-name" >{{comment.userDetails?comment.userDetails.fullName:'---'}}</div>
                                                                        <div class="u-time">{{comment.createdOn}}</div>
                                                                        <div class="info-text-user">{{comment.text}}</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="kr-sg-input-text-area">
                                                                <textarea id="changePlaceholder" placeholder="{{'addFaq_add_a_comment' | translate}}" [(ngModel)]="newCommentObj.comment" class="input-text"></textarea>
                                                            </div>
                                                        </div>
                                                    </perfect-scrollbar>
                                                    <div class="footer-data">
                                                        <div class="left_sec d-none"><img src="assets/icons/emoji-black.svg"></div>
                                                        <div class="btn_sec">
                                                            <button class="kr-sg-button-secondary btn_lg" (click)="commentBox.close()">{{'faqSource_cancel' | translate}}</button>
                                                            <button class="kr-sg-button-primary btn_lg" [disabled]='!this.newCommentObj.comment'  (click)="saveComment()">{{'faqSource_post' | translate}} </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center justify-content-end">
                                        <button class="kr-sg-button-primary btn_lg" (click)="updateFaq(selectedFaq,'stateUpdate','approved')">{{'faqSource_approve' | translate}}</button>
                                        <div class="kr-sg-dropdowns add" ngbDropdown [container]="'body'" [placement]="'bottom-right'">
                                            <div class="dropdown dropdown-open">
                                                <button class="dropdown-toggle dropdown-input" ngbDropdownToggle data-toggle="dropdown"><img src="assets/icons/dropdown-arrow.svg"></button>
                                                <ul class="dropdown-menu content-menu faq-filter-add pt-1 pb-1" ngbDropdownMenu>
                                                    <li (click)="updateFaq(selectedFaq,'stateUpdate','draft')">{{'faqSource_needs_rework' | translate}}</li>
                                                    <li class="delete-text cursor-pointer" (click)="deleteInfividualQuestion(selectedFaq)">{{'faqSource_delete' | translate}}</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="header-info-que" *ngIf="selectedFaq && selectedFaq._meta.state === 'draft'">
                            <div class="row m-0 col-12 p-0">
                                <div class="col-5 p-0 lef-info">
                                    <div class="approved_title">{{'faqSource_edited_on_caps' | translate}} </div>
                                    <div class="approved_date" ngbTooltip="{{selectedFaq.lMod  | date:'d MMMM yyyy | hh:mm a'}}" placement="top-left">{{selectedFaq.lMod   | date:'d MMMM yyyy | hh:mm a'}}</div>
                                </div>
                                <div class="col-7 p-0 actions-sec">
                                    <div class="kr-sg-dropdowns info_header_dropdown" ngbDropdown [placement]="'bottom-center'">
                                        <div class="dropdown dropdown-open">
                                            <button class="dropdown-toggle dropdown-input" ngbDropdownToggle><img src="assets/icons/info_header.svg" ngbTooltip="{{'addFaq_info' | translate}}"  [container]="'body'"></button>
                                            <ul class="dropdown-menu content-menu info_header_dropdown_content w-274px" ngbDropdownMenu>
                                                <div class="row m-0 col-12 p-0">
                                                    <div class="col-6 inner-data-column">
                                                        <div class="heading">{{'faqSource_source_caps' | translate}} </div>
                                                        <div class="title" ngbTooltip='{{(selectedFaq.sourceName  || contentTypes[selectedFaq.source]) || "Manual" | titlecase}}' placement="top-left">{{(selectedFaq.sourceName  || contentTypes[selectedFaq.source]) || 'Manual' | titlecase}}</div>
                                                    </div>
                                                    <div class="col-6 inner-data-column">
                                                        <div class="heading">{{'faqSource_edited_by_caps' | translate}} </div>
                                                        <div class="title" ngbTooltip="{{selectedFaq.userDetails?selectedFaq.userDetails.fullName:'---'}}" placement="top-left">{{selectedFaq.userDetails?selectedFaq.userDetails.fullName:'---'}}</div>
                                                    </div>
                                                    <!-- <div class="col-2 inner-data-column d-none">
                                                        <div class="heading">Type</div>
                                                        <div class="title" ngbTooltip='{{(contentTypes[selectedFaq._meta.contentSource] || "Manual") | titlecase}}' placement="top-left">{{(contentTypes[selectedFaq._meta.contentSource] || "Manual") | titlecase}}</div>
                                                    </div>
                                                    <div class="col-4 inner-data-column d-none">
                                                        <div class="heading">Last Modified</div>
                                                        <div class="title" ngbTooltip="{{selectedFaq.lMod | dateFormatPipe:'MM-DD-YYYY hh:mm:ss A'}}" placement="top-left">{{selectedFaq.lMod | dateFormatPipe:'MM-DD-YYYY hh:mm:ss A'}}</div>
                                                    </div> -->
                                                </div>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="kr-sg-dropdowns comments_header_dropdown"
                                    #commentBox='ngbDropdown' ngbDropdown [container]="'body'" [placement]="'bottom-right'">
                                        <div class="dropdown dropdown-open">
                                            <button class="dropdown-toggle dropdown-input" ngbDropdownToggle><img class="cursor" src="assets/icons/comment.svg" ngbTooltip="{{'addFaq_comment' | translate}}"  [container]="'body'"></button>
                                            <ul class="dropdown-menu content-menu comments_header_dropdown_content" ngbDropdownMenu>
                                                <div class="c-section-data">
                                                    <perfect-scrollbar>
                                                        <div class="body_data">
                                                            <!-- <div class="intial-state d-none">This looks good! <a>Simone</a></div> -->
                                                            <div class="c-data"  *ngFor="let comment of faqComments">
                                                                <div class="user-data">
                                                                    <div class="pro-pic">{{comment.initial}}</div>
                                                                    <div class="user-name-data">
                                                                        <div class="u-name" >{{comment.userDetails?comment.userDetails.fullName:'---'}}</div>
                                                                        <div class="u-time">{{comment.createdOn}}</div>
                                                                        <div class="info-text-user">{{comment.text}}</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="kr-sg-input-text-area">
                                                                <textarea id="changePlaceholder" placeholder="{{'addFaq_add_a_comment' | translate}}" [(ngModel)]="newCommentObj.comment" class="input-text"></textarea>
                                                            </div>
                                                        </div>
                                                    </perfect-scrollbar>
                                                    <div class="footer-data">
                                                        <div class="left_sec d-none"><img src="assets/icons/emoji-black.svg"></div>
                                                        <div class="btn_sec">
                                                            <button class="kr-sg-button-secondary btn_lg" (click)="commentBox.close()">{{'faqSource_cancel' | translate}} </button>
                                                            <button class="kr-sg-button-primary btn_lg" [disabled]='!this.newCommentObj.comment'  (click)="saveComment()">{{'faqSource_post' | translate}}</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center justify-content-end">
                                        <button class="kr-sg-button-primary btn_lg" *ngIf="!(selectedFaq && selectedFaq._meta && selectedFaq._meta.isFollowupQuestion)" (click)="updateFaq(selectedFaq,'stateUpdate','in_review')">Send for Review</button>
                                        <div class="kr-sg-dropdowns add" ngbDropdown [container]="'body'" [placement]="'bottom-right'">
                                            <div class="dropdown dropdown-open">
                                                <button class="dropdown-toggle dropdown-input" ngbDropdownToggle data-toggle="dropdown"><img src="assets/icons/dropdown-arrow.svg"></button>
                                                <ul class="dropdown-menu content-menu faq-filter-add pt-1 pb-1" ngbDropdownMenu>
                                                    <li class="delete-text cursor-pointer" (click)="deleteInfividualQuestion(selectedFaq)">{{'faqSource_delete' | translate}}</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <div class="header-info-que" *ngIf="selectedFaq && selectedFaq._meta.state === 'approved'">
                        <div class="row m-0 col-12 p-0">
                            <div class="col-5 p-0 lef-info">
                                <div class="approved_title">{{'faqSource_approved_on_caps' | translate}} </div>
                                <div class="approved_date" ngbTooltip="{{selectedFaq.lMod | date:'d MMMM yyyy | hh:mm a'}}" placement="top-left">{{selectedFaq.lMod | date:'d MMMM yyyy | hh:mm a'}}</div>
                            </div>
                            <div class="col-7 p-0 actions-sec">
                                <div class="kr-sg-dropdowns info_header_dropdown" ngbDropdown [placement]="'bottom-right'">
                                    <div class="dropdown dropdown-open">
                                        <button class="dropdown-toggle dropdown-input" ngbDropdownToggle><img src="assets/icons/info_header.svg" ngbTooltip='Info'  [container]="'body'"></button>
                                        <ul class="dropdown-menu content-menu info_header_dropdown_content ml-58" ngbDropdownMenu>
                                            <div class="row m-0 col-12 p-0">
                                                <div class="col-3 inner-data-column">
                                                    <div class="heading">{{'faqSource_source_caps' | translate}} </div>
                                                    <div class="title" ngbTooltip='{{(selectedFaq.sourceName || "Manual") | titlecase}}' placement="top-left">{{(selectedFaq.sourceName || 'Manual') | titlecase}}</div>
                                                </div>
                                                <div class="col-5 inner-data-column pl-3">
                                                    <div class="heading">{{'faqSource_edited_by_caps' | translate}}</div>
                                                    <div class="title" ngbTooltip="{{selectedFaq.userDetails?selectedFaq.userDetails.fullName:'---'}}" placement="top-left">{{selectedFaq.userDetails?selectedFaq.userDetails.fullName:'---'}}</div>
                                                </div>
                                                <div class="col-4 inner-data-column p-0">
                                                    <div class="heading">{{'faqSource_reviewed_by' | translate}}</div>
                                                    <div class="title" ngbTooltip="{{(selectedFaq._meta.reviewerDetails?selectedFaq._meta.reviewerDetails.fullName:'---')}}" placement="top-left">{{(selectedFaq._meta.reviewerDetails?selectedFaq._meta.reviewerDetails.fullName:'---')}}</div>
                                                </div>
                                                <!-- <div class="col-4 inner-data-column d-none">
                                                    <div class="heading">Type</div>
                                                    <div class="title" ngbTooltip='{{(contentTypes[selectedFaq._meta.contentSource] || "Manual") | titlecase}}' placement="top-left">{{(contentTypes[selectedFaq._meta.contentSource] || 'Manual') | titlecase}}</div>
                                                </div> -->
                                            </div>
                                        </ul>
                                    </div>
                                </div>
                                <div class="kr-sg-dropdowns comments_header_dropdown"  #commentBox='ngbDropdown' ngbDropdown   [container]="'body'" [placement]="'bottom-right'">
                                    <div class="dropdown dropdown-open">
                                        <button class="dropdown-toggle dropdown-input" ngbDropdownToggle><img class="cursor" src="assets/icons/comment.svg" ngbTooltip="{{'addFaq_comment' | translate}}"  [container]="'body'"></button>
                                        <ul class="dropdown-menu content-menu comments_header_dropdown_content" ngbDropdownMenu>
                                            <div class="c-section-data">
                                                <perfect-scrollbar>
                                                    <div class="body_data">
                                                        <!-- <div class="intial-state d-none">This looks good! <a>Simone</a></div> -->
                                                        <div class="c-data"  *ngFor="let comment of faqComments">
                                                            <div class="user-data">
                                                                <div class="pro-pic">{{comment.initial}}</div>
                                                                <div class="user-name-data">
                                                                    <div class="u-name" >{{comment.userDetails?comment.userDetails.fullName:'---'}}</div>
                                                                    <div class="u-time">{{comment.createdOn}}</div>
                                                                    <div class="info-text-user">{{comment.text}}</div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="kr-sg-input-text-area">
                                                            <textarea id="changePlaceholder" placeholder="{{'addFaq_add_a_comment' | translate}}" [(ngModel)]="newCommentObj.comment" class="input-text"></textarea>
                                                        </div>
                                                    </div>
                                                </perfect-scrollbar>
                                                <div class="footer-data">
                                                    <div class="left_sec d-none"><img src="assets/icons/emoji-black.svg"></div>
                                                    <div class="btn_sec">
                                                        <button class="kr-sg-button-secondary btn_lg" (click)="commentBox.close()">{{'faqSource_cancel' | translate}}</button>
                                                        <button class="kr-sg-button-primary btn_lg" [disabled]='!this.newCommentObj.comment'  (click)="saveComment()">{{'faqSource_post' | translate}}</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </ul>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center justify-content-end">
                                    <!-- <button class="kr-sg-button-primary btn_lg" (click)="updateFaq(selectedFaq,'stateUpdate','in_review')">Send for Review</button> -->
                                    <div class="kr-sg-dropdowns add elipse-action-dropdown" ngbDropdown [container]="'body'" [placement]="'bottom-right'">
                                        <div class="dropdown dropdown-open">
                                            <button class= "dropdown-toggle dropdown-input p-0 border-0" ngbDropdownToggle ><img src="assets/icons/elipse.svg">  </button>
                                            <ul class="dropdown-menu content-menu faq-filter-add pt-1 pb-1 ml--10" ngbDropdownMenu>
                                                <li (click)="updateFaq(selectedFaq,'stateUpdate','draft')">{{'faqSource_move_to_drafts' | translate}}</li>
                                                <li class ="list delete-text" (click)="deleteInfividualQuestion(selectedFaq)">{{'faqSource_delete' | translate}}</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <perfect-scrollbar class="train-questions-body-scroll" #editQaScrollContainer>
                        <div class="body-content" id="questionList">
                            <!-- <app-add-faq (editFaq)="editFaq($event)" [faqData]="selectedFaq" (cancelfaqEvent)="faqCancle()" *ngIf="editfaq && selectedFaq"></app-add-faq> -->
                            <div class="body-top-content" *ngIf="!editfaq">
                                <div class="question-content">
                                    <div class="title-que">
                                        <span>{{selectedFaq._source.faq_question}}</span>
                                        <div class="edit-faq" (click)="editThisQa()" ngbTooltip='{{"sa_edit" | translate}}' placement="bottom">
                                            <img src="assets/icons/edit-blue.svg">Edit
                                        </div>
                                    </div>
                                    <div  class="pad-div d-none">
                                        <div class="bot-response-view-mode"   >
                                            <ng-container *ngIf="selectedFaq && selectedFaq._source && selectedFaq._source.faq_answer && selectedFaq._source.faq_answer.length">
                                                <!-- <ng-container *ngFor="let answer of selectedFaq._source.faq_answer ;let i = index;"> -->

                                                        <div  *ngFor="let answer of selectedFaq._source.faq_answer ;let i = index; ">
                                                            <!-- <div cdkDrag>
                                                        </div> -->

                                                    <div class="response-title-bg row">
                                                        <div class="bot-response-title col-6">{{'faqSource_response' | translate}}<span *ngIf="(selectedFaq._source.faq_answer.length > 1) || (selectedFaq._source.faq_cond_answers && selectedFaq._source.faq_cond_answers.length)">{{ ' ' + (i + 1)}}</span></div>
                                                        <div class="response-likes-views-sec d-flex col-6">
                                                            <div class="count-sec" >
                                                                <img src="assets/icons/faq/views.svg" (click)="clicksViews()" placement="top" container='body' ngbTooltip="{{'addFaq_views' | translate}}">{{numberOf.appearances}}
                                                                <!-- {{(selectedFaq?.stats?.appearances || []).length ?selectedFaq?.stats?.appearances[0][0]: 0}} -->
                                                            </div>
                                                            <div class="count-sec" >
                                                                <img src="assets/icons/faq/hand.svg" (click)="clicksViews()" placement="top" container='body' ngbTooltip="{{'addFaq_clicks' | translate}}">{{numberOf.clicks}}
                                                                <!-- {{selectedFaq?.stats?.clicks ||0}} -->
                                                            </div>
                                                            <!-- <div class="count-sec">
                                                                <img src="assets/icons/faq/likes.svg">{{selectedFaq.stats.thumbsup ||0}}
                                                            </div>
                                                            <div class="count-sec">
                                                                <img src="assets/icons/faq/dislikes.svg">{{selectedFaq.stats.thumbsdown ||0}}
                                                            </div>                                                         -->
                                                        </div>
                                                    </div>


                                                    <div class="img-view-mode" *ngIf="answer && answer.imgurl">
                                                        <img src="{{answer.imgurl}}">
                                                    </div>
                                                    <!-- <div> -->
                                                        <div class="desc-info" [innerHtml]='convertMDtoHTML.helpers.convertMDtoHTML(answer.text)'></div>
                                                    <!-- </div> -->
                                                    <!-- <div class="desc-info desc-info-javascript-message" *ngIf="answer.type==='javascript'">Javascript message</div> -->

                                                        </div>
                                            </ng-container>
                                        </div>
                                        <div  class="conditionalBlock bot-response-view-mode" (cdkDropListDropped)="drop($event)" >
                                            <ng-container *ngIf="selectedFaq && selectedFaq._source.faq_cond_answers && selectedFaq._source.faq_cond_answers.length">
                                            <div  *ngFor="let consitionalAnswer of selectedFaq._source.faq_cond_answers; let i = index;" >
                                                <div class="response-title-bg row">
                                                    <div  class="bot-response-title col-6">{{'faqSource_response' | translate}}<span>{{ ' ' + (i + 1 + (selectedFaq._source.faq_answer?selectedFaq._source.faq_answer.length:0))}}</span></div>
                                                    <div class="response-likes-views-sec d-flex col-6">
                                                        <div class="count-sec" >
                                                            <img src="assets/icons/faq/views.svg" placement="top" container='body' ngbTooltip="{{'addFaq_views' | translate}}">{{selectedFaq?.stats?.appearances?selectedFaq?.stats?.appearances[0][0]: 0}}
                                                        </div>
                                                        <div class="count-sec">
                                                            <img src="assets/icons/faq/hand.svg"  placement="top" container='body' ngbTooltip="{{'addFaq_clicks' | translate}}">{{selectedFaq?.stats?.clicks ||0}}
                                                        </div>
                                                        <!-- <div class="count-sec">
                                                            <img src="assets/icons/faq/likes.svg">{{selectedFaq.stats.thumbsup ||0}}
                                                        </div>
                                                        <div class="count-sec">
                                                            <img src="assets/icons/faq/dislikes.svg">{{selectedFaq.stats.thumbsdown ||0}}
                                                        </div>                                                            -->
                                                    </div>

                                                    <div class="d-flex col-12 conditions-response-block">
                                                        <div class="title col-2 px-0">{{'faqSource_conditions' | translate}} :</div>
                                                        <div class="right-content col-10 px-0 condition-content">
                                                            <!-- if-lenthfour -->
                                                            <div class="row added-conditions" *ngFor="let rule of consitionalAnswer.conditions | slice:0:2; let ruleIndex = index" >
                                                                <ng-container *ngIf="showConditions(consitionalAnswer.conditions,ruleIndex)">
                                                                   <div class="col-2  d-inline px-0 vertical-align-top">
                                                                    <div class="rule-title pr-10" *ngIf="ruleIndex == 0">{{'faqSource_when_caps' | translate}}</div>
                                                                    <div class="rule-title pr-20" *ngIf="ruleIndex > 0">{{'faqSource_and_caps' | translate}}</div>
                                                                   </div>
                                                                <div class="col-10 d-inline-block px-0"[ngStyle]="{'margin-bottom':(showSeeAll(consitionalAnswer.conditions) && ruleIndex==0)?'10px':'0px'}" >
                                                                    <div class="rule-dropdown-data">
                                                                        <span class="rule-dropdown-key">{{ "businessRules." + rule.contextType | translate}} :</span>
                                                                        <span class="rule-dropdown-value" title='{{ "businessRules." + rule.contextCategory | translate }}'>{{ "businessRules." + rule.contextCategory | translate }}</span>
                                                                    </div>
                                                                    <div class="rule-contains">{{ rule.operator | titlecase}}</div>
                                                                    <ng-container  *ngFor="let value of rule.value | slice:0:(ruleIndex==0?(rule.operator !=='between'?4:2):2); let valueIndex = index">
                                                                        <div class="rule-value" *ngIf="rule.dataType=== 'date' && rule.operator !=='between'" title="{{value | dateFormatPipe: 'DD MMM YYYY'}}">{{value | dateFormatPipe: 'DD MMM YYYY'}}</div>
                                                                        <div class="rule-value" *ngIf="rule.dataType=== 'date'  && rule.operator =='between'" title="{{value | dateFormatPipe: 'DD MMM YYYY'}}">{{value[0] | dateFormatPipe: 'DD MMM YYYY'}} - {{value[1] | dateFormatPipe: 'DD MMM YYYY'}}</div>
                                                                        <div class="rule-value" *ngIf="rule.dataType!== 'date'" title="{{value}}">{{value}}</div>
                                                                        <div class="or-rule" *ngIf="(valueIndex < 3 && valueIndex!== (rule.value.length>3?3:(rule.value.length-1)) && ruleIndex==0 && rule.operator !=='between')||(valueIndex < 1 && ruleIndex==1 && valueIndex!== 1) || (valueIndex < 1 && valueIndex!== (rule.value.length>2?2:(rule.value.length-1)) && ruleIndex==0 && rule.operator =='between') ">{{ "or_caps" | translate}}</div>
                                                                    </ng-container>
                                                                    <!-- <div class="d-inline position-absolute" *ngIf="(rule.value.length>4 && ruleIndex==0)|| (rule.value.length>1  && ruleIndex==1) || (rule.value.length>2 && ruleIndex==0 && rule.operator =='between')">...</div> -->
                                                                </div>
                                                                </ng-container>
                                                            </div>
                                                            <div class="d-block"><a (click)="editThisQa()" class="see-all-anchor" *ngIf="showSeeAll(consitionalAnswer.conditions)">See All</a></div>

                                                        </div>
                                                    </div>
                                                </div>


                                                <!-- <div class="condition-tags">Conditions : <span *ngIf="consitionalAnswer && consitionalAnswer.answers && consitionalAnswer.conditions.length"><span *ngFor="let item of consitionalAnswer.conditions;  let index = index"><span *ngIf="index">,</span>{{item.value}}</span></span></div> -->
                                                <div *ngIf="consitionalAnswer && consitionalAnswer.answers && consitionalAnswer.answers.length">
                                                    <div *ngFor="let ans of consitionalAnswer.answers">
                                                        <div class="img-view-mode" *ngIf="ans.imgurl">
                                                            <img src="{{ans.imgurl}}">
                                                        </div>
                                                        <ng-container>
                                                            <div class="desc-info"  [innerHtml]='convertMDtoHTML.helpers.convertMDtoHTML(ans.text)'></div>
                                                             <!-- <div class="desc-info desc-info-javascript-message" *ngIf="ans.type==='javascript'">Javascript message</div> -->
                                                        </ng-container>
                                                    </div>
                                                </div>
                                            </div>
                                                </ng-container>
                                        </div>
                                        <!-- <div class="added-answer" [innerHtml]='convertMDtoHTML.helpers.convertMDtoHTML(selectedFaq.answer)'></div> -->
                                    </div>

                                    <ng-container >
                                        <div cdkDropListGroup>
                                        <!-- New UI for ond Resp  Start-->
                                        <div cdkDropList [cdkDropListData]="selectedFaq._source.faq_cond_answers"  (cdkDropListDropped)="drop($event)"class="conditional-responses-new"  >
                                            <ng-container *ngIf="selectedFaq && selectedFaq._source.faq_cond_answers && selectedFaq._source.faq_cond_answers.length">
                                            <div class="conditional-res-main-heading">
                                                <span class="title">Conditional Responses</span>
                                                <img src="assets/icons/faq/help.svg">
                                                <span class="count-conditions">{{selectedFaq._source.faq_cond_answers.length}}</span>
                                            </div>
                                            <div class="response-block if-morethan-one" *ngFor="let consitionalAnswer of selectedFaq._source.faq_cond_answers; let i = index;" cdkDrag>
                                                <div class="response-count">{{ ' ' + (i + 1)}}</div>
                                                <div class="response-data">
                                                    <div class="header-data">
                                                        <div class="title col-8"><img src="assets/icons/faq/move.svg">Conditional Responses</div>
                                                        <div class="count-clicks col-4">
                                                            <div class="views">
                                                                <img src="assets/icons/faq/views.svg"placement="top" container='body' ngbTooltip="{{'addFaq_views' | translate}}">{{selectedFaq?.stats?.appearances?selectedFaq?.stats?.appearances[0][0]: 0}}
                                                            </div>
                                                            <div class="clicks">
                                                                <img src="assets/icons/faq/likes.svg" placement="top" container='body' ngbTooltip="{{'addFaq_clicks' | translate}}">{{selectedFaq?.stats?.clicks ||0}}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="field_data" *cdkDragPreview>
                                                        <div class="title text-truncate"></div>
                                                    </div>
                                                    <div class="data-inner-content">
                                                        <div class="response-text">{{consitionalAnswer.answers[0]?.text}}</div>

                                                        <div class="conditions-list">
                                                            <div class="titles-sec">
                                                                <div class="title">Condition</div>
                                                                <div class="show-more" data-toggle="collapse" (click)="showMoreConditions(index)" data-target="#demo">{{ show ? 'Show More': 'Show less' }}<img src="assets/icons/faq/carrotup.svg"></div>
                                                            </div>
                                                            <div id="demo" class="collapse show">
                                                                <div class="d-flex col-12 conditions-response-block">
                                                                    <!-- <div class="title col-2 px-0">{{'faqSource_conditions' | translate}} :</div> -->
                                                                    <div class="right-content col-10 px-0 condition-content">
                                                                        <!-- if-lenthfour -->
                                                                        <div class="row added-conditions" *ngFor="let rule of consitionalAnswer.conditions | slice:0:2; let ruleIndex = index" >
                                                                            <ng-container *ngIf="showConditions(consitionalAnswer.conditions,ruleIndex)">
                                                                               <div class="col-2  d-inline px-0 vertical-align-top">
                                                                                <div class="rule-title pr-10" *ngIf="ruleIndex == 0">{{'faqSource_when_caps' | translate}}</div>
                                                                                <div class="rule-title pr-20" *ngIf="ruleIndex > 0">{{'faqSource_and_caps' | translate}}</div>
                                                                               </div>
                                                                            <div class="col-10 d-inline-block px-0"[ngStyle]="{'margin-bottom':(showSeeAll(consitionalAnswer.conditions) && ruleIndex==0)?'10px':'0px'}" >
                                                                                <div class="rule-dropdown-data">
                                                                                    <span class="rule-dropdown-key">{{ "businessRules." + rule.contextType | translate}} :</span>
                                                                                    <span class="rule-dropdown-value" title='{{ "businessRules." + rule.contextCategory | translate }}'>{{rule.contextType !=='userContext' ? ("businessRules." + rule.contextCategory | translate): rule.contextCategory }}</span>
                                                                                </div>
                                                                                <div class="rule-contains">{{ rule.operator | titlecase}}</div>
                                                                                <ng-container  *ngFor="let value of rule.value | slice:0:(ruleIndex==0?(rule.operator !=='between'?4:2):2); let valueIndex = index">
                                                                                    <div class="rule-value" *ngIf="rule.dataType=== 'date' && rule.operator !=='between'" title="{{value | dateFormatPipe: 'DD MMM YYYY'}}">{{value | dateFormatPipe: 'DD MMM YYYY'}}</div>
                                                                                    <div class="rule-value" *ngIf="rule.dataType=== 'date'  && rule.operator =='between'" title="{{value | dateFormatPipe: 'DD MMM YYYY'}}">{{value[0] | dateFormatPipe: 'DD MMM YYYY'}} - {{value[1] | dateFormatPipe: 'DD MMM YYYY'}}</div>
                                                                                    <div class="rule-value" *ngIf="rule.dataType!== 'date'" title="{{value}}">{{value}}</div>
                                                                                    <div class="or-rule" *ngIf="(valueIndex < 3 && valueIndex!== (rule.value.length>3?3:(rule.value.length-1)) && ruleIndex==0 && rule.operator !=='between')||(valueIndex < 1 && ruleIndex==1 && valueIndex!== 1) || (valueIndex < 1 && valueIndex!== (rule.value.length>2?2:(rule.value.length-1)) && ruleIndex==0 && rule.operator =='between') ">{{ "or_caps" | translate}}</div>
                                                                                </ng-container>
                                                                                <!-- <div class="d-inline position-absolute" *ngIf="(rule.value.length>4 && ruleIndex==0)|| (rule.value.length>1  && ruleIndex==1) || (rule.value.length>2 && ruleIndex==0 && rule.operator =='between')">...</div> -->
                                                                            </div>
                                                                            </ng-container>
                                                                        </div>
                                                                        <div class="d-block"><a (click)="editThisQa()" class="see-all-anchor" *ngIf="showSeeAll(consitionalAnswer.conditions)">See All</a></div>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-container>
                                            <!-- <div class="response-block if-morethan-one">
                                                <div class="response-count">2</div>
                                                <div class="response-data">
                                                    <div class="header-data">
                                                        <div class="title col-8"><img src="assets/icons/faq/move.svg">Conditional Responses</div>
                                                        <div class="count-clicks col-4">
                                                            <div class="views">
                                                                <img src="assets/icons/faq/views.svg">872
                                                            </div>
                                                            <div class="clicks">
                                                                <img src="assets/icons/faq/likes.svg">764
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="data-inner-content">
                                                        <div class="response-text">To access Citibank Online as a first time user, you will need to create a User ID and Internet Password.</div>
                                                        <div class="conditions-list">
                                                            <div class="titles-sec">
                                                                <div class="title">Conditions</div>
                                                                <div class="show-more" data-toggle="collapse" data-target="#demo1">Show More <img src="assets/icons/faq/carrotup.svg"></div>
                                                            </div>
                                                            <div id="demo1" class="collapse show">
                                                                <div class="condition-container">
                                                                    <div class="condition-sec-data col-7 pl-0">
                                                                        <div class="title">WHEN</div>
                                                                        <div class="type-condition">
                                                                            <span class="left-name">SearchContext :</span>
                                                                            <span class="right-name">RecentSearches</span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="condition-sec-data col-5 p-0">
                                                                        <div class="title">Contains</div>
                                                                        <div class="name-condition ml-2">Credit</div>
                                                                        <div class="condition-type">OR</div>
                                                                        <div class="name-condition">Loan</div>
                                                                    </div>
                                                                </div>
                                                                <div class="condition-container">
                                                                    <div class="condition-sec-data col-7 pl-0">
                                                                        <div class="title">AND</div>
                                                                        <div class="type-condition">
                                                                            <span class="left-name">UserContext :</span>
                                                                            <span class="right-name">CustomerType</span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="condition-sec-data col-5 p-0">
                                                                        <div class="title">Contains</div>
                                                                        <div class="name-condition ml-2">Gold</div>
                                                                        <div class="condition-type">OR</div>
                                                                        <div class="name-condition">Premium</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div> -->
                                        </div>
                                         <!-- New UI for Cond Resp  End-->
                                          <!-- New UI for DefResp  Start-->
                                        <div   class="default-responses-block"  >
                                        <ng-container *ngIf="selectedFaq && selectedFaq._source && selectedFaq._source.faq_answer && selectedFaq._source.faq_answer.length">
                                            <div class="header-data">
                                                <span class="title">Default Responses</span>
                                                <img src="assets/icons/faq/help.svg">
                                                <span class="count-conditions">{{selectedFaq._source.faq_answer.length}}</span>
                                            </div>
                                            <ng-container >
                                                <div class="default-res-data row" *ngFor="let answer of selectedFaq._source.faq_answer ;let i = index;" >
                                                    <div  class="default-desc col-8"> {{answer.text}}</div>
                                                    <div class="count-clicks col-4">
                                                        <div class="views">
                                                            <img src="assets/icons/faq/views.svg"(click)="clicksViews()" placement="top" container='body' ngbTooltip="{{'addFaq_views' | translate}}">{{numberOf.appearances}}
                                                        </div>
                                                        <div class="clicks">
                                                            <img src="assets/icons/faq/likes.svg"(click)="clicksViews()" placement="top" container='body' ngbTooltip="{{'addFaq_clicks' | translate}}">{{numberOf.clicks}}
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- <div class="default-res-data row">
                                                    <div class="default-desc col-8">To access Citibank Online as a first time user, you will need to create a User ID and Internet Password.</div>
                                                    <div class="count-clicks col-4">
                                                        <div class="views">
                                                            <img src="assets/icons/faq/views.svg">872
                                                        </div>
                                                        <div class="clicks">
                                                            <img src="assets/icons/faq/likes.svg">764
                                                        </div>
                                                    </div>
                                                </div> -->
                                            </ng-container>
                                        </ng-container>
                                        </div>
                                        <!-- New UI for DefResp  Start-->
                                    </div>
                                    </ng-container>
                                </div>
                                <div class="appearences-info row" *ngIf="selectedFaq && selectedFaq.feedback">
                                    <div class="col-4 p-0">
                                        <span class="source">{{'faqSource_appearances' | translate}}:</span>
                                        <span class="count">{{selectedFaq?.feedback?.expand}}</span>
                                    </div>
                                    <div class="col-3 p-0">
                                        <span class="source">{{'faqSource_clicks' | translate}}:</span>
                                        <span class="count">{{selectedFaq?.feedback?.click}}</span>
                                    </div>
                                    <!-- <div class="col-2 p-0">
                                        <span class="source cursor-pointer"><img src="assets/icons/like.svg"></span>
                                        <span class="count">{{selectedFaq.feedback.thumbsup}}</span>
                                    </div>
                                    <div class="col-3 p-0">
                                        <span class="sourc cursor-pointer"><img src="assets/icons/dislike.svg"></span>
                                        <span class="count">{{selectedFaq.feedback.thumbsdown}}</span>
                                    </div> -->
                                </div>
                            </div>
                            <div class="add-alternative-questions row"  *ngIf="selectedFaq._source.faq_alt_questions?.length">
                                <div class="header-data">
                                    <span class="title">{{'faqSource_alternate_questions' | translate}}</span>
                                    <img src="assets/icons/faq/help.svg">
                                    <span class="count-conditions">{{selectedFaq._source.faq_alt_questions?.length>0?''+selectedFaq._source.faq_alt_questions?.length+'':''}}</span>
                                </div>
                                <ng-container *ngFor="let alternateQuestion of selectedFaq._source?.faq_alt_questions">
                                    <div class="col-12 question-name">{{alternateQuestion}}</div>
                                </ng-container>
                            </div>
                            <div *ngIf="selectedFaq.isAlt" class="alternate-question-bg">
                                <app-add-alternate-question [faqServ]="faqServiceAlt"></app-add-alternate-question>
                            </div>
                            <!-- <ng-container *ngIf="selectedFaq._source.faq_alt_questions?.length">
                                <div class="added-questions-list py-0" *ngFor="let alternateQuestion of selectedFaq._source?.faq_alt_questions">
                                    <div class="content-body-question row">
                                        <div class="col-12 group-name question-name text-truncate">{{alternateQuestion}}</div>
                                    </div>
                                    <div class="added-tags text-truncate">
                                        <span class="tags-data" *ngFor="let keyword of alternateQuestion?.keywords">#{{keyword.keyword}}&nbsp;</span>
                                    </div>

                                        <img src="assets/icons/delete-table.svg" (click)="delAltQues(alternateQuestion)" class="delete-icon cursor-pointer" [ngClass]="{'pos-trash': alternateQuestion?.keywords?.length == 0}">
                                </div>
                           </ng-container> -->
                            <!-- <div class="add-alternative-questions row followup_questions">
                                <div class="col-10 pl-0 pr-2">
                                    <div class="question-name text-truncate">Followup Questions
                                        {{(selectedFaq._meta.followupQuestions?.length>0?'('+selectedFaq._meta.followupQuestions.length+')':'')}}
                                    </div>
                                    <div class="que-desc text-truncate">Add followup the question, key terms.</div>
                                </div>
                                <div class="col-2 p-0 text-right">
                                    <button class="kr-sg-button-primary btn_lg" (click)="addFollowUp()">Add</button>
                                </div>
                            </div> -->

                            <!-- <ng-container *ngIf="selectedFaq._meta.followupQuestions?.length">
                                <div class="added-questions-list" *ngFor="let followQues of selectedFaq._meta.followupQuestions">
                                    <div class="question-name text-truncate">{{followQues._source.question}}</div>
                                    <div class="added-tags text-truncate">
                                        <span class="tags-data" *ngFor="let keyword of followQues._source?.keywords">#{{keyword}}&nbsp;</span>
                                    </div>
                                    <img src="assets/icons/delete-table.svg" (click)="delFollowQues(followQues)" class="delete-icon cursor-pointer" [ngClass]="{'pos-trash': followQues?.keywords?.length == 0}">
                                </div>
                            </ng-container> -->
                        </div>
                    </perfect-scrollbar>
                   </ng-container>
                </div>
            </div>
        </div>
    </div>
</div>


<kr-modal modalType="center" modalClass="addSourceModalComponent modal_popups_" #statusModalPop>
    <div class="modal-header">
        <div class="title">Extracts</div>
        <div class="close_icon"  (click)='closeStatusModal(extractedFaqs)'><img  src="assets/icons/modal-close.svg"></div>
      </div>

      <div class="modal-table-actions">
        <div class="table-action-header d-flex justify-content-between align-items-center">
            <div>
                <div class="seach_add_feild">
                    <!-- <div class="kr-sg-input-search"  *ngIf="showSearch" [ngClass]="{'active':showSearch}">
                        <input type="text" name='searchSources' placeholder="Search" id="searchFaqSources" class="input-search pl-2" [(ngModel)]="searchSources" autocomplete="off">
                    </div>
                    <div class="seach-block" (click)="toggleSearch()">
                        <img *ngIf="!showSearch" src="assets/icons/search.svg">
                        <img *ngIf="showSearch" src="assets/images/close.svg">Search
                    </div> -->
                    <div class="kr-sg-input-search m-0"  *ngIf="showSearch">
                        <input type="text" placeholder="{{'sa_search' | translate}}" id="inputSearch1" class="input-search"  [ngClass]="{'pl-33':!searchSources,'pl-2':searchSources}" autocomplete="off" [(ngModel)]="searchSources" (keyup)="getSourceList(searchSources,'search')" maxlength="50" (mouseover)="searchImgSrc = (searchFocusIn ? 'assets/icons/search_gray.svg' :'assets/icons/search_gray_dark.svg')"
                        (mouseout)="searchFocusIn=false;searchImgSrc = 'assets/icons/search_gray.svg'" (focus)="searchFocusIn=true;searchImgSrc = 'assets/icons/search_gray.svg'">
                    <img [src]="searchImgSrc" class="search-icon" *ngIf="!searchSources">
                    <img class="close-icon" src="assets/icons/close_icon.svg" [ngClass]="{'pr-22':searchSources}" (mouseover)="activeClose=true" (mouseout)="activeClose=false" (click)="focusoutSearch(true)"  placement="top-center" container='body' ngbTooltip="{{'sa_cancel' | translate}}" tooltipClass="ngb_tooltip_custom_class sampleJson">
                    </div>
                      <div class="searchBlock" (click)="showSearch=!showSearch;cdRef.detectChanges();;focusinSearch('inputSearch1')">
                        <span *ngIf="!showSearch" class="mr-3" id="btn_toggle_search_structured_data" ><img src="assets/icons/search.svg" [ngClass]="{'d-none': showSearch}">{{'sa_search' | translate}}</span>
                    </div>
                </div>

                <div class="kr-sg-dropdowns d-none">
                    <div class="dropdown dropdown-open">
                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown"><img src="assets/icons/sidemenu/plus-table.svg">Add FAQs</button>
                        <ul class="dropdown-menu content-menu">
                            <li (click)="addFaqSource('faqWeb')">Web URL</li>
                            <li (click)="addFaqSource('faqDoc')">Upload File</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div>
                <div *ngIf="currentView === 'list'" class="grid-list-view-table" (click)="currentView='grid'"><img src="assets/icons/grid-view.svg" ngbTooltip="{{'addFaq_grid' | translate}}"></div>
                <div *ngIf="currentView === 'grid'" class="grid-list-view-table" (click)="currentView='list'"><img src="assets/icons/list-view.svg" ngbTooltip="{{'addFaq_list' | translate}}"></div>
            </div>
        </div>
    </div>
    <ng-container *ngIf="!(extractedResources && extractedResources.length)">
        <app-empty-screen class="empty-lg" [width]="100" [height]="100" [title]="emptyScreen.TITLE_NO_SOURCES" [desc]="emptyScreen.DESC_NO_SOURCES" [imgName]="emptyScreen.IMG_NAME">
        </app-empty-screen>
    </ng-container>
    <!-- <div *ngIf="!( extractedResources &&  extractedResources.length)"  class="empty-source-modal">
        <div class="empty-sources">
            <img src="assets/images/icons/empty_ill.svg">
            <div class="heading">{{'manageExtracts.no_faq_sources_are_available' | translate}}</div>
        </div>
    </div> -->
    <div class="modal-body source-modal-popup" *ngIf="extractedResources &&  extractedResources.length">
        <ng-container  *ngIf="currentView === 'list'">
            <div class="table-list-content">
                <div class="kr-sg-data-table with-checkbox">
                <section class="table-content">
                    <header class="table-header">
                        <div class="col_ col-2 d-flex align-items-center" (click)="sortByApi('name')">
                            <span class="d-flex align-items-center flex-column mr-1">
                                <img [ngClass]="getSortIconVisibility('name', 'down')" src="assets/icons/caretDown.svg" class="ml-1 sortImg downArrow">
                                <img [ngClass]="getSortIconVisibility('name', 'up')" src="assets/icons/caretDown.svg" class="ml-1 sortImg upArrow">
                              </span> {{'manageExtracts.source_title' | translate}}
                            </div>
                        <div class="col_ col-2 d-flex align-items-center" (click)="sortByApi('contentSource')">
                            <span class="selected-length-doc-web d-none">({{filterSystem.typefilter}})</span>
                            <span class="d-flex align-items-center flex-column mr-1">
                                <img [ngClass]="getSortIconVisibility('contentSource', 'down')" src="assets/icons/caretDown.svg" class="ml-1 sortImg downArrow">
                                <img [ngClass]="getSortIconVisibility('contentSource', 'up')" src="assets/icons/caretDown.svg" class="ml-1 sortImg upArrow">
                              </span>{{'manageExtracts.type' | translate}}
                              <div class="kr-sg-dropdowns type_sort_dropdown" #sourceFilter="ngbDropdown" ngbDropdown
                              [autoClose]="true" [placement]="'bottom-right'">
                              <div class="dropdown dropdown-open">
                                <button class="dropdown-toggle dropdown-input" ngbDropdownToggle (click)="$event.stopPropagation()">
                               <img class="custom-dropdown-toggle-icon" src="assets/icons/type-select-dropdown.svg">
                                </button>
                                <ul class="dropdown-menu content-menu type_sort_dropdown-content" ngbDropdownMenu>
                                    <li (click)="sourceFilter.close();filterTable('all','contentSource')"><span class="list-name">All</span><img
                                        [ngClass]="{'hide': filterSystem.typefilter !== 'all'}" src="assets/icons/check-blue.svg"></li>
                                    <li *ngFor="let docType of docTypeArr"
                                    (click)="sourceFilter.close();filterTable(docType,'contentSource')">
                                      <span
                                        class="list-name">{{ docType == 'web' ? 'Web' : 'File' }}</span><img
                                        [ngClass]="{'hide': filterSystem.typefilter !== docType}"  src="assets/icons/check-blue.svg">
                                    </li>
                                  </ul>
                              </div>
                              </div>
                            </div>
                        <div class="col_ col-3 d-flex align-items-center" (click)="sortByApi('recentStatus')">
                            <span class="selected-length-doc-web hide">({{this.filterSystem.statusFilter}})</span>
                            <span class="d-flex align-items-center flex-column mr-1">
                                <img [ngClass]="getSortIconVisibility('recentStatus', 'down')" src="assets/icons/caretDown.svg" class="ml-1 sortImg downArrow">
                                <img [ngClass]="getSortIconVisibility('recentStatus', 'up')" src="assets/icons/caretDown.svg" class="ml-1 sortImg upArrow">
                              </span>
                             {{'manageExtracts.status' | translate}}
                              <div class="kr-sg-dropdowns type_sort_dropdown" #statusFilter="ngbDropdown" ngbDropdown
                              [autoClose]="true" [placement]="'bottom-right'">
                              <div class="dropdown dropdown-open">
                                <button class="dropdown-toggle dropdown-input" ngbDropdownToggle (click)="$event.stopPropagation()">
                               <img class="custom-dropdown-toggle-icon" src="assets/icons/type-select-dropdown.svg">
                                </button>
                                <ul class="dropdown-menu content-menu type_sort_dropdown-content" ngbDropdownMenu >
                                    <li (click)="statusFilter.close();filterTable('all','recentStatus')"><span
                                        class="list-name">All</span><img   [ngClass]="{'hide': filterSystem.statusFilter !== 'all'}" src="assets/icons/check-blue.svg"></li>
                                    <li *ngFor="let status of statusArr"
                                      (click)="statusFilter.close();filterTable(status,'recentStatus')"><span
                                        class="list-name">{{status == 'success' ? 'Success' : (status == 'failed' ? 'Failed' : (status == 'queued' ? 'In-Queue' :'In Progress'))}}<img
                                        [ngClass]="{'hide': filterSystem.statusFilter !== status}" src="assets/icons/check-blue.svg"></span>
                                    </li>
                                  </ul>
                              </div>
                              </div>
                        </div>
                        <div class="col_ col-2 d-flex align-items-center" (click)="sortBy('extrated')">{{'faqSource_no_of_faqs_caps' | translate}}<img src="assets/icons/caretDown.svg" class="ml-1 hide"></div>
                        <div class="col_ col-2 d-flex align-items-center" (click)="sortBy('createdOn')">{{'faqSource_triggered_by_caps' | translate}}<img src="assets/icons/caretDown.svg" class="ml-1 hide"></div>
                        <!-- <div class="col" (click)="sortBy('createdOn')">Created On<img src="assets/icons/caretDown.svg" class="ml-1 hide"></div> -->
                        <div class="col last-child" (click)="sortBy('name')"></div>
                    </header>
                    <ng-container *ngIf="extractedResources &&  extractedResources.length">
                        <perfect-scrollbar class="faqScurceListScroll" [disabled]="workflowService.disablePerfectScroll">
                            <ng-container *ngIf="(extractedResources | filter: [ searchSources, 'name']).length; else noExtractedResources">
                                <div class="content-body" *ngFor="let source of extractedResources | filter: [ searchSources, 'name']">
                                    <div class="col_ col-2" title="{{source.title || source.name}}">{{source.title || source.name | titlecase}}</div>
                                    <div class="col_ col-2">{{source.contentSource | titlecase}}</div>
                                    <div class="col_ col-3">
                                        <span class="mr-2" *ngIf="source.recentStatus && statusObj[source.recentStatus]"
                                            [ngStyle]="{color: (source.recentStatus && statusObj[source.recentStatus])?statusObj[source.recentStatus].color:'black'}">{{statusObj[source.recentStatus].name}}</span>
                                        <span
                                            [ngStyle]="{color: (source.recentStatus && statusObj[source.recentStatus])?statusObj[source.recentStatus].color:'black'}">

                                            <img class="failed mr-1" src="assets/icons/failed-status.svg"
                                                *ngIf="statusObj[source.recentStatus] && statusObj[source.recentStatus].name == 'Failed'"
                                                placement="top" container='body' ngbTooltip="{{statusObj[source.recentStatus].name}}"><span class="sch-createdOn"
                                                *ngIf="duriationDays">({{duriationDays}})</span>
                                            <img *ngIf="statusObj[source.recentStatus] && statusObj[source.recentStatus].name == 'Success'"
                                                class="search-icon ml-2 mr-1" placement="top" container='body'
                                                ngbTooltip="{{(resourcesStatusObj && resourcesStatusObj[source._id] && resourcesStatusObj[source._id].statusMessage)?resourcesStatusObj[source._id].statusMessage:statusObj[source.recentStatus].name}}"
                                                src="assets/icons/succes_duration.svg">
                                            <img class="inProgress ml-2 mr-1" src="assets/icons/ringLoading.svg"
                                                *ngIf=" statusObj[source.recentStatus] && statusObj[source.recentStatus].name == 'In Progress'"
                                                placement="top" container='body'
                                                ngbTooltip="{{(resourcesStatusObj && resourcesStatusObj[source._id] && resourcesStatusObj[source._id].statusMessage)?resourcesStatusObj[source._id].statusMessage:statusObj[source.recentStatus].name}}">
                                            {{ duriationTime}}
                                        </span>
                                        <span *ngIf="!(source.recentStatus && statusObj[source.recentStatus])">---</span>
                                    </div>
                                    <div class="col_ col-2">{{source.extractedFaqsCount || '0'}}</div>
                                    <div class="col_ col-2" *ngIf="source && source.userDetails">{{source.userDetails.fullName ||
                                        source.userDetails.firstName + ' ' + source.userDetails.lastName }}</div>
                                    <!-- <div class="col" title="{{source.createdOn | dateFormatPipe:'MM-DD-YYYY hh:mm:ss A'}}">{{source.createdOn | dateFormatPipe:'MM-DD-YYYY hh:mm:ss A'}}</div> -->
                                    <div class="col text-right last-child pl-0">
                                        <span class="actions-links" *ngIf="source.recentStatus == 'configured'" (click)="resumeAnnotate(source)"><img
                                                class="action_icon" src="assets/icons/play_icon.svg" [container]="'body'"
                                                ngbTooltip="{{'addFaq_resume_annotation' | translate}}"></span>
                                        <span class="actions-links" (click)="deleteSource(source,$event)"><img class="action_icon"
                                                ngbTooltip='{{"sa_delete" | translate}}' [container]="'body'"
                                                src="assets/icons/sidemenu/delete-table.svg"></span>
                                    </div>
                                    <!-- <div class="col text-right last-child re-annotate">
                                                                    <span class="actions-links" (click)="reAnnotateDocument(source)"  ngbTooltip='Re-Annotate'><img class="action_icon" src="assets/images/list.svg"></span>
                                                                </div> -->
                                </div>
                            </ng-container>
                            <ng-template #noExtractedResources>
                                <app-empty-screen class="empty-sm" [width]="100" [height]="100" *ngIf="searchSources" [title]="emptyScreen.TITLE_SEARCH"
                                    [desc]="emptyScreen.DESC_SEARCH" [imgName]="emptyScreen.IMG_NAME">
                                </app-empty-screen>
                            </ng-template>
                        </perfect-scrollbar>
                    </ng-container>

                </section>
            </div>
            </div>
            <!-- <div class="divBlockEmptylastChild">{{searchSources?'No Data Found': 'No search results'}}</div>
            </div> -->
           <!-- <div style="margin-right: 10px;"> <app-record-pagination *ngIf="!isNotSearching && !loadingTab && faqSelectionObj.stats[selectedtab] && faqSelectionObj.stats[selectedtab]>0" [totalRecord]='faqSelectionObj.stats[selectedtab]' [limitpage]='faqLimit' (pageChanged)="paginate($event)"></app-record-pagination></div> PAGINATION -->
        </ng-container>
        <ng-container  *ngIf="currentView === 'grid'">
            <ng-container *ngIf="extractedResources &&  extractedResources.length;">
                <perfect-scrollbar class="faqScurceListScroll">
                    <ng-container *ngIf="(extractedResources | filter: [ searchSources , 'name']).length; else noGridFaq">
                        <div class="list-view-data">
                            <div class="row row_list">
                                <div class="box-content" *ngFor="let source of extractedResources | filter: [ searchSources , 'name']"
                                    (click)="openStatusSlider(source)">
                                    <div class="box">
                                        <div class="title">{{source.title || source.name}}</div>
                                        <div class="type" [ngClass]="{'doc': (source.type==='file')}">{{contentTypes[source.contentSource] |
                                            titlecase}}</div>
                                        <div class="status-data">
                                            <div class="count-pages" *ngIf="statusObj[source.recentStatus].name == 'Success'"><span
                                                    class="pagelength">{{source.extractedFaqsCount}}</span> FAQs</div>
                                            <div class="status-info"
                                                *ngIf="source.recentStatus && statusObj[source.recentStatus] && (source.recentStatus !== 'success') "
                                                [ngStyle]="{color: (source.recentStatus && statusObj[source.recentStatus])?statusObj[source.recentStatus].color:'#202124'}">
                                                <img src="assets/icons/failed-status.svg"
                                                    *ngIf="statusObj[source.recentStatus].name == 'Failed'" placement="top" container='body'
                                                    ngbTooltip="{{statusObj[source.recentStatus].name}}">
                                                <img class="inprogressLoader" src="assets/icons/ringLoading.svg"
                                                    *ngIf="statusObj[source.recentStatus].name == 'In Progress'" placement="top"
                                                    container='body'
                                                    ngbTooltip="{{(resourcesStatusObj && resourcesStatusObj[source._id] && resourcesStatusObj[source._id].statusMessage)?resourcesStatusObj[source._id].statusMessage:statusObj[source.recentStatus].name}}">
                                                <div class="status-name" *ngIf="statusObj[source.recentStatus].name !== 'Success'">
                                                    {{statusObj[source.recentStatus].name}}</div>
                                            </div>
                                            <div *ngIf="!(source.recentStatus && statusObj[source.recentStatus])">---</div>
                                            <div class="created-date" *ngIf="statusObj[source.recentStatus].name == 'Success'">
                                                {{source.createdOn | dateFormatPipe}}
                                            </div>
                                        </div>
                                        <div class="actions-delete">
                                            <span class="actions-links d-none"><img class="action_icon"
                                                    src="assets/icons/sidemenu/table-refresh.svg"></span>
                                            <span class="actions-links" (click)="deleteSource(source,$event)"
                                                ngbTooltip='{{"sa_delete" | translate}}' [container]="'body'"><img class="action_icon"
                                                    src="assets/icons/sidemenu/delete-table.svg"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>

                    <ng-template #noGridFaq>
                        <app-empty-screen class="empty-sm" [width]="100" [height]="100" *ngIf="searchSources" [title]="emptyScreen.TITLE_SEARCH"
                            [desc]="emptyScreen.DESC_SEARCH" [imgName]="emptyScreen.IMG_NAME">
                        </app-empty-screen>
                    </ng-template>
                </perfect-scrollbar>
            </ng-container>
        </ng-container>
    </div>
</kr-modal>
<ng-container *ngIf="showSourceAddition">
    <app-add-source [inputClass]='"faqSourceAddition"' [resourceIDToOpen]="showSourceAddition" (saveEvent)="onSourceAdditionSave($event)" (cancleEvent)="onSourceAdditionClose($event)" (closeSourcePopupEvent)="closeSourcePopupEvent($event)"></app-add-source>
</ng-container>
<kr-modal modalType="center" modalClass="modal_popups_ addfaq" #addfaqSourceModalPop>
    <ng-container  *ngIf="selectedFaq && selectedFaq.isAddFollow">
        <div class="modal-header">
          <div class="title">{{'faqSource_add_follow_up_faq' | translate}}</div>
          <div class="close_icon"><img (click)="cancleAddFollowUp()" src="assets/icons/modal-close.svg"></div>
        </div>
      <perfect-scrollbar class="app-add-faq-insidescroll" #perfectScroll>
        <div class="modal-body">
            <app-add-faq (addFaq)="addNewFollowUp($event)" [faqUpdate]="faqUpdate.asObservable()"  (cancelfaqEvent)="cancleAddFollowUp()"></app-add-faq>
        </div>
      </perfect-scrollbar>
        <div class="modal-footer">
            <button class="kr-sg-button-primary btn_lg" (click)="faqUpdateEvent()">{{'faqSource_save' | translate}}</button>
            <button class="kr-sg-button-secondary btn_lg" (click)="cancleAddFollowUp();">{{'faqSource_cancel' | translate}}</button>
        </div>
      </ng-container>
</kr-modal>


<kr-modal modalType="center" #editfaqSourceModalPop modalClass="modal_popups_ editfaqSourceModalPop">
    <ng-container  *ngIf="editfaq && selectedFaq">
  <div class="modal-header">
    <div class="title">{{'faqSource_edit_faq' | translate}}</div>
    <div class="close_icon"><img (click)="faqCancle()" src="assets/icons/modal-close.svg"></div>
  </div>
<perfect-scrollbar class="perfect-scroll-modal-body" #perfectScroll>
  <div class="modal-body">
    <app-add-faq [faqUpdate]="faqUpdate.asObservable()" (editFaq)="editFaq($event)" [faqData]="selectedFaqToEdit" (cancelfaqEvent)="faqCancle()"></app-add-faq>
  </div>
</perfect-scrollbar>
  <div class="modal-footer">
      <button class="kr-sg-button-primary btn_lg float-right" (click)="faqUpdateEvent()">{{'faqSource_save' | translate}}</button>
      <button class="kr-sg-button-secondary btn_lg float-right" (click)="faqCancle()">{{'faqSource_cancel' | translate}}</button>
      <button class="kr-sg-button-danger btn_lg float-left" (click)="deleteInfividualQuestion(selectedFaq)">{{'faqSource_delete' | translate}}</button>
  </div>
</ng-container>
</kr-modal>
