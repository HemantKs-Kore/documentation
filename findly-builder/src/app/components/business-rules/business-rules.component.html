<div class="business-rules-wrapper">
    <div class="header-sec col-12 row m-0">
        <div class="col-4 lef-sec p-0" *ngIf="!(selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount)"><span class="title">Business Rules</span></div>
        <div class="col-4 lef-sec p-0" *ngIf="selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount">
            <div class="selected-count" *ngIf="!selcectionObj.selectAll">
                <span class="outer-border">
                    <span class="inner-bg"></span>
                </span>
                {{selcectionObj.selectedCount}} Rules Selected
            </div>
            <div class="kr-sg-checkbox m-0" *ngIf="selcectionObj.selectAll">
                <input id="checkbox-1" class="checkbox-custom" type="checkbox" checked>
                <label for="checkbox-1" class="checkbox-custom-label"></label>
                <span class="allselected">All Rules Selected</span>
            </div>
        </div>
        <div class="col-8 right-sec p-0"  *ngIf="!(selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount)">
            <div class="kr-sg-input-search m-0 d-none">                               
                <input type="text" placeholder="Search" autocomplete="off" class="input-search" placeholder="Search">           
            </div> 
            <div class="seach-block">
                <img src="assets/icons/search.svg">
                <img src="assets/images/close.svg" class="d-none">Seach
            </div>
            <div class="add_feild" (click)="openModalPopup()">
                <img src="assets/icons/add_plus.svg">Add Field
            </div>
            <div class="clock"><img src="assets/icons/clock.svg"></div>
        </div>
        <div class="col-8 right-sec p-0" *ngIf="selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount">
            <button class="kr-sg-button-danger btn_lg">Delete</button>
        </div>
    </div>
    <div class="table_section">
        <div class="header_sec row m-0">
            <div class="col-3 content withcheckbox">
                <div class="kr-sg-checkbox p-0 m-0">
                    <input id="selectAllRules" class="checkbox-custom" type="checkbox" (change)="selectAll()" [(ngModel)]="selcectionObj.selectAll">
                    <label for="selectAllRules" class="checkbox-custom-label"></label>
                </div>
                <div class="title"><img src="assets/icons/sort_up_down.svg" class="pr-1">NAME</div>
            </div>
            <div class="col-3 content"><img src="assets/icons/sort_up_down.svg" class="pr-1">condition</div>
            <div class="col-3 content"><img src="assets/icons/sort_up_down.svg" class="pr-1">outcome</div>
            <div class="col-3 content"><img src="assets/icons/sort_up_down.svg" class="pr-1">STATUS</div>
        </div>
        <perfect-scrollbar class="scroll_table">                     
            <div class="body_sec row m-0" *ngFor="let ruleObj of rules" [ngClass]="{'selected': (selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedItems[ruleObj._id])}">
                <div class="col-3 content withcheckbox">                   
                    <div class="kr-sg-checkbox p-0 m-0">
                        <input id="{{ruleObj._id}}" class="checkbox-custom selectRuleCheckBoxDiv" type="checkbox" (change)="checkUncheckfacets(ruleObj)">
                        <label for="{{ruleObj._id}}" class="checkbox-custom-label"></label>
                    </div>
                    <div class="title">{{ruleObj.ruleName}}</div>
                </div>
                <div class="col-3 content">
                    <ng-container *ngFor="let rule of ruleObj.rules">
                    <span class="tags-input mr-1 mb-1"><span class="small-text">{{rule.contextType}} :</span> {{rule.contextCategory}}</span>
                    <span class="outer-name mr-1 mb-1">{{rule.operator}}</span>
                    <ng-container *ngFor="let value of rule.value; let valueIndex = index">
                    <span class="tags-input mr-1 mb-1" >{{value}}</span>
                    <span class="divider mr-1 mb-1" *ngIf="valueIndex < (rule.value.length-1)">OR</span>
                    </ng-container>
                  </ng-container>
                </div>
                <div class="col-3 content">
                    <ng-container *ngFor="let outcome of ruleObj.outcomes">
                        <span class="tags-input mr-1 mb-1">{{outcome.scale}}x BoostResult</span>
                        <span class="outer-name mr-1 mb-1">{{outcome.outcomeOperator}}</span>
                        <span class="tags-input mr-1 mb-1">{{outcome.outcomeType}}: 
                            <span *ngFor="let value of outcome.outcomeValue">{{value}}</span>
                        </span>
                    </ng-container>
                </div>
                <div class="col-3 content actions">
                   <span class="active-status" *ngIf="ruleObj.isRuleActive"><span class="indication"></span>Active</span>
                   <span class="in-active-status" *ngIf="!ruleObj.isRuleActive"><span class="indication"></span>In-Active</span>
                   <div class="actions-icons">
                       <img src="assets/images/edit-pencil.svg">
                       <img src="assets/icons/delete-table.svg">
                   </div>
                </div>
            </div>   
        </perfect-scrollbar>
    </div>
</div>


<kr-modal modalType="center" #addBusinessRules modalClass="modal_popups_ business-rules-popup">
  <div class="modal-header">
    <div class="title font-weight-bold">Add Rule</div>
    <label class="kr-sg-toggle toggle-switch">                                       
        <input type="checkbox">
        <div class="slider"><span class="enabled">Rule Active</span><span class="disabled">Rule Inactive</span></div>
    </label>  
    <div class="close_icon" (click)="closeModalPopup()"><img class="ng-tns-c11-2" src="assets/icons/modal-close.svg"></div>
  </div>
  <perfect-scrollbar class="perfect-scroll-modal-body">
    <div class="modal-body">
        <div class="kr-sg-input-text">
            <div class="label-text">Rule Name</div>
            <input type="text" placeholder="Rule Name" class="input-text">           
        </div>
        <div class="rules-block row m-0">
            <div class="condition-add-text col-3 pl-0 pr-4">
                <div class="title">Condition</div>
                <div class="desc_text">The context of this section as to when the trigger takes place.</div>
                <div class="add-condition"><img src="assets/icons/plus-blue.svg">Add Condition</div>
            </div>
            <div class="input-conditions col-9">
                <div class="row m-0">
                    <div class="col-2 p-0 title">
                        Select Context
                    </div>
                    <div class="col-10">
                        <div class="kr-sg-dropdowns">                           
                            <div class="dropdown dropdown-open">
                                <button class="dropdown-toggle dropdown-input" data-toggle="dropdown">User Context</button>                                            
                                <ul class="dropdown-menu content-menu">                                                                          
                                  <li><a href="#">Option 1</a></li>
                                  <li><a href="#">Option 2</a></li>
                                  <li><a href="#">Option 3</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row m-0">
                    <div class="col-2 p-0 title">
                        Select Context
                    </div>
                    <div class="col-10">
                        <div class="kr-sg-dropdowns">                           
                            <div class="dropdown dropdown-open">
                                <button class="dropdown-toggle dropdown-input" data-toggle="dropdown">User Context</button>                                            
                                <ul class="dropdown-menu content-menu">                                                                          
                                  <li><a href="#">Option 1</a></li>
                                  <li><a href="#">Option 2</a></li>
                                  <li><a href="#">Option 3</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="delete-rule">
                <img src="assets/icons/modal-close.svg">
            </div> -->
        </div>
    </div>
  </perfect-scrollbar>
  <div class="modal-footer">
      <button class="kr-sg-button-primary btn_lg">Proceed</button>
      <button class="kr-sg-button-secondary btn_lg">Back</button>
  </div>
</kr-modal> 