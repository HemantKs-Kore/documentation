<div class="business-rules-wrapper">
    <div class="header-sec col-12 row m-0">
        <div class="col-4 lef-sec p-0" *ngIf="!(selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount)">
            <app-useronboarding-journey [componentType]='componentType'></app-useronboarding-journey>
            <span class="title">Business Rules</span>
        </div>
        <div class="col-4 lef-sec p-0" *ngIf="selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount">
            <div class="selected-count" *ngIf="!selcectionObj.selectAll">
                <span class="mr-1">
                    <img (click)="selectAllFromPartial()" src="assets/icons/resultranking/selected-checkbox.svg" class="search-icon">
                </span>
                <span class="pl-3">{{ selcectionObj.selectedCount }} {{ (selcectionObj.selectedCount >1?"businessRules.rules_selected":"businessRules.rule_selected") | translate }}</span>
            </div>
            <div class="kr-sg-checkbox m-0" *ngIf="selcectionObj.selectAll">
                <input id="checkbox-1" class="checkbox-custom" type="checkbox" [(ngModel)]="selcectionObj.selectAll"(change)="selectAll()" />
                <label for="checkbox-1" class="checkbox-custom-label"></label>
                <span class="allselected">{{ selcectionObj.selectedCount }} {{ (selcectionObj.selectedCount >1?"businessRules.rules_selected":"businessRules.rule_selected") | translate }}</span>
            </div>
        </div>
        <div class="col-8 right-sec p-0" *ngIf="!(selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount)">
            <div class="kr-sg-input-search" [ngClass]="{ 'd-none': !showSearch }">
                <input type="text" placeholder="Search" maxlength="60" id="inputSearch" class="input-search"
                    (keyup)="searchByRule()" [ngClass]="{'pl-33':!searchRules,'pl-2':searchRules}" autocomplete="off"
                    [(ngModel)]="searchRules" (keyup)="filterRules(searchRules,'search')"
                    (mouseover)="searchImgSrc = (searchFocusIn ? 'assets/icons/search_gray.svg' :'assets/icons/search_gray_dark.svg')"
                    (mouseout)="searchFocusIn=false;searchImgSrc = 'assets/icons/search_gray.svg'"
                    (focus)="searchFocusIn=true;searchImgSrc = 'assets/icons/search_gray.svg'">
                <img [src]="searchImgSrc" class="search-icon" *ngIf="!searchRules">
                <img class="close-icon" src="assets/icons/close_icon.svg" [ngClass]="{'pr-22':searchRules}" (mouseover)="activeClose=true" (mouseout)="activeClose=false" (click)="focusoutSearch()">
            </div>
            <!-- <div class="kr-sg-input-search m-0" [ngClass]="{ active: showSearch }">
                <input type="text" placeholder="Search" id="searchInput" autocomplete="off" class="input-search" placeholder="Search" [(ngModel)]="searchRules" />
            </div> -->
            <!-- <div *ngIf="!loadingContent && rules && beforeFilterRules.length && !showSearch" class="seach-block" (click)="toggleSearch();focusinSearch('inputSearch')">
                <img src="assets/icons/search.svg"/>{{ "search" | translate }}
            </div> -->
            <!-- <div class="add_feild mr-0" (click)="createNewRule()" *ngIf="(rules && beforeFilterRules && beforeFilterRules.length) || searchRules  || showSearch">
                <img src="assets/icons/add_plus.svg"/>{{ "businessRules.add_rule" | translate }}
            </div> -->
            <div class="clock"><img src="assets/icons/clock.svg"/></div>
        </div>
        <!-- <div class="col-8 right-sec p-0" *ngIf="selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount">
            <button class="kr-sg-button-danger btn_lg" (click)="deleteMultiePop()">{{ "businessRules.delete" | translate }}</button>
        </div> -->
    </div>
    <div class="header-tabs-rules col-12 row m-0">
        <div class="left-tabs col-4 p-0">
            <div class="tab-name-text active-tab-rule"><span>Contextual Rules</span></div>
            <i class="si-help info-icon"></i>
            <div class="tab-name-text"><span>NLP Rules</span></div>
        </div>
        <div class="right-contnet col-8 p-0 justify-content-end">
            <div class="kr-sg-input-search">
                <input type="text" placeholder="Search" maxlength="60" id="inputSearch" class="input-search"
                    (keyup)="searchByRule()" [ngClass]="{'pl-33':!searchRules,'pl-2':searchRules}" autocomplete="off"
                    [(ngModel)]="searchRules" (keyup)="filterRules(searchRules,'search')"
                    (mouseover)="searchImgSrc = (searchFocusIn ? 'assets/icons/search_gray.svg' :'assets/icons/search_gray_dark.svg')"
                    (mouseout)="searchFocusIn=false;searchImgSrc = 'assets/icons/search_gray.svg'"
                    (focus)="searchFocusIn=true;searchImgSrc = 'assets/icons/search_gray.svg'">
                <img [src]="searchImgSrc" class="search-icon" *ngIf="!searchRules">
                <img class="close-icon" src="assets/icons/close_icon.svg" [ngClass]="{'pr-22':searchRules}" (mouseover)="activeClose=true" (mouseout)="activeClose=false" (click)="focusoutSearch()">
            </div>
            <ng-container *ngIf="!(selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount)">
                <div class="add-rule-text" (click)="createNewRule()" *ngIf="(rules && beforeFilterRules && beforeFilterRules.length) || searchRules  || showSearch">
                    <i class="si-add-plus"></i>
                    <span>Add Contextual Rule</span>
                </div>
            </ng-container>
            <div class="ml-3 pl-1" *ngIf="selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedCount">
                <button class="kr-sg-button-danger btn_lg" (click)="deleteMultiePop()"><i class="si-delete1 mr-2"></i> {{ "businessRules.delete" | translate }}</button>
            </div>
        </div>

    </div>
    
    <div class="mainLoadingSpinner" *ngIf="loadingContent">
        <mat-spinner diameter="18" strokeWidth="2"></mat-spinner>
        <span class="please-wait-message">Please Wait!</span>
    </div>

    <!-- Table default header -->
    <div class="table_section">
        <div class="header_sec row m-0">
            <div class="col-3 content withcheckbox " (click)="sortByApi('ruleName')">
                <!-- <div class="kr-sg-checkbox p-0 m-0">
                    <input id="selectAllRules" class="checkbox-custom" type="checkbox" (change)="selectAll()" [(ngModel)]="selcectionObj.selectAll" />
                    <label for="selectAllRules" class="checkbox-custom-label"></label>
                </div> -->
                <div class=" d-flex align-items-center title cursor-pointer">
                    <span class="d-flex align-items-center flex-column mr-1">
                        <img [ngClass]="getSortIconVisibility('ruleName', 'down')" src="assets/icons/caretDown.svg" class="sortImg downArrow">
                        <img [ngClass]="getSortIconVisibility('ruleName', 'up')" src="assets/icons/caretDown.svg" class="sortImg upArrow">
                    </span>
                    {{ "name_caps" | translate }}
                </div>
            </div>
            <div class="col-3 content">{{ "businessRules.condition_caps" | translate }}</div>
            <div class="col-3 content">{{ "businessRules.outcome_caps" | translate }}</div>
            <div class="col-3 content cursor-pointer d-flex align-items-center" (click)="sortByApi('isRuleActive')">
                <span class="d-flex align-items-center flex-column mr-1">
                    <img [ngClass]="getSortIconVisibility('isRuleActive', 'down')" src="assets/icons/caretDown.svg" class="sortImg downArrow">
                    <img [ngClass]="getSortIconVisibility('isRuleActive', 'up')" src="assets/icons/caretDown.svg" class="sortImg upArrow">
                </span>
                {{ "businessRules.status_caps" | translate }}
                <div class="ml-2 kr-sg-dropdowns type_sort_dropdown" #isRuleActiveFilter="ngbDropdown" ngbDropdown [container]="'body'" [autoClose]="true" [placement]="'bottom-right'">
                    <div class="dropdown dropdown-open">
                        <button class="dropdown-toggle dropdown-input" ngbDropdownToggle (click)="$event.stopImmediatePropagation()">
                            <img class="custom-dropdown-toggle-icon" src="assets/icons/type-select-dropdown.svg">
                        </button>
                        <ul class="dropdown-menu content-menu type_sort_dropdown-content p-0" ngbDropdownMenu>
                            <li (click)="isRuleActiveFilter.close();filterTable('all','isRuleActive')">
                                <span class="list-name">All</span>
                                <img [ngClass]="{'hide': filterSystem.isRuleActiveFilter !== 'all'}" src="assets/icons/check-blue.svg">
                            </li>
                            <li *ngFor="let docType of isRuleActiveArr" (click)="isRuleActiveFilter.close();filterTable(docType,'isRuleActive')">
                                <span class="list-name">{{docType == false ? 'Inactive' :(docType == true? 'Active':'')}}</span>
                                <img [ngClass]="{'hide': filterSystem.isRuleActiveFilter !== docType}" src="assets/icons/check-blue.svg">
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Empty Page -->
    <ng-container *ngIf="loadingContent1 && !(rules && beforeFilterRules && beforeFilterRules.length) && !searchRules && !showSearch">
        <!-- <perfect-scrollbar class="empty-scroll">
            <div class="empty-landing-screen">
                <div class="img-block" *ngIf="!emptyItems">
                    <img class="action_icon" (load)="imageLoad()" src="assets/images/businessrules-empty.png">
                </div>
                <ng-container *ngIf="loadImageText">
                    <div class="empty-title">You haven't added any rules yet!</div>
                    <div class="desc-text">Rule is powerful tool to personalize and fine-tune search results. SearchAssist allows you to define rules based on Search , Page and User-contexts. Rules can also be used for merchandising and promotions.</div>
                    <div class="kr-sg-dropdowns" ngbDropdown [container]="'body'">
                        <button class="kr-sg-button-primary btn_lg px-3" (click)="createNewRule()">Add Rules</button>
                    </div>
                </ng-container>
                <ng-container *ngIf="noItems && emptySearchResults">
                    <div class="desc-text">Your Search Query doesn't match with any record.</div>
                </ng-container>
            </div>
        </perfect-scrollbar> -->
        <perfect-scrollbar class="empty-scroll">
            <div class="rules-empty-data d-none">
                <div class="img-block">
                    <img src="assets/icons/businessrules/b-rules-empty.svg">
                </div>
                <div class="empty-title">No Contextual Rules Found</div>
                <div>
                    <button class="kr-sg-button-primary btn_lg" (click)="createNewRule()"><i class="si-add-plus mr-2"></i>Add Contextual Rule</button>
                </div>
                <div class="info-data-box">
                    <div class="text-info-empty">Contextual Rules allows you to define outcomes based on various conditions set by you on search context or Page context or the User context. These rules are can help achieve personalization of search results for your end users</div>
                    <div class="text-info-empty">Not sure what are contextual rules? Visit our <a href="#">Support <i class="si-external-horizantal"></i></a></div>
                </div>
            </div>
            <div class="rules-empty-data">
                <div class="img-block">
                    <img src="assets/icons/businessrules/b-rules-empty.svg">
                </div>
                <div class="empty-title">No NLP Rules Found</div>
                <div>
                    <button class="kr-sg-button-primary btn_lg" (click)="createNewRule()"><i class="si-add-plus mr-2"></i>Add NLP Rule</button>
                </div>
                <div class="info-data-box">
                    <div class="text-info-empty">Try adding NLP rules to find what you are looking for.</div>
                    <div class="text-info-empty">Not sure what are NLP rules? Visit our <a href="#">Support <i class="si-external-horizantal"></i></a></div>
                </div>
            </div>
        </perfect-scrollbar>
    </ng-container>


    <!-- For business rules table -->

    <div class="table_section" *ngIf="(!loadingContent && rules && beforeFilterRules && beforeFilterRules.length) || searchRules || showSearch">
        <perfect-scrollbar class="scroll_table">
            <!-- <div class="body_sec row m-0" *ngFor="let ruleObj of rules | filter: [searchRules, 'ruleName']" [ngClass]="{ -->
            <div class="body_sec row m-0" *ngFor="let ruleObj of rules" [ngClass]="{'selected':selcectionObj && selcectionObj.selectedItems && selcectionObj.selectedItems[ruleObj._id]}">
                <div class="col-3 content withcheckbox align-items-start">
                    <div class="kr-sg-checkbox p-0 m-0">
                        <input id="{{ ruleObj._id }}" class="checkbox-custom selectRuleCheckBoxDiv" type="checkbox" (change)="checkUncheckfacets(ruleObj)" />
                        <label for="{{ ruleObj._id }}" class="checkbox-custom-label"></label>
                    </div>
                    <div class="title text-truncate" [tooltipClass]="'whiteTooltip'" container="body" ngbTooltip="{{ ruleObj.ruleName }}">{{ ruleObj.ruleName }}</div>
                </div>
                <div class="col-3 content">
                    <ng-container *ngFor="let rule of ruleObj.rules; let ruleIndex = index">
                        <!-- <br *ngIf="ruleIndex > 0"> -->
                        <div class="d-flex align-items-center flex-wrap">
                            <span class="divider" *ngIf="ruleIndex > 0">{{"and_caps" | translate}}</span>
                            <span class="tags-input mr-1 mb-1 contextCategory">
                                <span class="small-text">{{ "businessRules." + rule.contextType | translate}} :</span>
                                <span container="body" ngbTooltip='{{ "businessRules." + rule.contextCategory | translate }}'>{{rule.contextType!=='userContext' ? ("businessRules." + rule.contextCategory | translate):rule.contextCategory }}</span>
                            </span>
                        </div>
                        <div class="d-flex align-items-start mb-2">
                            <div class="d-inline-block">
                                <span class="outer-name mr-1 mb-1 ml-4 d-inline-block"[ngClass]="{'ml-4':ruleIndex > 0}">{{ rule.operator | titlecase}}</span>
                            </div>
                            <div class="d-flex align-items-start flex-wrap">
                                <ng-container *ngFor="let value of rule.value; let valueIndex = index">
                                    <span class="tags-input mr-1 mb-1" *ngIf="value && !checkIsArray(value)" container="body" ngbTooltip="{{rule.dataType == 'date' ? (value | dateFormatPipe: 'DD MMM YYYY'):value}}">{{rule.dataType == 'date' ? (value | dateFormatPipe: 'DD MMM YYYY'):value}}</span>
                                    <span class="tags-input mr-1 mb-1" *ngIf="value && value.length && checkIsArray(value)">
                                        <span *ngFor="let num of value; let numIndex = index" container="body" ngbTooltip="{{rule.dataType == 'date' ? (num | dateFormatPipe: 'DD MMM YYYY'):num}}">{{rule.dataType == 'date' ? (num | dateFormatPipe: 'DD MMM YYYY'):num}}
                                            <span *ngIf="!numIndex"> - </span>
                                        </span>
                                    </span>
                                    <span class="divider" *ngIf="valueIndex < rule.value.length - 1">{{ "or_caps" | translate}}</span>
                                </ng-container>
                            </div>
                        </div>
                    </ng-container>
                </div>
                <div class="col-3 content">
                    <ng-container *ngFor="let outcome of ruleObj.outcomes">
                        <div>
                            <span class="tags-input mr-1 mb-1">
                                <span *ngIf=" outcome.outcomeType === 'boost' ||  outcome.outcomeType === 'lower'">{{outcome.scale }}x</span>
                                {{"businessRules.action" + outcome.outcomeType | translate}}Result
                            </span>
                        </div>
                        <div class="d-inline-flex align-items-start">
                            <span class="outer-name mr-1 mb-1">{{"businessRules." + outcome.outcomeOperator | translate}}</span>
                            <span class="tags-input mr-1 mb-1 outcome-tags-input">{{ outcome.fieldName }}:
                                <span *ngFor="let value of outcome.outcomeValue;let valueIndex = index" container="body" ngbTooltip="{{value}}">{{ value }}
                                    <span *ngIf="valueIndex < outcome.outcomeValue.length - 1" class="divider ">{{"or_caps" | translate }}</span>
                                </span>
                            </span>
                        </div>
                        <img class="pl-1 d-inline-flex" *ngIf="outcome.showFieldWarning && outcome.showFieldWarning !== 'false'" src="assets/icons/info-blue.svg" container="body" ngbTooltip="{{fieldWarnings[outcome.showFieldWarning] || outcome.showFieldWarning}}" tooltipClass="{{modifyFieldWarningMsg(outcome.showFieldWarning)?'my-custom-warning-class':'text-left-warning'}}" />
                    </ng-container>
                </div>
                <div class="col-3 content actions">
                    <div class="toggle_switch d-flex align-items-center">
                        <label class="kr-sg-toggle">
                            <input type="checkbox" checked [(ngModel)]="ruleObj.isRuleActive" (click)="updateRuleStatus(ruleObj,$event)">
                            <div class="slider"></div>
                        </label>
                        <span class="active-status ml-2" *ngIf="ruleObj.isRuleActive"><span class="indication"></span>{{"businessRules.active" | translate }}</span>
                        <span class="in-active-status ml-2" *ngIf="!ruleObj.isRuleActive"><span class="indication"></span>{{"businessRules.In-Active" | translate }}</span>
                    </div>
                    <!-- <div class="actions-icons">
                        <img src="assets/images/edit-pencil.svg" (click)="editRule(ruleObj)" ngbTooltip='Edit' [container]="'body'" />
                        <img src="assets/icons/delete-table.svg" (click)="deleteRulePop(ruleObj, ruleIndex)" ngbTooltip='Delete' [container]="'body'" />
                    </div> -->
                    <div class="actions-icons">
                        <span class="edit-icon" (click)="editRule(ruleObj)" ngbTooltip='Edit' [container]="'body'" tooltipClass="tooltip-global-" placement="top-center">
                            <i class="si-pencil-edit"></i>
                        </span>
                        <span class="delete-icon" (click)="deleteRulePop(ruleObj, ruleIndex)" ngbTooltip='Delete' [container]="'body'" tooltipClass="tooltip-global-" placement="top-center">
                            <i class="si-delete1"></i>
                        </span>
                    </div>
                </div>
            </div>
            <div class="divBlockEmptylastChild text-center">
                <div class="desc">No search results found</div>
            </div>
            <app-record-pagination *ngIf="totalRecord && totalRecord>10" [totalRecord]='totalRecord' [limitpage]='10' (pageChanged)="paginate($event)"></app-record-pagination>
        </perfect-scrollbar>
        <div class="empty-rules" *ngIf="!loadingContent && !(rules && beforeFilterRules && beforeFilterRules.length)">
            <img src="assets/images/icons/empty_ill.svg" />
            <div class="heading">No Rules Available</div>
            <div class="desc">Please add rules</div>
        </div>
    </div>
</div>

<kr-modal modalType="center" #addBusinessRules modalClass="modal_popups_ business-rules-popup">
    <div class="modal-header">
        <div class="title font-weight-bold">{{ (addEditRuleObj._id ?"businessRules.edit_rule" :"businessRules.add_rule") | translate }}</div>
        <label class="kr-sg-toggle toggle-switch">
            <input type="checkbox" [(ngModel)]="addEditRuleObj.isRuleActive" />
            <div class="slider">
                <span class="enabled">{{"businessRules.rule_active" | translate}}</span>
                <span class="disabled">{{"businessRules.rule_in_active" | translate}}</span>
            </div> 
        </label>
        <div class="close_icon" (click)="closeModalPopup()">
            <img src="assets/icons/modal-close.svg" />
        </div>
    </div>
    <!-- <perfect-scrollbar class="perfect-scroll-modal-body" #perfectScroll>
        
    </perfect-scrollbar> -->
    <div class="modal-body">
        <div class="col-6 rule-name-input">
            <div class="kr-sg-input-text">
                <div class="label-text">Rule Name</div>
                <input type="text" placeholder="Rule Name" class="input-text">
            </div>
        </div>
        <div class="rules-contexual-data row col-12 m-0 p-0">
            <div class="condition-rules col-6">
                <div class="inner-data-wrapper">
                    <div class="info-rule-contnet">
                        <div class="title-data">
                            <img src="assets/icons/business-rules/ifcondition.svg">
                            <div class="text-title">Condition</div>
                            <span class="info-tooltip-data">
                                <i class="si-help"></i>
                                <div class="conditon-info-tooltip">
                                    <div class="left-data-info">
                                        <div class="info-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Auctor posuere amet malesuada in. Et nullam.</div>
                                        <div class="info-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Auctor posuere amet malesuada in. Et nullam.</div>
                                    </div>
                                    <div class="img-data">
                                        <img src="assets/icons/business-rules/conditions.png">
                                    </div>
                                    <div class="right-data-info">
                                        <div class="info-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Auctor posuere amet malesuada in. Et nullam.</div>
                                        <div class="info-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Auctor posuere amet malesuada in. Et nullam.</div>
                                    </div>
                                </div>
                            </span>
                        </div>
                        <div class="sub-text text-truncate">The context of this section as to when the trigger takes place.</div>
                    </div>
                    <div class="conditions-sec-data">
                        <perfect-scrollbar class="scoll-data">
                            <div class="inner-data-content">
                                <!-- Repeat the data here conditions -->
                                <ng-container>
                                    <div class="box-data-conditions">
                                        <div class="close-conditions">
                                            <i class="si-close"></i>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 column-sec title-info">Select Context</div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Search Context</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 title-info">Set Parameters</div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Current Search</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-input-text">
                                                    <input type="text" placeholder="Placeholder text" class="input-text">
                                                </div>
                                            </div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Contains</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 column-sec">
                                                <div class="kr-sg-input-text">
                                                    <input type="text" placeholder="Type Keyword" class="input-text">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="and-condition">AND</div>
                                </ng-container>

                                <ng-container>
                                    <div class="box-data-conditions">
                                        <div class="close-conditions">
                                            <i class="si-close"></i>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 column-sec title-info">Select Context</div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Search Context</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 title-info">Set Parameters</div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Current Search</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-input-text">
                                                    <input type="text" placeholder="Placeholder text" class="input-text">
                                                </div>
                                            </div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Contains</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 column-sec">
                                                <div class="kr-sg-input-text">
                                                    <input type="text" placeholder="Type Keyword" class="input-text">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="and-condition">AND</div>
                                </ng-container>
                                <!-- End repeat -->
                                <div class="add-condition-btn">
                                    <i class="si-add-plus"></i>
                                    <span>Add Condition</span>
                                </div>
                            </div>
                        </perfect-scrollbar>
                    </div>
                </div>
            </div>
            <div class="outcome-rules col-6">
                <div class="inner-data-wrapper">
                    <div class="info-rule-contnet">
                        <div class="title-data">
                            <img src="assets/icons/business-rules/outcomesearch.svg">
                            <div class="text-title">Outcome</div>
                        </div>
                        <div class="sub-text text-truncate">The context of this section as to what happens when the previous conditon is met.</div>
                    </div>

                    <div class="outcome-sec-data">
                        <perfect-scrollbar class="scoll-data">
                            <div class="inner-data-content">
                                <!-- Repeat the data here conditions -->
                                <ng-container>
                                    <div class="box-data-conditions">
                                        <div class="close-conditions">
                                            <i class="si-close"></i>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 column-sec title-info">Select Context</div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle disabled>Search Context</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 title-info">Set Parameters</div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Current Search</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-input-text">
                                                    <input type="text" placeholder="Placeholder text" class="input-text">
                                                </div>
                                            </div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Contains</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 column-sec">
                                                <div class="kr-sg-input-text">
                                                    <input type="text" placeholder="Type Keyword" class="input-text">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="and-condition">AND</div>
                                </ng-container>

                                <ng-container>
                                    <div class="box-data-conditions">
                                        <div class="close-conditions">
                                            <i class="si-close"></i>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 column-sec title-info">Select Context</div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Search Context</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 title-info">Set Parameters</div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Current Search</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-input-text">
                                                    <input type="text" placeholder="Placeholder text" class="input-text">
                                                </div>
                                            </div>
                                            <div class="col-4 column-sec">
                                                <div class="kr-sg-dropdowns w-auto" ngbDropdown [placement]="'bottom-right'">                           
                                                    <div class="dropdown dropdown-open">
                                                        <button class="dropdown-toggle dropdown-input" data-toggle="dropdown" ngbDropdownToggle>Contains</button>                                            
                                                        <ul class="dropdown-menu content-menu faq-filter-add" ngbDropdownMenu>   
                                                            <perfect-scrollbar class="scroll-max-200">
                                                                <div class="scroll-max-200">
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                    <li class="p-0" ngbDropdownItem>
                                                                        <a class="text-truncate" title="">Option</a>
                                                                    </li>
                                                                </div>
                                                            </perfect-scrollbar>                                                                       
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-input-data row col-12">
                                            <div class="col-12 column-sec">
                                                <div class="kr-sg-input-text">
                                                    <input type="text" placeholder="Type Keyword" class="input-text">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="and-condition">AND</div>
                                </ng-container>
                                <!-- End repeat -->
                                <div class="add-condition-btn">
                                    <i class="si-add-plus"></i>
                                    <span>Add Condition</span>
                                </div>
                            </div>
                        </perfect-scrollbar>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="kr-sg-button-primary btn_lg" *ngIf="addEditRuleObj._id" (click)="updateRule(addEditRuleObj)">Save</button>
        <button class="kr-sg-button-primary btn_lg" *ngIf="!addEditRuleObj._id" (click)="createRule()">Add</button>
        <button class="kr-sg-button-secondary btn_lg" (click)="closeModalPopup()">{{addEditRuleObj._id?"Cancel":"Back"}}</button>
    </div>
</kr-modal>

<app-upgrade-plan #plans></app-upgrade-plan>