<div class="invoice-container">
    <div class="mainLoadingSpinner" *ngIf="loading" >
        <mat-spinner diameter="18" strokeWidth="2"></mat-spinner>
        <span class="please-wait-message">{{'Please Wait!' | translate}}</span>
    </div>
    <div class="header-sec">
        <app-useronboarding-journey [componentType]='componentType'></app-useronboarding-journey>
        <div class="title">{{"invoices.invoices" | translate}}
            <span class="module-topic" tooltipClass="tooltip-global-" [container]="'body'" ngbTooltip='Topic Guide' (click)="openUserMetaTagsSlider()">
                <i class="si-topic-guide"></i>
            </span>
        </div>
        <div class="d-flex align-items-center" *ngIf="invoices.length">
            <div class="kr-sg-input-search m-0" [ngClass]="{'d-none': !showSearch}">
                <input type="text" placeholder="{{'search' | translate}}" maxlength="60" class="input-search"
                    autocomplete="off" id="fieldSearchId" [(ngModel)]="searchInvoice" 
                    (mouseover)="searchImgSrc = (searchFocusIn ? 'assets/icons/search_gray.svg' :'assets/icons/search_gray_dark.svg')"
                    (mouseout)="searchFocusIn=false;searchImgSrc = 'assets/icons/search_gray.svg'"
                    (focus)="searchFocusIn=true;searchImgSrc = 'assets/icons/search_gray.svg'">
                <!-- <img [src]="searchImgSrc" class="search-icon" *ngIf="!searchFields"> -->
                <img class="close-icon" src="assets/icons/close_icon.svg" [ngClass]="{'pr-22':searchInvoice}" (click)="showSearch=!showSearch;searchInvoice=''"
                     placement="top-center" container='body' ngbTooltip="{{'fields.cancel' | translate}}"
                    tooltipClass="ngb_tooltip_custom_class sampleJson">
            </div>
            <div class="seach-block" (click)="showSearch=!showSearch;">
                <span [ngClass]="{'d-none': showSearch}"  class="mr-3" id="btn_toggle_search_structured_data" ><img src="assets/icons/search.svg" [ngClass]="{'d-none': showSearch}">{{'search' | translate}}</span>
            </div>
            <div class="download-icon" (click)="downloadAll()"><img src="assets/icons/usage-log/download.svg" placement="bottom" ngbTooltip="{{'invoices.download_all' | translate}}" [container]="'body'" tooltipClass="ngb_tooltip_custom_class sampleJson"></div>
        </div>
    </div>

    <ng-container *ngIf="!invoices.length && !loading">
        <div class="empty-invoice">
            <div class="img-block">
                <img src="assets/icons/invoices/invoice-empty-log.png">
            </div>
            <div class="empty-text">{{"invoices.no_invoice_log" | translate}}</div>
            <div class="empty-warning">
                <div><i class="si-warning"></i></div>
                <div class="empty-warning-text">After subscribing to any of the plans offered, your invoices will appear here</div>
            </div>
        </div>
    </ng-container>

    <ng-container *ngIf="invoices.length && !loading">
        <perfect-scrollbar class="scroll-invoice-content if-pagination">
            <div class="invoice-table-data">
                <div class="invoice-table-header row col-12">
                    <div class="title col-1">{{"invoices.invoices_id_caps" | translate}}</div>
                    <div class="title col-3">{{"invoices.BILLING_period" | translate}}</div>
                    <div class="title col-1">{{"invoices.plan_name" | translate}}</div>
                    <div class="title col-1">{{"invoices.order_status" | translate}}</div>
                    <div class="title col-2">{{"invoices.invoice_amount_caps" | translate}}</div>
                    <div class="title col-1">{{"invoices.details" | translate}}</div>
                    <div class="title col-2">{{"invoices.invoice" | translate}}</div>
                </div>
                <div class="invoice-table-body row col-12" *ngFor="let invoice of invoices | fieldsFilter: [ searchInvoice, '_id']">
                    <div class="title col-1">{{invoice?._id}}</div>
                    <div class="title col-3">{{invoice.billingStartDate ?(invoice.billingStartDate| dateFormatPipe: 'DD MMM YYYY'):''}} - {{invoice.billingEndDate? (invoice.billingEndDate | dateFormatPipe: 'DD MMM YYYY'):''}}</div>
                    <div class="title col-1">{{invoice?.planName?(invoice.planName):'-'}}</div>
                    <div class="title col-1">{{invoice?.status}}</div>
                    <div class="title col-2">{{invoice?.amountPaid}} {{invoice?.currencyCode}}</div>
                    <div class="title col-1">-</div>
                    <div class="title col-2">KOREINV_{{invoice._id}}</div>
                    <div class="actions-invoice">
                        <div class="download-invoice"><a type="button" (click)="downloadInvoice(invoice.viewInvoice,invoice._id)"><img src="assets/icons/usage-log/download.svg"></a></div>
                    </div>
                </div>
            </div>
        </perfect-scrollbar>
        <div class="px-4">
            <app-record-pagination *ngIf="totalRecord && totalRecord>10" [totalRecord]='totalRecord' [limitpage]='10' (pageChanged)="paginate($event)"></app-record-pagination>
        </div>
    </ng-container>    
</div>