<div class="manage-deflection" *ngIf="!loading && !showErrorScreen" [@fadeInOutAnimation]>
  <div class="configure-setting-header d-flex justify-content-between align-items-center" *ngIf="completedPercentage  !== 100">
    <div class="title">You have completed  only <b>{{completedPercentage}}%</b> of Configuration Process. Please click <b>“Resume Configuration”</b> to complete the configuration Setup.</div>
    <div>
      <button class="kr-sg-button-primary btn_md" (click)="onResume()">Resume Configuration</button>
    </div>
  </div>
  <div class="configure-settions">
    <perfect-scrollbar class="pr-20" [class.pb-50]="completedPercentage !== 100" [disabled]="workflowService.disablePerfectScroll">
    <div class="d-flex justify-content-between align-items-center preview-config">
      <div class="title">Your call will be transfer to a virtual chat agent , where user can resolve his queries with chat interface.</div>
      <div class="link-preview" (click)="previewConfig = !previewConfig">
        <img src="assets/icons/globalVariable.svg" class="globalVariable">Preview Configuration
      </div>
    </div>    
      <div class="accordion-block-content d-flex justify-content-between">    
        <div class="acc-sec">
          <div id="accordion">
            <div class="card-content" *ngFor="let item of messages; let i = index">
              <div class="card-header">
                <a data-toggle="collapse" data-parent="#accordion" href="{{'#collapse' + i}}" aria-expanded="true" class="card-link">
                  <div class="d-flex justify-content-between">
                    <div class="title">{{item.label}}</div>
                    <div class="message-count">{{item.messages.length}} messages</div>
                  </div>
                  <div class="sub-title">{{item.info}}</div>
                </a>
              </div>
              <div id="{{'collapse' + i}}" class="collapse show collapse-content">
                <div class="card-body-content">
                  <div class="inner-content">
                    <div class="messages-list" *ngFor="let message of item.messages">
                      <div class="label_text">{{message.messageLabel}}</div>
                      <div class="input-box-content">
                        <!-- <div class="text" contenteditable="true" [innerText]="model.welcomeMessage" (blur)="model.welcomeMessage = $event.target.innerText"></div> -->
                        <textarea style="width: 100%;;border: none;overflow: hidden;" matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" [(ngModel)]="message.value" (ngModelChange)="isUpdated = true"></textarea>
                      </div>
                    </div>
                    <!-- <div class="messages-list">
                      <div class="label_text">Welcome Message for Voice Interface</div>
                      <div class="input-box-content">
                        <div class="text">Hello. I am your Virtual Assistant.</div>
                        <div class="text">How can I help you ?</div>
                      </div>
                    </div> -->
                  </div>
                </div>
              </div>
            </div>
            <!-- <div class="card-content">
              <div class="card-header">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" class="card-link collapsed" aria-expanded="false">
                  <div class="d-flex justify-content-between">
                    <div class="title">Deflection Experience Message</div>
                    <div class="message-count">2 messages</div>
                  </div>
                  <div class="sub-title">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's</div>
                </a>
              </div>
              <div id="collapseTwo" class="collapse collapse-content">
                <div class="card-body-content">
                  <div class="inner-content">
                    <div class="messages-list">
                      <div class="label_text">Welcome Message for Voice Interface</div>
                      <div class="input-box-content">
                        <div class="text">Hello. I am your Virtual Assistant.</div>
                        <div class="text">How can I help you ?</div>
                      </div>
                    </div>
                    <div class="messages-list">
                      <div class="label_text">Welcome Message for Voice Interface</div>
                      <div class="input-box-content">
                        <div class="text">Hello. I am your Virtual Assistant.</div>
                        <div class="text">How can I help you ?</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-content">
              <div class="card-header">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" class="card-link collapsed" aria-expanded="false">
                  <div class="d-flex justify-content-between">
                    <div class="title">HandOff Experience Message</div>
                    <div class="message-count">3 messages</div>
                  </div>
                  <div class="sub-title">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's</div>
                </a>
              </div>
              <div id="collapseThree" class="collapse collapse-content">
                <div class="card-body-content">
                  <div class="inner-content">
                    <div class="messages-list">
                      <div class="label_text">Welcome Message for Voice Interface</div>
                      <div class="input-box-content">
                        <div class="text">Hello. I am your Virtual Assistant.</div>
                        <div class="text">How can I help you ?</div>
                      </div>
                    </div>
                    <div class="messages-list">
                      <div class="label_text">Welcome Message for Voice Interface</div>
                      <div class="input-box-content">
                        <div class="text">Hello. I am your Virtual Assistant.</div>
                        <div class="text">How can I help you ?</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div> -->
          </div>
        </div>
        <div class="left-side-sec">
          <div class="config-preview" *ngIf="previewConfig">
            <div class="card-setup-data">
              <div class="heading-title">SmartAssist.ai Call SetUp</div>
              <div class="header-body">
                <ng-container *ngIf="config.deflectConfiguration.type === 'IVR'">
                  <div class="name status" *ngIf="config.deflectConfiguration.IVR.completed"><img src="assets/images/icons/Check.svg">Transfer to SmartAssist.ai</div>
                  <div class="name status" *ngIf="!config.deflectConfiguration.IVR.completed"><img src="assets/images/icons/Warning.svg">Transfer to SmartAssist.ai</div>
                  <div class="name">SmartAssist.ai Phone Number</div>
                </ng-container>
                <ng-container *ngIf="config.deflectConfiguration.type === 'phoneNumber'">
                  <div class="name">Transfer to SmartAssist.ai</div>
                  <div class="name status" *ngIf="config.deflectConfiguration.phoneNumber.completed"><img src="assets/images/icons/Check.svg">SmartAssist.ai Phone Number</div>
                  <div class="name status" *ngIf="!config.deflectConfiguration.phoneNumber.completed"><img src="assets/images/icons/Warning.svg">SmartAssist.ai Phone Number</div>
                </ng-container>
              </div>
            </div>
            <div class="card-setup-data">
              <div class="heading-title">Automated Conversations</div>
              <div class="header-body">
                <ng-container *ngIf="config.virtualAssistant.enabled">
                  <ng-container *ngIf="config.virtualAssistant.type === 'voice'">
                    <div class="name status"><img src="assets/images/icons/Check.svg"> Virtual Voice Assistance</div>
                    <div class="name">Virtual Chat Assistance</div>
                  </ng-container>
                  <ng-container *ngIf="config.virtualAssistant.type === 'chat'">
                    <div class="name">Virtual Voice Assistance</div>
                    <div class="name status"><img src="assets/images/icons/Check.svg"> Virtual Chat Assistance</div>
                  </ng-container>
                 
                </ng-container>
                <ng-container *ngIf="!config.virtualAssistant.enabled">
                  <div class="name">Virtual Voice Assistance</div>
                  <div class="name">Virtual Chat Assistance</div>
                </ng-container>
               
              </div>
            </div>
            <div class="card-setup-data">
              <div class="heading-title">HandOff Experience</div>
              <div class="header-body">
                <div class="name" *ngIf="!config.handOff.formSubmission">Submit Request to Agent</div>
                <ng-container *ngIf="config.handOff.formSubmission">
                  <div class="name status" *ngIf="config.handOff.isFormCompleted"><img src="assets/images/icons/Check.svg">Submit Request to Agent</div>
                  <div class="name status" *ngIf="!config.handOff.isFormCompleted"><img src="assets/images/icons/Warning.svg">Submit Request to Agent</div>
                </ng-container>
                <div class="name" *ngIf="!config.handOff.liveAgent">Live Chat Agent</div>
                <ng-container *ngIf="config.handOff.liveAgent">
                  <div class="name status" *ngIf="config.handOff.isAgentDetailsCompleted"><img src="assets/images/icons/Check.svg">Live Chat Agent</div>
                  <div class="name status" *ngIf="!config.handOff.isAgentDetailsCompleted"><img src="assets/images/icons/Warning.svg">Live Chat Agent</div>
                </ng-container>
              </div>
            </div>
          </div>
        </div>
      </div>
    </perfect-scrollbar>

    <div class="save-action-btn d-flex align-items-center">
      <button class="kr-sg-button-primary btn_lg d-flex align-items-center" (click)="onSave()" [disabled]="!allowSave">Save<div class="loader-in-button ml-2" *ngIf="!allowSave"><img src="assets/images/icons/fa-spinner.svg"></div></button>
      <div class="success-message-notification" *ngIf="successMsg"><img src="assets/images/check-green.svg">{{successMsg}}</div>
      <div class="error-message-notification" *ngIf="errorMsg"><img src="assets/icons/Warn.svg">{{errorMsg}}</div>
    </div>   
  </div> 

  <div *ngIf="config.handOff.liveAgent" style="position: absolute; visibility: hidden;">
    <app-live-chat-agent [agentDetails]="config.handOff.agentDetails"></app-live-chat-agent>
  </div>
</div>

<div class="manage-form-please-wait-all" *ngIf="loading" [@fadeInOutAnimation]>
  <mat-spinner diameter="18" strokeWidth="2"></mat-spinner>
  <span class="please-wait-message">Please Wait!</span>
</div>

<div class="error-container" *ngIf="!loading && showErrorScreen" [@fadeInOutAnimation]>
  <div class="err-img">
      <img src="assets/images/empty-illustration.png">
  </div>
  <div class="err-msg">
      Something went wrong, Please try later.
  </div>
</div>