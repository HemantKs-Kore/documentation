<div class="main-metrics-container">
  <div class="header-sec row m-0 col-12">
    <app-useronboarding-journey
      [componentType]="componentType"
    ></app-useronboarding-journey>
    <div class="bread-cum-sec col-3 p-0 d-flex align-items-center">
      <div class="bread-name">{{ 'metrics.analytics' | translate }}</div>
      <img
        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAMCAYAAABBV8wuAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAClSURBVHgBbU+xDcIwEPQ7ibIGI8AIGQNREJepYAMYAQoUkSC9U9iUFhNkFNgAWoTsByNhKQ5XnPR3uv971khtasQJi8At2X0CeR+b4KlGVSYAq4yehRDi8U14qsRCEtHlBblh/3BEtW2kwrBqaGrJOVz5qA2wu3NuGGi786ZBvRuJrdT9b049nTq9dETlp+4s/HFANc0AjCUoKjG/hVspg3UserwBA09CgWDEywYAAAAASUVORK5CYII="
      />
      <div class="bread-name active-name">
        {{ 'user_engagement_User_Engagement' | translate }}
        <span
          class="module-topic"
          tooltipClass="tooltip-global-"
          [container]="'body'"
          ngbTooltip="{{ 'sa_topic_guide' | translate }}"
          placement="right-center"
          (click)="openUserMetaTagsSlider()"
        >
          <i class="si-topic-guide-1"></i>
        </span>
      </div>
    </div>
    <div class="d-flex justify-content-end align-items-center col-9 p-0">
      <div class="custom_date_picker_sec">
        <input
          type="text"
          class="d-none"
          readonly
          ngxDaterangepickerMd
          style="width: 320px"
          [timePicker]="true"
          [min]="minDate"
          [max]="maxDate"
          showCancel="true"
          [locale]="{
            format: 'DD/MM/YYYY hh:mm',
            displayFormat: 'MM/DD/YYYY hh:mm A'
          }"
          [(ngModel)]="selected"
          (datesUpdated)="onDatesUpdated($event)"
        />
        <button
          type="button"
          class="ngx-daterangepicker-action invisible custom_date_picker"
          style="position: absolute; width: 0; height: 0"
          (click)="openDateTimePicker($event)"
          #datetimeTrigger
        ></button>
      </div>
      <div class="date-select">
        <span
          class="day time"
          (click)="getDateRange(1)"
          [ngClass]="{ selected: defaultSelectedDay === 1 }"
          >{{ 'user_engagement_24hrs' | translate }}
        </span>
        <span
          class="week time"
          (click)="getDateRange(7)"
          [ngClass]="{ selected: defaultSelectedDay === 7 }"
          >{{ 'result_insights_7_days' | translate }}
        </span>
        <span
          class="custom time"
          (click)="getDateRange(-1)"
          [ngClass]="{ selected: defaultSelectedDay === -1 }"
          >{{ 'user_engagement_custom' | translate }}
        </span>
      </div>
    </div>
  </div>

  <perfect-scrollbar class="scroll_content">
    <div class="analy-dropdown-header">
      <app-analytics-dropdown
        *ngIf="indexConfigs.length"
        [indexarray]="indexConfigs"
        (dropdownpipelineid)="getAllgraphdetails($event)"
      ></app-analytics-dropdown>
    </div>
    <div *ngIf="slider === 1" class="main-dashbord-metrics">
      <div class="data-information-content col-12 m-0 row split-tables">
        <div class="col-12 box-content">
          <div class="full-card">
            <div class="legends-info">
              <div class="content no-bg">
                <div class="title">
                  {{ 'user_engagement_Total_User' | translate }}
                  <img
                    src="assets/icons/gray_info.svg"
                    placement="top-center"
                    ngbTooltip="{{
                      'user_engagement_no_of_unique_users_performed_during_selected_period'
                        | translate
                    }}"
                    [container]="'body'"
                    tooltipClass="dashboard-custom-tooltips"
                    class="pl-1"
                  />
                  <span class="toatlsearches"></span>
                </div>
                <div class="count-data">
                  <span class="count"
                    >{{ totalUser }}
                    <img
                      style="background: #dd3646"
                      *ngIf="totalUserProgress < 0"
                      src="assets/icons/arrow-decrease.svg" />
                    <img
                      *ngIf="totalUserProgress > 0"
                      src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAQCAYAAADwMZRfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABeSURBVHgB7c7BCcAgDAXQZIOOYDfoxh2hI3QER3AFN4j/4CGICElOgh8+YgKPEJ2M4dVSRH48SY0utDLzTZ4AfNCMFvJEAcmFaKD/bcgImJEZ0OdvCAhfYEW+ELB/Ghq8YlSvj06DAAAAAElFTkSuQmCC"
                  /></span>
                  <span class="percentage" *ngIf="totalUserProgress > 0"
                    >{{ math.abs(totalUserProgress) }}%</span
                  >
                  <span
                    class="percentage"
                    style="color: #dd3646"
                    *ngIf="totalUserProgress < 0"
                    >{{ math.abs(totalUserProgress) }}%</span
                  >
                </div>
              </div>
              <div class="content">
                <div class="title">
                  {{ 'user_engagement_New_Users' | translate
                  }}<span class="withresults"></span>
                  <img
                    src="assets/icons/gray_info.svg"
                    placement="top-center"
                    ngbTooltip="{{
                      'user_engagement_no_of_new_users_performed_search'
                        | translate
                    }}"
                    [container]="'body'"
                    tooltipClass="dashboard-custom-tooltips"
                    class="pl-1"
                  />
                </div>
                <div class="count-data">
                  <span class="count"
                    >{{ newUser }}
                    <img
                      style="background: #dd3646"
                      *ngIf="newUserProgress < 0"
                      src="assets/icons/arrow-decrease.svg" />
                    <img
                      *ngIf="newUserProgress > 0"
                      src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAQCAYAAADwMZRfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABeSURBVHgB7c7BCcAgDAXQZIOOYDfoxh2hI3QER3AFN4j/4CGICElOgh8+YgKPEJ2M4dVSRH48SY0utDLzTZ4AfNCMFvJEAcmFaKD/bcgImJEZ0OdvCAhfYEW+ELB/Ghq8YlSvj06DAAAAAElFTkSuQmCC"
                  /></span>
                  <span class="percentage" *ngIf="newUserProgress > 0"
                    >{{ newUserProgress }}%</span
                  >
                  <span
                    class="percentage"
                    style="color: #dd3646"
                    *ngIf="newUserProgress < 0"
                    >{{ math.abs(newUserProgress) }}%</span
                  >
                </div>
              </div>
              <div class="content">
                <div class="title">
                  {{ 'user_engagement_Repeat_Users' | translate
                  }}<span class="clicks"> </span>
                  <img
                    src="assets/icons/gray_info.svg"
                    placement="top-center"
                    ngbTooltip="{{
                      'user_engagement_no_of_unqiue_users_who_performed_search_during_selected_period'
                        | translate
                    }}"
                    [container]="'body'"
                    tooltipClass="dashboard-custom-tooltips"
                    class="pl-1"
                  />
                </div>
                <div class="count-data">
                  <span class="count"
                    >{{ repeatUser }}
                    <img
                      style="background: #dd3646"
                      *ngIf="repeatUserProgress < 0"
                      src="assets/icons/arrow-decrease.svg" />
                    <img
                      *ngIf="repeatUserProgress > 0"
                      src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAQCAYAAADwMZRfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABeSURBVHgB7c7BCcAgDAXQZIOOYDfoxh2hI3QER3AFN4j/4CGICElOgh8+YgKPEJ2M4dVSRH48SY0utDLzTZ4AfNCMFvJEAcmFaKD/bcgImJEZ0OdvCAhfYEW+ELB/Ghq8YlSvj06DAAAAAElFTkSuQmCC"
                  /></span>
                  <span class="percentage" *ngIf="repeatUserProgress > 0"
                    ><span></span>{{ repeatUserProgress }}%</span
                  >
                  <span
                    class="percentage"
                    style="color: #dd3646"
                    *ngIf="repeatUserProgress < 0"
                    >{{ math.abs(repeatUserProgress) }}%</span
                  >
                </div>
              </div>
            </div>
            <div
              class="kr-sg-dropdowns filter-dropdown"
              ngbDropdown
              [placement]="'bottom-right'"
            ></div>
            <div
              echarts
              [options]="userEngagementChartData"
              class="demo-chart-graphMode"
            ></div>
          </div>
        </div>
      </div>
      <div class="data-information-content col-12 m-0 row split-tables">
        <div class="col-12 box-content">
          <div class="full-card">
            <div class="legends-info">
              <div class="content no-bg">
                <div class="title">
                  {{ 'user_engagement_Busy_Hours' | translate }}
                  <img
                    src="assets/icons/gray_info.svg"
                    placement="top-center"
                    ngbTooltip="{{
                      'user_engagement_volume_of_users_that_performed_searches_at_different_hrs'
                        | translate
                    }}"
                    [container]="'body'"
                    tooltipClass="dashboard-custom-tooltips"
                    class="pl-1"
                  />
                  <span class="toatlsearches"></span>
                </div>
              </div>
            </div>
            <div
              echarts
              [options]="heatMapChartOption"
              class="demo-chart-graphMode"
              style="z-index: 1"
            ></div>
            <div class="d-flex justify-content-between busyhours mt-1">
              <div class="row m-0 bottom-row col-12">
                <div class="slider-sec col-6 p-0">
                  <div class="label-hours">
                    {{ 'user_engagement_Hours' | translate }}
                  </div>
                  <span class="span00">{{
                    'user_engagement_0' | translate
                  }}</span>
                  <ng5-slider
                    class="col-3"
                    [(value)]="durationRange1"
                    [(highValue)]="durationRange2"
                    [options]="durationOptions"
                    class="double_slider slider1"
                    (userChangeEnd)="
                      onUserChangeEnd('duration', $event, 'slider1')
                    "
                    (userChange)="onUserChange($event, 'slider1', true)"
                    placement="top-center"
                    container="body"
                    ngbTooltip="{{ highValue - lowValue }} hrs"
                  ></ng5-slider>
                  <span class="span24">{{
                    'user_engagement_24hrs' | translate
                  }}</span>
                </div>
                <div class="legend-sec col-6 p-0">
                  <div class="title">
                    {{ 'user_engagement_Volume_Of_Users' | translate }}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12 row m-0 p-0">
          <div class="col-6 box-content">
            <div
              class="full-card"
              [ngStyle]="{
                opacity: isyAxisGeodata ? 'unset' : '0.3',
                'pointer-events': isyAxisGeodata ? 'auto' : 'none'
              }"
            >
              <div class="title-card">
                {{ 'user_engagement_GEO' | translate }}
              </div>
              <div
                echarts
                [options]="geoBar"
                class="demo-chart-graphMode"
              ></div>
            </div>
          </div>
          <div class="col-6 box-content">
            <div
              class="full-card"
              [ngStyle]="{
                opacity: isyAxismostUsedBrowserdata ? 'unset' : '0.3',
                'pointer-events': isyAxismostUsedBrowserdata ? 'auto' : 'none'
              }"
            >
              <div class="title-card">
                {{ 'user_engagement_Most_Used_Browsers' | translate }}
              </div>
              <div
                echarts
                [options]="mostUsedBrowserBar"
                class="demo-chart-graphMode"
              ></div>
            </div>
          </div>
        </div>
        <div class="col-12 row m-0 p-0">
          <div class="col-6 box-content"></div>
        </div>
      </div>
    </div>
  </perfect-scrollbar>
</div>
