<!-- Search Field Properties
- Author : Sujit
-->
<div class="fieldManagementComponent">
  <div class="table_sec">
    <!-- SearchField Main Header -->
    <div class="seach_add_feild">
      <div class="title">
        {{ 'Search_Field_Properties' | translate }}
        <span
          class="module-topic"
          tooltipClass="tooltip-global-"
          [container]="'body'"
          ngbTooltip="Topic Guide"
          placement="right-center"
          (click)="openUserMetaTagsSlider()"
        >
          <i class="si-topic-guide-1"></i>
          <!-- Topic Guide yet to Impiment -->
        </span>
      </div>
      <!-- Search -->
      <div class="d-flex align-items-center">
        <div
          class="kr-sg-input-search m-0"
          [ngClass]="{ 'd-none': !showSearch }"
        >
          <input
            type="text"
            placeholder="{{ 'sa_search' | translate }}"
            maxlength="60"
            class="input-search"
            [ngClass]="{ 'pl-33': !searchFields, 'pl-2': searchFields }"
            autocomplete="off"
            id="fieldSearchId"
            [(ngModel)]="searchFields"
            (keyup)="fetchPropeties(searchFields, 'search', 0)"
            (mouseover)="
              searchImgSrc = searchFocusIn
                ? 'assets/icons/search_gray.svg'
                : 'assets/icons/search_gray_dark.svg'
            "
            (mouseout)="
              searchFocusIn = false;
              searchImgSrc = 'assets/icons/search_gray.svg'
            "
            (focus)="
              searchFocusIn = true;
              searchImgSrc = 'assets/icons/search_gray.svg'
            "
          />
          <img [src]="searchImgSrc" class="search-icon" *ngIf="!searchFields" />
          <img
            class="close-icon"
            src="assets/icons/close_icon.svg"
            [ngClass]="{ 'pr-22': searchFields }"
            (mouseover)="activeClose = true"
            (mouseout)="activeClose = false"
            (click)="focusoutSearch()"
            placement="top-center"
            container="body"
            ngbTooltip="{{ 'sa_cancel' | translate }}"
            tooltipClass="ngb_tooltip_custom_class sampleJson"
          />
        </div>
        <div
          class="seach-block"
          (click)="showSearch = !showSearch; focusinSearch('fieldSearchId')"
        >
          <span
            [ngClass]="{ 'd-none': showSearch }"
            class="mr-3"
            id="btn_toggle_search_structured_data"
            ><img
              src="assets/icons/search.svg"
              [ngClass]="{ 'd-none': showSearch }"
            />{{ 'sa_search' | translate }}</span
          >
        </div>
        <div class="add_feild d-none">
          <span class="pr-2"><i class="si-recall"></i></span>
          {{ 'resultRanking.reset' | translate }}
        </div>
      </div>
      <!-- Search -->
    </div>
    <!-- SearchField Main Header end-->
    <div>
      <div
        class="table_data_content"
        *ngIf="searchFieldProperties && searchFieldProperties.length"
      >
        <!-- SearchField Table Header -->
        <div class="table_header row m-0">
          <div
            class="col_ col-2 title d-flex align-items-center justify-content-start"
            (click)="sortByApi('fieldName')"
          >
            <span class="d-flex align-items-center flex-column mr-1">
              <img
                class="ml-1 sortImg downArrow"
                [ngClass]="getSortIconVisibility('fieldName', 'down')"
                src="assets/icons/caretDown.svg"
              />
              <img
                class="ml-1 sortImg upArrow"
                [ngClass]="getSortIconVisibility('fieldName', 'up')"
                src="assets/icons/caretDown.svg"
              />
            </span>
            {{"weights_field_name" | translate}}
          </div>
          <div
            class="col_ col-3 title d-flex align-items-center"
            (click)="sortByApi('weight')"
          >
            <span class="d-flex align-items-center flex-column mr-1">
              <img
                class="ml-1 sortImg downArrow"
                [ngClass]="getSortIconVisibility('weight', 'down')"
                src="assets/icons/caretDown.svg"
              />
              <img
                class="ml-1 sortImg upArrow"
                [ngClass]="getSortIconVisibility('weight', 'up')"
                src="assets/icons/caretDown.svg"
              />
            </span>
            weights
          </div>
          <div
            class="col_ col-2 title d-flex align-items-center"
            (click)="sortByApi('presentable')"
          >
            <span class="d-flex align-items-center flex-column mr-1">
              <img
                class="ml-1 sortImg downArrow"
                [ngClass]="getSortIconVisibility('presentable', 'down')"
                src="assets/icons/caretDown.svg"
              />
              <img
                class="ml-1 sortImg upArrow"
                [ngClass]="getSortIconVisibility('presentable', 'up')"
                src="assets/icons/caretDown.svg"
              />
            </span>
            {{ 'search_settings_Presentable' | translate }}
            <span
              class="info-text-icon"
              [container]="'body'"
              ngbTooltip="{{ 'search_settings_Presentable' | translate }}"
              placement="bottom-left"
              ><i class="si-info icon-info"></i
            ></span>
            <!-- <div class="kr-sg-dropdowns type_sort_dropdown d-none" #selectFilter="ngbDropdown" ngbDropdown
                            [container]="'body'" [container]="'body'" [autoClose]="true" [placement]="'bottom-right'">
                            <div class="dropdown dropdown-open">
                                <button class="dropdown-toggle dropdown-input" ngbDropdownToggle
                                    (click)="$event.stopImmediatePropagation()">
                                    <img class="custom-dropdown-toggle-icon" src="assets/icons/Fields_Vector.svg">
                                </button>
                                <ul class="dropdown-menu content-menu type_sort_dropdown-content" ngbDropdownMenu>
                                    <li (click)="selectFilter.close();filterTable('all','isSearchable')"><span
                                            class="list-name">{{'fields_all' | translate}}</span><img
                                            [ngClass]="{'hide': filterSystem.isSearchableFilter !== 'all'}"
                                            src="assets/icons/check-blue.svg"></li>
                                    <li *ngFor="let docType of isSearchableArr"
                                        (click)="selectFilter.close();filterTable(docType,'isSearchable')">
                                        <span class="list-name">{{docType === false ? 'No' :(docType === true? 'Yes':
                                            '')}}</span><img
                                            [ngClass]="{'hide': filterSystem.isSearchableFilter !== docType}"
                                            src="assets/icons/check-blue.svg">
                                    </li>
                                </ul>
                            </div>
                        </div> -->
          </div>
          <div
            class="col_ col-2 title d-flex align-items-center"
            (click)="sortByApi('highlight')"
          >
            <span class="d-flex align-items-center flex-column mr-1">
              <img
                class="ml-1 sortImg downArrow"
                [ngClass]="getSortIconVisibility('highlight', 'down')"
                src="assets/icons/caretDown.svg"
              />
              <img
                class="ml-1 sortImg upArrow"
                [ngClass]="getSortIconVisibility('highlight', 'up')"
                src="assets/icons/caretDown.svg"
              />
            </span>
            Highlight
            <span
              class="info-text-icon"
              [container]="'body'"
              ngbTooltip="Highlight"
              placement="bottom-left"
              ><i class="si-info icon-info"></i
            ></span>
          </div>
          <div
            class="col_ col-2 title d-flex align-items-center"
            (click)="sortByApi('spellCorrect')"
          >
            <span class="d-flex align-items-center flex-column mr-1">
              <img
                class="ml-1 sortImg downArrow"
                [ngClass]="getSortIconVisibility('spellCorrect', 'down')"
                src="assets/icons/caretDown.svg"
              />
              <img
                class="ml-1 sortImg upArrow"
                [ngClass]="getSortIconVisibility('spellCorrect', 'up')"
                src="assets/icons/caretDown.svg"
              />
            </span>
            Spell correct
            <span
              class="info-text-icon"
              [container]="'body'"
              ngbTooltip="Spell correct"
              placement="bottom-left"
              ><i class="si-info icon-info"></i
            ></span>
          </div>
        </div>
        <!-- SearchField Table Header end-->
        <!-- SearchField Table Records/Body -->
        <perfect-scrollbar class="table_body_content">
          <div
            class="table_body row m-0"
            *ngFor="
              let searchProperties of searchFieldProperties;
              let i = index
            "
          >
            <div class="col-2 title text-left" title="faq_question_keywords">
              {{ searchProperties.fieldName }}
            </div>
            <div class="col-3 title">
              <div class="silder-range-block">
                <div class="range-slider">
                  <app-range-slider
                    [customClass]="'weightsSlider'"
                    [allData]="searchProperties.properties.slider"
                    (valueEvent)="valueEvent($event, searchProperties)"
                  ></app-range-slider>
                </div>
                <div class="slider-value">
                  {{ searchProperties.properties.slider.default }}
                </div>
              </div>
            </div>
            <!-- Disabled Conatiner -->
            <ng-container *ngIf="i !== enableIndex">
              <div class="col-2 title">
                <span
                  class="field-value"
                  [ngClass]="
                    searchProperties.properties.presentable ? 'yes' : 'no'
                  "
                  >{{
                    searchProperties.properties.presentable ? 'Yes' : 'No'
                  }}</span
                >
              </div>
              <div class="col-2 title">
                <span
                  class="field-value"
                  [ngClass]="
                    searchProperties.properties.highlight ? 'yes' : 'no'
                  "
                  >{{
                    searchProperties.properties.highlight ? 'Yes' : 'No'
                  }}</span
                >
              </div>
              <div class="col-2 title">
                <span
                  class="field-value"
                  [ngClass]="
                    searchProperties.properties.spellCorrect ? 'yes' : 'no'
                  "
                  >{{
                    searchProperties.properties.spellCorrect ? 'Yes' : 'No'
                  }}</span
                >
              </div>
            </ng-container>
            <!-- Disabled Conatiner end -->
            <!-- Edit Conatiner -->
            <ng-container *ngIf="i === enableIndex">
              <!-- presentable -->
              <div class="col-2 title">
                <div class="toggle_switch">
                  <label class="kr-sg-toggle">
                    <input
                      checked=""
                      type="checkbox"
                      [(ngModel)]="selectedProperties.presentable"
                      (change)="
                        !selectedProperties.presentable
                          ? (selectedProperties.highlight = false)
                          : (selectedProperties.highlight =
                              selectedProperties.highlight)
                      "
                    />
                    <!--  Chnage is added for validation based on Highlight property -->
                    <div class="slider"></div>
                  </label>
                </div>
              </div>
              <!-- highlight -->
              <div class="col-2 title">
                <div class="toggle_switch" *ngIf="i === enableIndex">
                  <label
                    class="kr-sg-toggle"
                    [ngClass]="
                      !selectedProperties.presentable ? 'disable-toggle' : ''
                    "
                  >
                    <input
                      checked=""
                      type="checkbox"
                      [(ngModel)]="selectedProperties.highlight"
                    />
                    <div class="slider"></div>
                  </label>
                </div>
              </div>
              <!-- spellCorrect -->
              <div class="col-2 title">
                <div class="toggle_switch" *ngIf="i === enableIndex">
                  <label class="kr-sg-toggle">
                    <input
                      checked=""
                      type="checkbox"
                      [(ngModel)]="selectedProperties.spellCorrect"
                    />
                    <div class="slider"></div>
                  </label>
                </div>
              </div>
            </ng-container>
            <!-- Edit Conatiner end-->
            <div class="col-1">
              <div
                class="action_links text-right"
                *ngIf="selectedProperties.owner !== 'sys'"
              >
                <span
                  class="action_link-icon"
                  ngbTooltip="{{ 'fields.edit' | translate }}"
                  *ngIf="i !== enableIndex"
                  (click)="editSearchFiledProperties(searchProperties, i)"
                  [container]="'body'"
                >
                  <i class="si-pencil-edit"></i>
                </span>
                <!-- <span class="action_link-icon ml-3"><i class="si-delete1"></i>
                                </span> -->
                <div class="field-edit-mode" *ngIf="i === enableIndex">
                  <span
                    class="action_link-icon"
                    (click)="
                      saveAPI(selectedProperties, searchProperties._id, i)
                    "
                  >
                    <i class="si-check"></i>
                  </span>
                  <span
                    class="action_link-icon"
                    (click)="
                      cancel(searchProperties.properties, i);
                      enableIndex = defaultIndex
                    "
                  >
                    <i class="si-close"></i>
                  </span>
                </div>
              </div>
            </div>
          </div>
          <!-- NO RESULT FOUND-->
          <div
            class="divBlockEmptylastChild text-center"
            *ngIf="!(searchFieldProperties && searchFieldProperties.length)"
          >
            <div class="desc" *ngIf="!totalRecord">No search results found</div>
          </div>
          <!-- NO RESULT FOUND-->
        </perfect-scrollbar>
        <!-- SearchField Table Records/Body end-->
        <!-- SearchField Pagnation -->
        <div class="pagination-block">
          <app-record-pagination
            *ngIf="totalRecord && totalRecord > 10"
            [totalRecord]="totalRecord"
            [limitpage]="10"
            (pageChanged)="paginate($event)"
          ></app-record-pagination>
        </div>
        <!-- SearchField Pagnation end -->
      </div>
    </div>
  </div>
</div>
